{"version":3,"sources":["lib/Leaflet-1.0.0-beta.2/dist/leaflet-src.js","lib/Leaflet.toolbar-touch-icons/dist/leaflet.toolbar-src.js","lib/Leaflet.Zoomify-gh-pages/src/L.TileLayer.Zoomify.js","lib/Leaflet.UrlView-gh-pages/src/Map.UrlView.js","lib/Leaflet.Editable-0.7.0-beta.1/src/Leaflet.Editable.js","lib/Leaflet.ThumbnailMap-gh-pages/src/Leaflet.ThumbnailMap.js","lib/Leaflet.FeatureStorage-gh-pages/src/Leaflet.FeatureStorage.JSON.js","lib/Leaflet.fullscreen-gh-pages/dist/Leaflet.fullscreen.js","js/Leaflet.Util.Extra.js","js/Leaflet.Mixin.FeatureProperties.js","js/Leaflet.Marker.Label.js","js/Leaflet.Toolbar.Common.js","js/Leaflet.Control.SlideScale.js","js/Leaflet.Ruler/Leaflet.Control.Ruler.js","js/Leaflet.Toolbar.Ruler.js","js/Leaflet.Toolbar.Annotate.js","js/Leaflet.Toolbar.ExportImport.js","js/Leaflet.Legend/Leaflet.Control.Legend.js"],"names":["window","document","undefined","L","version","expose","oldL","noConflict","this","module","exports","define","amd","Util","extend","dest","i","j","len","src","arguments","length","create","Object","F","proto","prototype","bind","fn","obj","slice","Array","apply","call","args","concat","stamp","_leaflet_id","lastId","throttle","time","context","lock","wrapperFn","later","setTimeout","wrapNum","x","range","includeMax","max","min","d","falseFn","formatNum","num","digits","pow","Math","round","trim","str","replace","splitWords","split","setOptions","options","hasOwnProperty","getParamString","existingUrl","uppercase","params","push","encodeURIComponent","toUpperCase","indexOf","join","template","data","templateRe","key","value","Error","isArray","toString","array","el","emptyImageUrl","getPrefixed","name","lastTime","timeoutDefer","Date","timeToCall","requestFn","requestAnimationFrame","cancelFn","cancelAnimationFrame","id","clearTimeout","requestAnimFrame","immediate","cancelAnimFrame","Class","props","NewClass","initialize","callInitHooks","parentProto","__super__","constructor","statics","includes","_initHooks","_initHooksCalled","include","mergeOptions","addInitHook","init","Evented","on","types","type","_on","off","_events","_off","events","contextId","indexKey","indexLenKey","typeIndex","ctx","listeners","listener","splice","fire","propagate","listens","event","target","_propagateEvent","_eventParents","once","handler","addEventParent","removeEventParent","e","layer","addEventListener","removeEventListener","clearAllEventListeners","addOneTimeEventListener","fireEvent","hasEventListeners","Mixin","Events","ua","navigator","userAgent","toLowerCase","doc","documentElement","ie","webkit","phantomjs","android23","search","chrome","gecko","opera","mobile","orientation","msPointer","PointerEvent","MSPointerEvent","pointer","pointerEnabled","ie3d","style","webkit3d","WebKitCSSMatrix","gecko3d","opera12","touch","L_NO_TOUCH","DocumentTouch","Browser","ielt9","android","safari","any3d","L_DISABLE_3D","mobileWebkit","mobileWebkit3d","mobileOpera","mobileGecko","retina","devicePixelRatio","screen","deviceXDPI","logicalXDPI","Point","y","clone","add","point","_add","subtract","_subtract","divideBy","_divideBy","multiplyBy","_multiplyBy","scaleBy","unscaleBy","_round","floor","_floor","ceil","_ceil","distanceTo","sqrt","equals","contains","abs","Bounds","a","b","points","getCenter","getBottomLeft","getTopRight","getSize","bounds","intersects","min2","max2","xIntersects","yIntersects","overlaps","xOverlaps","yOverlaps","isValid","Transformation","c","_a","_b","_c","_d","transform","scale","_transform","untransform","DomUtil","get","getElementById","getStyle","currentStyle","defaultView","css","getComputedStyle","tagName","className","container","createElement","appendChild","remove","parent","parentNode","removeChild","empty","firstChild","toFront","toBack","insertBefore","hasClass","classList","getClass","RegExp","test","addClass","classes","setClass","removeClass","baseVal","setOpacity","opacity","_setOpacityIE","filter","filterName","filters","item","Enabled","Opacity","testProp","setTransform","offset","pos","TRANSFORM","setPosition","_leaflet_pos","left","top","getPosition","transition","TRANSITION","TRANSITION_END","disableTextSelection","DomEvent","preventDefault","enableTextSelection","userSelectProperty","_userSelect","disableImageDrag","enableImageDrag","preventOutline","element","tabIndex","restoreOutline","_outlineElement","_outlineStyle","outline","LatLng","lat","lng","alt","isNaN","maxMargin","latLng","margin","precision","other","CRS","Earth","distance","wrap","wrapLatLng","toBounds","sizeInMeters","latAccuracy","lngAccuracy","cos","PI","latLngBounds","lon","LatLngBounds","southWest","northEast","latlngs","sw","_southWest","ne","_northEast","sw2","ne2","pad","bufferRatio","heightBuffer","widthBuffer","getSouthWest","getNorthEast","getNorthWest","getNorth","getWest","getSouthEast","getSouth","getEast","latIntersects","lngIntersects","latOverlaps","lngOverlaps","toBBoxString","Projection","LonLat","project","latlng","unproject","SphericalMercator","R","MAX_LATITUDE","sin","log","atan","exp","latLngToPoint","zoom","projectedPoint","projection","transformation","pointToLatLng","untransformedPoint","LN2","getProjectedBounds","infinite","s","wrapLng","wrapLat","Simple","latlng1","latlng2","dx","dy","rad","lat1","lat2","acos","EPSG3857","code","EPSG900913","EPSG4326","Map","crs","fadeAnimation","trackResize","markerZoomAnimation","maxBoundsViscosity","transform3DLimit","_initContainer","_initLayout","_onResize","_initEvents","maxBounds","setMaxBounds","_zoom","_limitZoom","center","setView","reset","_handlers","_layers","_zoomBoundLayers","_sizeChanged","_addLayers","layers","getZoom","_resetView","setZoom","_loaded","zoomIn","delta","zoomOut","setZoomAround","getZoomScale","viewHalf","containerPoint","latLngToContainerPoint","centerOffset","newCenter","containerPointToLatLng","_getBoundsCenterZoom","getBounds","paddingTL","paddingTopLeft","padding","paddingBR","paddingBottomRight","getBoundsZoom","maxZoom","paddingOffset","swPoint","nePoint","fitBounds","fitWorld","panTo","pan","panBy","_rawPanBy","_panInsideMaxBounds","setMinZoom","minZoom","setMaxZoom","panInsideBounds","_enforcingBounds","_limitCenter","invalidateSize","animate","oldSize","_lastCenter","newSize","oldCenter","debounceMoveend","_sizeTimer","stop","_flyToFrame","_panAnim","addHandler","HandlerClass","enable","_container","_leaflet","_mapPane","_clearControlPos","_clearHandlers","createPane","pane","_panes","_checkIfLoaded","_moved","layerPointToLatLng","_getCenterLayerPoint","getPixelBounds","getMinZoom","_layersMinZoom","getMaxZoom","_layersMaxZoom","Infinity","inside","size","nw","se","zoomNotFound","boundsSize","_size","clientWidth","clientHeight","topLeftPoint","_getTopLeftPoint","getPixelOrigin","_pixelOrigin","getPixelWorldBounds","getPane","getPanes","getContainer","toZoom","fromZoom","getScaleZoom","latLngToLayerPoint","containerPointToLayerPoint","_getMapPanePos","layerPointToContainerPoint","layerPoint","mouseEventToContainerPoint","getMousePosition","mouseEventToLayerPoint","mouseEventToLatLng","addListener","_onScroll","_fadeAnimated","position","_initPanes","_initControlPos","panes","_paneRenderers","markerPane","shadowPane","loading","zoomChanged","_moveStart","_move","_moveEnd","_getNewPixelOrigin","_getZoomSpan","_targets","onOff","_handleDOMEvent","_onMoveEnd","_resizeRequest","scrollTop","scrollLeft","_findEventTargets","targets","isHover","srcElement","_isExternalTarget","_skipped","keyCode","synth","_fireDOMEvent","_stopped","_simulated","_draggableMoved","originalEvent","isMarker","Marker","getLatLng","nonBubblingEvents","draggable","dragging","moved","boxZoom","disable","whenReady","callback","pixelOrigin","_latLngToNewLayerPoint","topLeft","_getCenterOffset","centerPoint","viewBounds","_getBoundsOffset","_limitOffset","newBounds","pxBounds","nwOffset","seOffset","_rebound","right","map","Layer","addTo","addLayer","removeFrom","_map","_mapToAdd","removeLayer","addInteractiveTarget","targetEl","removeInteractiveTarget","_layerAdd","hasLayer","_zoomAnimated","getEvents","onAdd","getAttribution","attributionControl","addAttribution","beforeAdd","onRemove","removeAttribution","eachLayer","method","_addZoomLimit","_updateZoomLevels","_removeZoomLimit","oldZoomSpan","Mercator","R_MINOR","r","tmp","con","ts","tan","phi","dphi","EPSG3395","GridLayer","tileSize","zIndex","updateWhenIdle","updateInterval","attribution","_levels","_tiles","_update","_tileZoom","bringToFront","_setAutoZIndex","bringToBack","_updateOpacity","setZIndex","_updateZIndex","isLoading","_loading","redraw","_removeAllTiles","viewreset","_resetAll","moveend","_onMove","move","zoomanim","_animateZoom","createTile","getTileSize","compare","children","edgeZIndex","isFinite","now","nextFrame","willPrune","tile","current","loaded","fade","active","_noPrune","_pruneTiles","_fadeFrame","_updateLevels","z","level","origin","_setZoomTransform","offsetWidth","_level","retain","coords","_retainParent","_retainChildren","_removeTile","x2","y2","z2","animating","pinch","flyTo","_setView","noUpdate","noPrune","tileZoom","tileZoomChanged","_abortLoading","_resetGrid","_setZoomTransforms","translate","_tileSize","_globalTileRange","_pxBoundsToTileRange","_wrapX","noWrap","_wrapY","_animatingZoom","_getTiledPixelBounds","pixelCenter","halfSize","pixelBounds","tileRange","tileCenter","queue","_isValidTile","_tileCoordsToKey","sort","fragment","createDocumentFragment","_addTile","tileBounds","_tileCoordsToBounds","_keyToBounds","_keyToTileCoords","nwPoint","sePoint","k","_initTile","width","height","onselectstart","onmousemove","WebkitBackfaceVisibility","tilePos","_getTilePos","_wrapCoords","_tileReady","err","error","_noTilesToLoad","newCoords","gridLayer","TileLayer","subdomains","errorTileUrl","zoomOffset","maxNativeZoom","tms","zoomReverse","detectRetina","crossOrigin","url","_url","_onTileRemove","setUrl","noRedraw","done","_tileOnLoad","_tileOnError","getTileUrl","_getSubdomain","_getZoomForUrl","errorUrl","zoomN","onload","tilePoint","index","onerror","complete","tileLayer","WMS","defaultWmsParams","service","request","styles","format","transparent","wmsParams","_crs","_wmsVersion","parseFloat","projectionKey","bbox","setParams","wms","ImageOverlay","interactive","_bounds","_image","_initImage","_reset","setStyle","styleOpts","setBounds","getElement","img","image","imageOverlay","Icon","createIcon","oldIcon","_createIcon","createShadow","_getIconUrl","_createImg","_setIconStyles","anchor","shadowAnchor","iconAnchor","marginLeft","marginTop","icon","Default","iconSize","popupAnchor","shadowSize","path","imagePath","scripts","getElementsByTagName","leafletRe","match","keyboard","zIndexOffset","riseOffset","_latlng","_initIcon","update","enabled","removeHooks","_removeIcon","_removeShadow","setLatLng","oldLatLng","setZIndexOffset","setIcon","_popup","bindPopup","_icon","_setPos","classToAdd","addIcon","title","riseOnHover","mouseover","_bringToFront","mouseout","_resetZIndex","newShadow","_shadow","addShadow","_initInteraction","_zIndex","opt","Handler","MarkerDrag","marker","DivIcon","html","div","innerHTML","bgPos","backgroundPosition","divIcon","closePopupOnClick","Popup","minWidth","maxWidth","autoPan","autoPanPadding","closeButton","autoClose","zoomAnimation","source","_source","_removeTimeout","popup","openOn","openPopup","_updatePosition","_adjustPan","getContent","_content","setContent","content","visibility","_updateContent","_updateLayout","closeOnClick","preclick","_close","keepInView","isOpen","closePopup","prefix","_closeButton","href","_onCloseButtonClick","wrapper","_wrapper","_contentNode","disableClickPropagation","disableScrollPropagation","stopPropagation","_tipContainer","_tip","node","hasChildNodes","whiteSpace","offsetHeight","maxHeight","scrolledClass","_containerWidth","bottom","_containerBottom","_containerLeft","_inProgress","containerHeight","containerWidth","layerPos","containerPos","autoPanPaddingTopLeft","autoPanPaddingBottomRight","_popupHandlersAdded","click","_openPopup","_movePopup","_originalPopupOffset","unbindPopup","FeatureGroup","_popupAnchor","togglePopup","isPopupOpen","setPopupContent","getPopup","Path","_getPopupAnchor","offsetToAdd","LayerGroup","getLayerId","clearLayers","invoke","methodName","getLayer","getLayers","layerGroup","featureGroup","Renderer","zoomstart","_onZoomStart","_onZoom","_onAnimZoom","ev","_updateTransform","currentCenterPoint","_center","destCenterPoint","topLeftOffset","p","getRenderer","renderer","_getPaneRenderer","_renderer","preferCanvas","canvas","svg","SVG","Canvas","stroke","color","weight","lineCap","lineJoin","fillOpacity","fillRule","_initPath","_addPath","_removePath","zoomend","_project","_updatePath","_updateStyle","_bringToBack","_path","_clickTolerance","LineUtil","simplify","tolerance","sqTolerance","_reducePoints","_simplifyDP","pointToSegmentDistance","p1","p2","_sqClosestPointOnSegment","closestPointOnSegment","ArrayConstructor","Uint8Array","markers","_simplifyDPStep","newPoints","first","last","maxSqDist","sqDist","reducedPoints","prev","_sqDist","clipSegment","useLastCode","codeA","_lastCode","_getBitCode","codeB","codeOut","newCode","_getEdgeIntersection","dot","t","Polyline","smoothFactor","_setLatLngs","getLatLngs","_latlngs","setLatLngs","isEmpty","closestLayerPoint","minDistance","minPoint","closest","jLen","_parts","halfDist","segDist","dist","ratio","_rings","addLatLng","_defaultShape","_convertLatLngs","_flat","result","flat","_projectLatlngs","w","_pxBounds","ring","_clipPoints","noClip","parts","len2","segment","_simplifyPoints","_updatePoly","polyline","PolyUtil","clipPolygon","clippedPoints","edges","edge","lu","_code","Polygon","fill","f","area","pop","clipped","polygon","Rectangle","_boundsToLatLngs","rectangle","CircleMarker","radius","_radius","setRadius","getRadius","_point","_updateBounds","r2","_radiusY","_updateCircle","_empty","circleMarker","Circle","_mRadius","half","latR","lngR","circle","legacyOptions","setAttribute","_rootGroup","_svgSize","dashArray","removeAttribute","dashOffset","fillColor","pointerEvents","closed","_setPath","pointsToPath","arc","createElementNS","rings","createSVGRect","vml","shape","behavior","adj","coordsize","_stroke","_fill","stroked","filled","dashStyle","endcap","joinstyle","v","namespaces","_draw","_onMouseMove","_onClick","_handleMouseOut","_ctx","getContext","_drawnLayers","m","_removed","_requestRedraw","_redrawBounds","_redrawRequest","_redraw","clear","_clear","save","beginPath","rect","clip","restore","closePath","_fillStroke","globalCompositeOperation","globalAlpha","fillStyle","_prevWeight","lineWidth","strokeStyle","_containsPoint","_fakeStop","_fireEvent","_draggable","_moving","_handleMouseHover","_hoveredLayer","part","GeoJSON","geojson","addData","features","feature","geometries","geometry","coordinates","geometryToLayer","asFeature","defaultOptions","resetStyle","onEachFeature","_setLayerStyle","pointToLayer","coordsToLatLng","coordsToLatLngs","properties","levelsDeep","latLngToCoords","latLngsToCoords","getFeature","newGeometry","geoJSON","PointToGeoJSON","toGeoJSON","multi","holes","toMultiPoint","isGeometryCollection","jsons","json","geoJson","eventsKey","originalHandler","addPointerListener","addDoubleTapListener","_filterClick","attachEvent","removePointerListener","removeDoubleTapListener","detachEvent","cancelBubble","Draggable","START","dblclick","returnValue","clientX","clientY","getBoundingClientRect","clientLeft","clientTop","getWheelDelta","wheelDelta","detail","_skipEvents","skipped","related","relatedTarget","timeStamp","elapsed","_lastClick","_simulatedClick","removeListener","END","mousedown","touchstart","pointerdown","MSPointerDown","MOVE","dragStartTarget","_element","_dragStartTarget","_preventOutline","_enabled","_onDown","_dragging","shiftKey","which","button","touches","_startPoint","_startPos","_newPos","_onUp","newPoint","body","_lastTarget","_animRequest","_lastEvent","addHooks","inertia","inertiaDeceleration","inertiaMaxSpeed","easeLinearity","worldCopyJump","Drag","down","dragstart","_onDragStart","drag","_onDrag","dragend","_onDragEnd","_onPreDragLimit","_onPreDragWrap","_onZoomEnd","_offsetLimit","_viscosity","_positions","_times","_lastTime","_lastPos","_absPos","shift","pxCenter","pxWorldCenter","_initialWorldOffset","_worldWidth","_viscousLimit","threshold","limit","worldWidth","halfWidth","newX1","newX2","newX","noInertia","direction","duration","ease","speedVector","speed","limitedSpeed","limitedSpeedVector","decelerationDuration","noMoveStart","doubleClickZoom","DoubleClickZoom","_onDoubleClick","oldZoom","scrollWheelZoom","wheelDebounceTime","ScrollWheelZoom","mousewheel","_onWheelScroll","MozMousePixelScroll","_delta","debounce","_lastMousePos","_startTime","_timer","_performZoom","_touchstart","_touchend","doubleTap","delay","onTouchStart","count","_pointersCount","onTouchEnd","newTouch","prop","pre","touchend","POINTER_DOWN","POINTER_MOVE","POINTER_UP","POINTER_CANCEL","_pointers","_addPointerStart","_addPointerMove","_addPointerEnd","onDown","pointerType","MSPOINTER_TYPE_MOUSE","_handlePointer","_pointerDocListener","pointerUp","_globalPointerUp","_globalPointerDown","_globalPointerMove","pointerId","changedTouches","onMove","buttons","onUp","touchZoom","bounceAtZoomLimits","TouchZoom","_onTouchStart","_zooming","_centerPoint","_startLatLng","_pinchStartLatLng","_startDist","_startZoom","_onTouchMove","_onTouchEnd","moveFn","tap","tapTolerance","Tap","_fireClick","_holdTimeout","_isTapValid","_simulateEvent","touchmove","simulatedEvent","createEvent","initMouseEvent","screenX","screenY","dispatchEvent","BoxZoom","_pane","overlayPane","_onMouseDown","_resetState","contextmenu","mousemove","mouseup","_onMouseUp","keydown","_onKeyDown","_box","_finish","boxZoomBounds","keyboardPanOffset","keyboardZoomOffset","Keyboard","keyCodes","up","_setPanOffset","_setZoomOffset","focus","_onFocus","blur","_onBlur","_addHooks","_removeHooks","_focused","docEl","scrollTo","keys","_panKeys","codes","_zoomKeys","altKey","ctrlKey","metaKey","_marker","shadow","iconPos","Control","removeControl","addControl","corner","_controlCorners","_refocusOnMap","control","corners","l","_controlContainer","createCorner","vSide","hSide","Zoom","zoomInText","zoomInTitle","zoomOutText","zoomOutTitle","zoomName","_zoomInButton","_createButton","_zoomIn","_zoomOutButton","_zoomOut","_updateDisabled","_disabled","link","zoomControl","Attribution","_attributions","setPrefix","text","attribs","prefixAndAttribs","Scale","metric","imperial","_addScales","_mScale","_iScale","maxMeters","_updateScales","_updateMetric","_updateImperial","meters","_getRoundNum","label","_updateScale","maxFeet","maxMiles","miles","feet","pow10","Layers","collapsed","autoZIndex","hideSingleBase","baseLayers","overlays","_lastZIndex","_handlingClick","_addLayer","_checkDisabledLayers","addBaseLayer","addOverlay","_onLayerChange","form","_form","mouseenter","_expand","mouseleave","_collapse","_layersLink","_onInputClick","_baseLayersList","_separator","_overlaysList","overlay","baseLayersPresent","overlaysPresent","baseLayersCount","_addItem","display","_createRadioElement","checked","radioHtml","radioFragment","input","defaultChecked","layerId","holder","inputs","addedLayers","removedLayers","acceptableHeight","offsetTop","disabled","PosAnimation","run","newPos","_el","_duration","_easeOutPower","_offset","_animate","_step","_complete","_animId","_runFrame","_easeOut","progress","_tryAnimatedZoom","_tryAnimatedPan","step","_onPanTransitionStep","end","_onPanTransitionEnd","zoomAnimationThreshold","zoomAnimated","_createAnimProxy","_proxy","_catchTransitionEnd","proxy","mapPane","_onZoomTransitionEnd","propertyName","_nothingToAnimate","getElementsByClassName","startAnim","_animateToCenter","_animateToZoom","targetCenter","targetZoom","from","to","startZoom","w0","w1","u1","rho","rho2","sinh","n","cosh","tanh","r0","u","easeOut","start","S","frame","flyToBounds","_defaultLocateOptions","timeout","watch","locate","_locateOptions","_handleGeolocationError","message","onResponse","_handleGeolocationResponse","onError","_locationWatchId","geolocation","watchPosition","getCurrentPosition","stopLocate","clearWatch","latitude","longitude","accuracy","timestamp","Toolbar","baseClass","actions","_toolbar_type","_toolbar_class_id","_arguments","currentToolbar","_toolbars","_calculateDepth","appendToContainer","Action","action","_ul","_getActionConstructor","toolbar","_active","_hide","_show","depth","parentToolbar","toolbar_class_id","ToolbarAction","toolbarIcon","tooltip","subToolbar","defaultIconOptions","iconOptions","_link","_addSubToolbar","toolbarAction","extendOptions","_control","_setStyles","icons","querySelectorAll","buttonHeights","toolbarWidth","toolbarHeight","tipSize","tipAnchor","parseInt","Zoomify","tileGroupPrefix","tilesPerTileGroup","imageSize","_imageSize","_gridSize","_getGridSize","reverse","maxZoomGrid","maxX","maxY","southEast","gridSize","realTileSize","displayTileSize","scaleFactor","g","_getTileGroup","zoomify","parseParamString","searchUrl","parsedParams","substring","forEach","paramPair","splitPair","decodeURIComponent","UrlView","viewLoaded","_trySetView","_onMapMoved","urlViewParams","location","urlParams","mapView","_getMapView","_updateSearchLocation","searchLocation","history","replaceState","mapCenter","mapZoom","getLatLngPrecision","toFixed","latLng1","latLng2","pixelLatLng","latPrecision","lngPrecision","urlView","factory","require","Editable","FORWARD","BACKWARD","polygonClass","polylineClass","markerClass","drawingCSSClass","drawingCursor","editLayer","createEditLayer","featuresLayer","createFeaturesLayer","forwardLineGuide","createLineGuide","backwardLineGuide","fireAndForward","editTools","lineGuideOptions","createVertexIcon","TouchVertexIcon","VertexIcon","moveForwardLineGuide","moveBackwardLineGuide","anchorForwardLineGuide","anchorBackwardLineGuide","attachForwardLineGuide","attachBackwardLineGuide","detachForwardLineGuide","detachBackwardLineGuide","registerForDrawing","editor","onMouseMove","_drawingEditor","unregisterForDrawing","onMousedown","onMouseup","defaultMapCursor","cursor","_drawing","cancelDrawing","_mouseDown","onDrawingClick","drawing","stopDrawing","commitDrawing","connectCreatedToMap","startPolyline","line","createPolyline","enableEdit","newShape","startPolygon","createPolygon","startMarker","createMarker","startDrawing","startHole","newHole","editOptions","makeCancellable","cancel","_cancelled","editToolsClass","editable","VertexMarker","tools","__vertex","onDrag","onDragStart","onDragEnd","onClick","onContextMenu","onMouseDown","addMiddleMarkers","middleMarker","delete","vertex","onVertexMarkerDrag","refresh","updateLatLng","next","getNext","onVertexMarkerDragStart","onVertexMarkerDragEnd","onVertexMarkerClick","onVertexMarkerContextMenu","onVertexMarkerMouseDown","onVertexDeleted","deleteShape","resetMiddleMarker","getIndex","getLastIndex","getPrevious","previousIndex","CLOSED","previous","nextIndex","addMiddleMarker","skipMiddleMarkers","splitShape","continue","continueBackward","continueForward","vertexMarkerClass","MiddleMarker","computeLatLng","_opacity","setVisibility","leftPoint","rightPoint","hide","show","onMiddleMarkerMouseDown","addVertexMarker","middleMarkerClass","BaseEditor","onEnable","onDisable","onEditing","onStartDrawing","onEndDrawing","onCancelDrawing","onCommitDrawing","endDrawing","processDrawingClick","MarkerEditor","PathEditor","MIN_VERTEX","initVertexMarkers","addVertexMarkers","commit","onVertexMarkerCtrlClick","onVertexMarkerAltClick","onVertexMarkerShiftClick","onVertexMarkerMetaKeyClick","_drawnLatLngs","onVertexRawMarkerClick","vertexCanBeDeleted","setDrawnLatLngs","getDefaultLatLngs","startDrawingForward","unshift","newPointForward","newPointBackward","console","removeLatLng","addNewEmptyShape","self","inplaceDelete","Number","MAX_VALUE","spliceDelete","doDelete","ensureNotFlat","deleteShapeAt","shapeAt","appendShape","insertShape","prependShape","ensureMulti","formatShape","PolylineEditor","startDrawingBackward","shapeIndex","second","PolygonEditor","addNewEmptyHole","EditableMixin","createEditor","Klass","editorClass","getEditorClass","editEnabled","disableEdit","toggleEdit","polylineEditorClass","isInLatLngs","polygonEditorClass","l1","l2","markerEditorClass","ThumbnailMap","containerClass","buttonClass","aimingRectOptions","toggleDisplay","autoToggleDisplay","hideText","showText","_layer","_mainMap","_miniMap","_userToggledDisplay","_minimized","_addToggleButton","_aimingRect","_onMainMapMoving","_onMainMapMoved","_onMiniMapClicked","thumbnailBounds","_setDisplay","_decideMinimized","_onMiniMapClick","getThumbnailMap","isMinimized","buttonClasses","_toggleDisplayButton","_toggleDisplayButtonClicked","toggleMap","minimize","containsAll","containsNone","_updateRectangle","thumbnailmap","FeatureStorage","FS","JSON","exportUrl","importUrl","load","jsonid","onSucces","xmlhttp","XMLHttpRequest","open","readyState","status","parse","responseText","send","setRequestHeader","uri","storageID","stringify","featurestorage","fs","Myjson","myjson","Fullscreen","false","true","_toggleTitle","_click","toggleFullscreen","isFullscreen","_isFullscreen","exitFullscreen","mozCancelFullScreen","webkitCancelFullScreen","msExitFullscreen","_setFullscreen","requestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","Element","ALLOW_KEYBOARD_INPUT","msRequestFullscreen","fullscreen","_onFullscreenChange","fullscreenElement","mozFullScreenElement","webkitFullscreenElement","msFullscreenElement","fullscreenControl","fullscreenchange","onFullscreenChange","humanReadable","LN10","resunits","scaleExp","magnitude","unit","FeatureProperties","getProperties","setProperties","_isFeature","_initFeature","Label","onEdit","_updateSize","sizeFactor","sizeFactorLimited","fontSize","scrollWidth","scrollHeight","offsetAnchor","showLabelEditor","autoOpen","popupOptions","_popupContent","currentLabel","DoneAction","doneAction","CancelAction","cancelAction","defaultUnit","humanString","Ruler","rulerStyle","overlapsClass","decimals","_editTools","_createPopup","_distancePopup","distanceObj","warn","_rulerLine","_onMarkerAdded","_onDrawingMove","_onPopupClosed","_updatePopupTransparancy","_popupAnimId","popupElement","_getPopupBounds","noOverlap","every","popupContent","popupContentSize","popupOffset","leftTop","rightBottom","_initRuler","_rulerHandler","ruler","RulerAction","newFeature","_currentFeature","_onDrawingStart","_onDrawingCancel","_onDrawingEnd","newPolygon","_onDrawingFirstClicked","newLabel","_onDrawingClick","SimpleFeatureAction","_feature","DoneEdit","EditFeature","DeleteFeature","FeatureToFront","FeatureToBack","MoveLabel","EditLabel","ShowLink","parentAction","_featureLayer","_storageController","storage","registerShowHook","onShow","_getInput","_inputField","caller","inputEle","succesCallback","onLink","that","_getLink","setSelectionRange","dataValue","searchParams","newSearch","pathname","hash","ExportShapes","_showHooks","hook","ImportShapes","Legend","lastChild","hideLegend","showLegend","legend","OverlayLegend","_overlay","_overlayItems","_contentUpdate","overlayItems","overlayList","overlayItem","overlayName","colorBox","background","createTextNode","getOverlayItems","getOverlayItem","overlaylegend"],"mappings":"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","file":"bundle.min.js","sourcesContent":["/*\n Leaflet 1.0.0-beta.2 (55fe462), a JS library for interactive maps. http://leafletjs.com\n (c) 2010-2015 Vladimir Agafonkin, (c) 2010-2011 CloudMade\n*/\n(function (window, document, undefined) {\nvar L = {\n\tversion: '1.0.0-beta.2'\n};\n\nfunction expose() {\n\tvar oldL = window.L;\n\n\tL.noConflict = function () {\n\t\twindow.L = oldL;\n\t\treturn this;\n\t};\n\n\twindow.L = L;\n}\n\n// define Leaflet for Node module pattern loaders, including Browserify\nif (typeof module === 'object' && typeof module.exports === 'object') {\n\tmodule.exports = L;\n\n// define Leaflet as an AMD module\n} else if (typeof define === 'function' && define.amd) {\n\tdefine(L);\n}\n\n// define Leaflet as a global L variable, saving the original L to restore later if needed\nif (typeof window !== 'undefined') {\n\texpose();\n}\n\n\n\n/*\n * L.Util contains various utility functions used throughout Leaflet code.\n */\n\nL.Util = {\n\t// extend an object with properties of one or more other objects\n\textend: function (dest) {\n\t\tvar i, j, len, src;\n\n\t\tfor (j = 1, len = arguments.length; j < len; j++) {\n\t\t\tsrc = arguments[j];\n\t\t\tfor (i in src) {\n\t\t\t\tdest[i] = src[i];\n\t\t\t}\n\t\t}\n\t\treturn dest;\n\t},\n\n\t// create an object from a given prototype\n\tcreate: Object.create || (function () {\n\t\tfunction F() {}\n\t\treturn function (proto) {\n\t\t\tF.prototype = proto;\n\t\t\treturn new F();\n\t\t};\n\t})(),\n\n\t// bind a function to be called with a given context\n\tbind: function (fn, obj) {\n\t\tvar slice = Array.prototype.slice;\n\n\t\tif (fn.bind) {\n\t\t\treturn fn.bind.apply(fn, slice.call(arguments, 1));\n\t\t}\n\n\t\tvar args = slice.call(arguments, 2);\n\n\t\treturn function () {\n\t\t\treturn fn.apply(obj, args.length ? args.concat(slice.call(arguments)) : arguments);\n\t\t};\n\t},\n\n\t// return unique ID of an object\n\tstamp: function (obj) {\n\t\t/*eslint-disable */\n\t\tobj._leaflet_id = obj._leaflet_id || ++L.Util.lastId;\n\t\treturn obj._leaflet_id;\n\t\t/*eslint-enable */\n\t},\n\n\tlastId: 0,\n\n\t// return a function that won't be called more often than the given interval\n\tthrottle: function (fn, time, context) {\n\t\tvar lock, args, wrapperFn, later;\n\n\t\tlater = function () {\n\t\t\t// reset lock and call if queued\n\t\t\tlock = false;\n\t\t\tif (args) {\n\t\t\t\twrapperFn.apply(context, args);\n\t\t\t\targs = false;\n\t\t\t}\n\t\t};\n\n\t\twrapperFn = function () {\n\t\t\tif (lock) {\n\t\t\t\t// called too soon, queue to call later\n\t\t\t\targs = arguments;\n\n\t\t\t} else {\n\t\t\t\t// call and lock until later\n\t\t\t\tfn.apply(context, arguments);\n\t\t\t\tsetTimeout(later, time);\n\t\t\t\tlock = true;\n\t\t\t}\n\t\t};\n\n\t\treturn wrapperFn;\n\t},\n\n\t// wrap the given number to lie within a certain range (used for wrapping longitude)\n\twrapNum: function (x, range, includeMax) {\n\t\tvar max = range[1],\n\t\t    min = range[0],\n\t\t    d = max - min;\n\t\treturn x === max && includeMax ? x : ((x - min) % d + d) % d + min;\n\t},\n\n\t// do nothing (used as a noop throughout the code)\n\tfalseFn: function () { return false; },\n\n\t// round a given number to a given precision\n\tformatNum: function (num, digits) {\n\t\tvar pow = Math.pow(10, digits || 5);\n\t\treturn Math.round(num * pow) / pow;\n\t},\n\n\t// trim whitespace from both sides of a string\n\ttrim: function (str) {\n\t\treturn str.trim ? str.trim() : str.replace(/^\\s+|\\s+$/g, '');\n\t},\n\n\t// split a string into words\n\tsplitWords: function (str) {\n\t\treturn L.Util.trim(str).split(/\\s+/);\n\t},\n\n\t// set options to an object, inheriting parent's options as well\n\tsetOptions: function (obj, options) {\n\t\tif (!obj.hasOwnProperty('options')) {\n\t\t\tobj.options = obj.options ? L.Util.create(obj.options) : {};\n\t\t}\n\t\tfor (var i in options) {\n\t\t\tobj.options[i] = options[i];\n\t\t}\n\t\treturn obj.options;\n\t},\n\n\t// make a URL with GET parameters out of a set of properties/values\n\tgetParamString: function (obj, existingUrl, uppercase) {\n\t\tvar params = [];\n\t\tfor (var i in obj) {\n\t\t\tparams.push(encodeURIComponent(uppercase ? i.toUpperCase() : i) + '=' + encodeURIComponent(obj[i]));\n\t\t}\n\t\treturn ((!existingUrl || existingUrl.indexOf('?') === -1) ? '?' : '&') + params.join('&');\n\t},\n\n\t// super-simple templating facility, used for TileLayer URLs\n\ttemplate: function (str, data) {\n\t\treturn str.replace(L.Util.templateRe, function (str, key) {\n\t\t\tvar value = data[key];\n\n\t\t\tif (value === undefined) {\n\t\t\t\tthrow new Error('No value provided for variable ' + str);\n\n\t\t\t} else if (typeof value === 'function') {\n\t\t\t\tvalue = value(data);\n\t\t\t}\n\t\t\treturn value;\n\t\t});\n\t},\n\n\ttemplateRe: /\\{ *([\\w_]+) *\\}/g,\n\n\tisArray: Array.isArray || function (obj) {\n\t\treturn (Object.prototype.toString.call(obj) === '[object Array]');\n\t},\n\n\tindexOf: function (array, el) {\n\t\tfor (var i = 0; i < array.length; i++) {\n\t\t\tif (array[i] === el) { return i; }\n\t\t}\n\t\treturn -1;\n\t},\n\n\t// minimal image URI, set to an image when disposing to flush memory\n\temptyImageUrl: 'data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs='\n};\n\n(function () {\n\t// inspired by http://paulirish.com/2011/requestanimationframe-for-smart-animating/\n\n\tfunction getPrefixed(name) {\n\t\treturn window['webkit' + name] || window['moz' + name] || window['ms' + name];\n\t}\n\n\tvar lastTime = 0;\n\n\t// fallback for IE 7-8\n\tfunction timeoutDefer(fn) {\n\t\tvar time = +new Date(),\n\t\t    timeToCall = Math.max(0, 16 - (time - lastTime));\n\n\t\tlastTime = time + timeToCall;\n\t\treturn window.setTimeout(fn, timeToCall);\n\t}\n\n\tvar requestFn = window.requestAnimationFrame || getPrefixed('RequestAnimationFrame') || timeoutDefer,\n\t    cancelFn = window.cancelAnimationFrame || getPrefixed('CancelAnimationFrame') ||\n\t               getPrefixed('CancelRequestAnimationFrame') || function (id) { window.clearTimeout(id); };\n\n\n\tL.Util.requestAnimFrame = function (fn, context, immediate) {\n\t\tif (immediate && requestFn === timeoutDefer) {\n\t\t\tfn.call(context);\n\t\t} else {\n\t\t\treturn requestFn.call(window, L.bind(fn, context));\n\t\t}\n\t};\n\n\tL.Util.cancelAnimFrame = function (id) {\n\t\tif (id) {\n\t\t\tcancelFn.call(window, id);\n\t\t}\n\t};\n})();\n\n// shortcuts for most used utility functions\nL.extend = L.Util.extend;\nL.bind = L.Util.bind;\nL.stamp = L.Util.stamp;\nL.setOptions = L.Util.setOptions;\n\n\n\n/*\n * L.Class powers the OOP facilities of the library.\n * Thanks to John Resig and Dean Edwards for inspiration!\n */\n\nL.Class = function () {};\n\nL.Class.extend = function (props) {\n\n\t// extended class with the new prototype\n\tvar NewClass = function () {\n\n\t\t// call the constructor\n\t\tif (this.initialize) {\n\t\t\tthis.initialize.apply(this, arguments);\n\t\t}\n\n\t\t// call all constructor hooks\n\t\tthis.callInitHooks();\n\t};\n\n\tvar parentProto = NewClass.__super__ = this.prototype;\n\n\tvar proto = L.Util.create(parentProto);\n\tproto.constructor = NewClass;\n\n\tNewClass.prototype = proto;\n\n\t// inherit parent's statics\n\tfor (var i in this) {\n\t\tif (this.hasOwnProperty(i) && i !== 'prototype') {\n\t\t\tNewClass[i] = this[i];\n\t\t}\n\t}\n\n\t// mix static properties into the class\n\tif (props.statics) {\n\t\tL.extend(NewClass, props.statics);\n\t\tdelete props.statics;\n\t}\n\n\t// mix includes into the prototype\n\tif (props.includes) {\n\t\tL.Util.extend.apply(null, [proto].concat(props.includes));\n\t\tdelete props.includes;\n\t}\n\n\t// merge options\n\tif (proto.options) {\n\t\tprops.options = L.Util.extend(L.Util.create(proto.options), props.options);\n\t}\n\n\t// mix given properties into the prototype\n\tL.extend(proto, props);\n\n\tproto._initHooks = [];\n\n\t// add method for calling all hooks\n\tproto.callInitHooks = function () {\n\n\t\tif (this._initHooksCalled) { return; }\n\n\t\tif (parentProto.callInitHooks) {\n\t\t\tparentProto.callInitHooks.call(this);\n\t\t}\n\n\t\tthis._initHooksCalled = true;\n\n\t\tfor (var i = 0, len = proto._initHooks.length; i < len; i++) {\n\t\t\tproto._initHooks[i].call(this);\n\t\t}\n\t};\n\n\treturn NewClass;\n};\n\n\n// method for adding properties to prototype\nL.Class.include = function (props) {\n\tL.extend(this.prototype, props);\n};\n\n// merge new default options to the Class\nL.Class.mergeOptions = function (options) {\n\tL.extend(this.prototype.options, options);\n};\n\n// add a constructor hook\nL.Class.addInitHook = function (fn) { // (Function) || (String, args...)\n\tvar args = Array.prototype.slice.call(arguments, 1);\n\n\tvar init = typeof fn === 'function' ? fn : function () {\n\t\tthis[fn].apply(this, args);\n\t};\n\n\tthis.prototype._initHooks = this.prototype._initHooks || [];\n\tthis.prototype._initHooks.push(init);\n};\n\n\n\n/*\n * L.Evented is a base class that Leaflet classes inherit from to handle custom events.\n */\n\nL.Evented = L.Class.extend({\n\n\ton: function (types, fn, context) {\n\n\t\t// types can be a map of types/handlers\n\t\tif (typeof types === 'object') {\n\t\t\tfor (var type in types) {\n\t\t\t\t// we don't process space-separated events here for performance;\n\t\t\t\t// it's a hot path since Layer uses the on(obj) syntax\n\t\t\t\tthis._on(type, types[type], fn);\n\t\t\t}\n\n\t\t} else {\n\t\t\t// types can be a string of space-separated words\n\t\t\ttypes = L.Util.splitWords(types);\n\n\t\t\tfor (var i = 0, len = types.length; i < len; i++) {\n\t\t\t\tthis._on(types[i], fn, context);\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t},\n\n\toff: function (types, fn, context) {\n\n\t\tif (!types) {\n\t\t\t// clear all listeners if called without arguments\n\t\t\tdelete this._events;\n\n\t\t} else if (typeof types === 'object') {\n\t\t\tfor (var type in types) {\n\t\t\t\tthis._off(type, types[type], fn);\n\t\t\t}\n\n\t\t} else {\n\t\t\ttypes = L.Util.splitWords(types);\n\n\t\t\tfor (var i = 0, len = types.length; i < len; i++) {\n\t\t\t\tthis._off(types[i], fn, context);\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t},\n\n\t// attach listener (without syntactic sugar now)\n\t_on: function (type, fn, context) {\n\n\t\tvar events = this._events = this._events || {},\n\t\t    contextId = context && context !== this && L.stamp(context);\n\n\t\tif (contextId) {\n\t\t\t// store listeners with custom context in a separate hash (if it has an id);\n\t\t\t// gives a major performance boost when firing and removing events (e.g. on map object)\n\n\t\t\tvar indexKey = type + '_idx',\n\t\t\t    indexLenKey = type + '_len',\n\t\t\t    typeIndex = events[indexKey] = events[indexKey] || {},\n\t\t\t    id = L.stamp(fn) + '_' + contextId;\n\n\t\t\tif (!typeIndex[id]) {\n\t\t\t\ttypeIndex[id] = {fn: fn, ctx: context};\n\n\t\t\t\t// keep track of the number of keys in the index to quickly check if it's empty\n\t\t\t\tevents[indexLenKey] = (events[indexLenKey] || 0) + 1;\n\t\t\t}\n\n\t\t} else {\n\t\t\t// individual layers mostly use \"this\" for context and don't fire listeners too often\n\t\t\t// so simple array makes the memory footprint better while not degrading performance\n\n\t\t\tevents[type] = events[type] || [];\n\t\t\tevents[type].push({fn: fn});\n\t\t}\n\t},\n\n\t_off: function (type, fn, context) {\n\t\tvar events = this._events,\n\t\t    indexKey = type + '_idx',\n\t\t    indexLenKey = type + '_len';\n\n\t\tif (!events) { return; }\n\n\t\tif (!fn) {\n\t\t\t// clear all listeners for a type if function isn't specified\n\t\t\tdelete events[type];\n\t\t\tdelete events[indexKey];\n\t\t\tdelete events[indexLenKey];\n\t\t\treturn;\n\t\t}\n\n\t\tvar contextId = context && context !== this && L.stamp(context),\n\t\t    listeners, i, len, listener, id;\n\n\t\tif (contextId) {\n\t\t\tid = L.stamp(fn) + '_' + contextId;\n\t\t\tlisteners = events[indexKey];\n\n\t\t\tif (listeners && listeners[id]) {\n\t\t\t\tlistener = listeners[id];\n\t\t\t\tdelete listeners[id];\n\t\t\t\tevents[indexLenKey]--;\n\t\t\t}\n\n\t\t} else {\n\t\t\tlisteners = events[type];\n\n\t\t\tif (listeners) {\n\t\t\t\tfor (i = 0, len = listeners.length; i < len; i++) {\n\t\t\t\t\tif (listeners[i].fn === fn) {\n\t\t\t\t\t\tlistener = listeners[i];\n\t\t\t\t\t\tlisteners.splice(i, 1);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// set the removed listener to noop so that's not called if remove happens in fire\n\t\tif (listener) {\n\t\t\tlistener.fn = L.Util.falseFn;\n\t\t}\n\t},\n\n\tfire: function (type, data, propagate) {\n\t\tif (!this.listens(type, propagate)) { return this; }\n\n\t\tvar event = L.Util.extend({}, data, {type: type, target: this}),\n\t\t    events = this._events;\n\n\t\tif (events) {\n\t\t\tvar typeIndex = events[type + '_idx'],\n\t\t\t    i, len, listeners, id;\n\n\t\t\tif (events[type]) {\n\t\t\t\t// make sure adding/removing listeners inside other listeners won't cause infinite loop\n\t\t\t\tlisteners = events[type].slice();\n\n\t\t\t\tfor (i = 0, len = listeners.length; i < len; i++) {\n\t\t\t\t\tlisteners[i].fn.call(this, event);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// fire event for the context-indexed listeners as well\n\t\t\tfor (id in typeIndex) {\n\t\t\t\ttypeIndex[id].fn.call(typeIndex[id].ctx, event);\n\t\t\t}\n\t\t}\n\n\t\tif (propagate) {\n\t\t\t// propagate the event to parents (set with addEventParent)\n\t\t\tthis._propagateEvent(event);\n\t\t}\n\n\t\treturn this;\n\t},\n\n\tlistens: function (type, propagate) {\n\t\tvar events = this._events;\n\n\t\tif (events && (events[type] || events[type + '_len'])) { return true; }\n\n\t\tif (propagate) {\n\t\t\t// also check parents for listeners if event propagates\n\t\t\tfor (var id in this._eventParents) {\n\t\t\t\tif (this._eventParents[id].listens(type, propagate)) { return true; }\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t},\n\n\tonce: function (types, fn, context) {\n\n\t\tif (typeof types === 'object') {\n\t\t\tfor (var type in types) {\n\t\t\t\tthis.once(type, types[type], fn);\n\t\t\t}\n\t\t\treturn this;\n\t\t}\n\n\t\tvar handler = L.bind(function () {\n\t\t\tthis\n\t\t\t    .off(types, fn, context)\n\t\t\t    .off(types, handler, context);\n\t\t}, this);\n\n\t\t// add a listener that's executed once and removed after that\n\t\treturn this\n\t\t    .on(types, fn, context)\n\t\t    .on(types, handler, context);\n\t},\n\n\t// adds a parent to propagate events to (when you fire with true as a 3rd argument)\n\taddEventParent: function (obj) {\n\t\tthis._eventParents = this._eventParents || {};\n\t\tthis._eventParents[L.stamp(obj)] = obj;\n\t\treturn this;\n\t},\n\n\tremoveEventParent: function (obj) {\n\t\tif (this._eventParents) {\n\t\t\tdelete this._eventParents[L.stamp(obj)];\n\t\t}\n\t\treturn this;\n\t},\n\n\t_propagateEvent: function (e) {\n\t\tfor (var id in this._eventParents) {\n\t\t\tthis._eventParents[id].fire(e.type, L.extend({layer: e.target}, e), true);\n\t\t}\n\t}\n});\n\nvar proto = L.Evented.prototype;\n\n// aliases; we should ditch those eventually\nproto.addEventListener = proto.on;\nproto.removeEventListener = proto.clearAllEventListeners = proto.off;\nproto.addOneTimeEventListener = proto.once;\nproto.fireEvent = proto.fire;\nproto.hasEventListeners = proto.listens;\n\nL.Mixin = {Events: proto};\n\n\n\n/*\n * L.Browser handles different browser and feature detections for internal Leaflet use.\n */\n\n(function () {\n\n\tvar ua = navigator.userAgent.toLowerCase(),\n\t    doc = document.documentElement,\n\n\t    ie = 'ActiveXObject' in window,\n\n\t    webkit    = ua.indexOf('webkit') !== -1,\n\t    phantomjs = ua.indexOf('phantom') !== -1,\n\t    android23 = ua.search('android [23]') !== -1,\n\t    chrome    = ua.indexOf('chrome') !== -1,\n\t    gecko     = ua.indexOf('gecko') !== -1  && !webkit && !window.opera && !ie,\n\n\t    mobile = typeof orientation !== 'undefined' || ua.indexOf('mobile') !== -1,\n\t    msPointer = !window.PointerEvent && window.MSPointerEvent,\n\t    pointer = (window.PointerEvent && navigator.pointerEnabled) || msPointer,\n\n\t    ie3d = ie && ('transition' in doc.style),\n\t    webkit3d = ('WebKitCSSMatrix' in window) && ('m11' in new window.WebKitCSSMatrix()) && !android23,\n\t    gecko3d = 'MozPerspective' in doc.style,\n\t    opera12 = 'OTransition' in doc.style;\n\n\tvar touch = !window.L_NO_TOUCH && !phantomjs && (pointer || 'ontouchstart' in window ||\n\t\t\t(window.DocumentTouch && document instanceof window.DocumentTouch));\n\n\tL.Browser = {\n\t\tie: ie,\n\t\tielt9: ie && !document.addEventListener,\n\t\twebkit: webkit,\n\t\tgecko: gecko,\n\t\tandroid: ua.indexOf('android') !== -1,\n\t\tandroid23: android23,\n\t\tchrome: chrome,\n\t\tsafari: !chrome && ua.indexOf('safari') !== -1,\n\n\t\tie3d: ie3d,\n\t\twebkit3d: webkit3d,\n\t\tgecko3d: gecko3d,\n\t\topera12: opera12,\n\t\tany3d: !window.L_DISABLE_3D && (ie3d || webkit3d || gecko3d) && !opera12 && !phantomjs,\n\n\t\tmobile: mobile,\n\t\tmobileWebkit: mobile && webkit,\n\t\tmobileWebkit3d: mobile && webkit3d,\n\t\tmobileOpera: mobile && window.opera,\n\t\tmobileGecko: mobile && gecko,\n\n\t\ttouch: !!touch,\n\t\tmsPointer: !!msPointer,\n\t\tpointer: !!pointer,\n\n\t\tretina: (window.devicePixelRatio || (window.screen.deviceXDPI / window.screen.logicalXDPI)) > 1\n\t};\n\n}());\n\n\n\n/*\n * L.Point represents a point with x and y coordinates.\n */\n\nL.Point = function (x, y, round) {\n\tthis.x = (round ? Math.round(x) : x);\n\tthis.y = (round ? Math.round(y) : y);\n};\n\nL.Point.prototype = {\n\n\tclone: function () {\n\t\treturn new L.Point(this.x, this.y);\n\t},\n\n\t// non-destructive, returns a new point\n\tadd: function (point) {\n\t\treturn this.clone()._add(L.point(point));\n\t},\n\n\t// destructive, used directly for performance in situations where it's safe to modify existing point\n\t_add: function (point) {\n\t\tthis.x += point.x;\n\t\tthis.y += point.y;\n\t\treturn this;\n\t},\n\n\tsubtract: function (point) {\n\t\treturn this.clone()._subtract(L.point(point));\n\t},\n\n\t_subtract: function (point) {\n\t\tthis.x -= point.x;\n\t\tthis.y -= point.y;\n\t\treturn this;\n\t},\n\n\tdivideBy: function (num) {\n\t\treturn this.clone()._divideBy(num);\n\t},\n\n\t_divideBy: function (num) {\n\t\tthis.x /= num;\n\t\tthis.y /= num;\n\t\treturn this;\n\t},\n\n\tmultiplyBy: function (num) {\n\t\treturn this.clone()._multiplyBy(num);\n\t},\n\n\t_multiplyBy: function (num) {\n\t\tthis.x *= num;\n\t\tthis.y *= num;\n\t\treturn this;\n\t},\n\n\tscaleBy: function (point) {\n\t\treturn new L.Point(this.x * point.x, this.y * point.y);\n\t},\n\n\tunscaleBy: function (point) {\n\t\treturn new L.Point(this.x / point.x, this.y / point.y);\n\t},\n\n\tround: function () {\n\t\treturn this.clone()._round();\n\t},\n\n\t_round: function () {\n\t\tthis.x = Math.round(this.x);\n\t\tthis.y = Math.round(this.y);\n\t\treturn this;\n\t},\n\n\tfloor: function () {\n\t\treturn this.clone()._floor();\n\t},\n\n\t_floor: function () {\n\t\tthis.x = Math.floor(this.x);\n\t\tthis.y = Math.floor(this.y);\n\t\treturn this;\n\t},\n\n\tceil: function () {\n\t\treturn this.clone()._ceil();\n\t},\n\n\t_ceil: function () {\n\t\tthis.x = Math.ceil(this.x);\n\t\tthis.y = Math.ceil(this.y);\n\t\treturn this;\n\t},\n\n\tdistanceTo: function (point) {\n\t\tpoint = L.point(point);\n\n\t\tvar x = point.x - this.x,\n\t\t    y = point.y - this.y;\n\n\t\treturn Math.sqrt(x * x + y * y);\n\t},\n\n\tequals: function (point) {\n\t\tpoint = L.point(point);\n\n\t\treturn point.x === this.x &&\n\t\t       point.y === this.y;\n\t},\n\n\tcontains: function (point) {\n\t\tpoint = L.point(point);\n\n\t\treturn Math.abs(point.x) <= Math.abs(this.x) &&\n\t\t       Math.abs(point.y) <= Math.abs(this.y);\n\t},\n\n\ttoString: function () {\n\t\treturn 'Point(' +\n\t\t        L.Util.formatNum(this.x) + ', ' +\n\t\t        L.Util.formatNum(this.y) + ')';\n\t}\n};\n\nL.point = function (x, y, round) {\n\tif (x instanceof L.Point) {\n\t\treturn x;\n\t}\n\tif (L.Util.isArray(x)) {\n\t\treturn new L.Point(x[0], x[1]);\n\t}\n\tif (x === undefined || x === null) {\n\t\treturn x;\n\t}\n\treturn new L.Point(x, y, round);\n};\n\n\n\n/*\n * L.Bounds represents a rectangular area on the screen in pixel coordinates.\n */\n\nL.Bounds = function (a, b) { // (Point, Point) or Point[]\n\tif (!a) { return; }\n\n\tvar points = b ? [a, b] : a;\n\n\tfor (var i = 0, len = points.length; i < len; i++) {\n\t\tthis.extend(points[i]);\n\t}\n};\n\nL.Bounds.prototype = {\n\t// extend the bounds to contain the given point\n\textend: function (point) { // (Point)\n\t\tpoint = L.point(point);\n\n\t\tif (!this.min && !this.max) {\n\t\t\tthis.min = point.clone();\n\t\t\tthis.max = point.clone();\n\t\t} else {\n\t\t\tthis.min.x = Math.min(point.x, this.min.x);\n\t\t\tthis.max.x = Math.max(point.x, this.max.x);\n\t\t\tthis.min.y = Math.min(point.y, this.min.y);\n\t\t\tthis.max.y = Math.max(point.y, this.max.y);\n\t\t}\n\t\treturn this;\n\t},\n\n\tgetCenter: function (round) { // (Boolean) -> Point\n\t\treturn new L.Point(\n\t\t        (this.min.x + this.max.x) / 2,\n\t\t        (this.min.y + this.max.y) / 2, round);\n\t},\n\n\tgetBottomLeft: function () { // -> Point\n\t\treturn new L.Point(this.min.x, this.max.y);\n\t},\n\n\tgetTopRight: function () { // -> Point\n\t\treturn new L.Point(this.max.x, this.min.y);\n\t},\n\n\tgetSize: function () {\n\t\treturn this.max.subtract(this.min);\n\t},\n\n\tcontains: function (obj) { // (Bounds) or (Point) -> Boolean\n\t\tvar min, max;\n\n\t\tif (typeof obj[0] === 'number' || obj instanceof L.Point) {\n\t\t\tobj = L.point(obj);\n\t\t} else {\n\t\t\tobj = L.bounds(obj);\n\t\t}\n\n\t\tif (obj instanceof L.Bounds) {\n\t\t\tmin = obj.min;\n\t\t\tmax = obj.max;\n\t\t} else {\n\t\t\tmin = max = obj;\n\t\t}\n\n\t\treturn (min.x >= this.min.x) &&\n\t\t       (max.x <= this.max.x) &&\n\t\t       (min.y >= this.min.y) &&\n\t\t       (max.y <= this.max.y);\n\t},\n\n\tintersects: function (bounds) { // (Bounds) -> Boolean\n\t\tbounds = L.bounds(bounds);\n\n\t\tvar min = this.min,\n\t\t    max = this.max,\n\t\t    min2 = bounds.min,\n\t\t    max2 = bounds.max,\n\t\t    xIntersects = (max2.x >= min.x) && (min2.x <= max.x),\n\t\t    yIntersects = (max2.y >= min.y) && (min2.y <= max.y);\n\n\t\treturn xIntersects && yIntersects;\n\t},\n\n\toverlaps: function (bounds) { // (Bounds) -> Boolean\n\t\tbounds = L.bounds(bounds);\n\n\t\tvar min = this.min,\n\t\t    max = this.max,\n\t\t    min2 = bounds.min,\n\t\t    max2 = bounds.max,\n\t\t    xOverlaps = (max2.x > min.x) && (min2.x < max.x),\n\t\t    yOverlaps = (max2.y > min.y) && (min2.y < max.y);\n\n\t\treturn xOverlaps && yOverlaps;\n\t},\n\n\tisValid: function () {\n\t\treturn !!(this.min && this.max);\n\t}\n};\n\nL.bounds = function (a, b) { // (Bounds) or (Point, Point) or (Point[])\n\tif (!a || a instanceof L.Bounds) {\n\t\treturn a;\n\t}\n\treturn new L.Bounds(a, b);\n};\n\n\n\n/*\n * L.Transformation is an utility class to perform simple point transformations through a 2d-matrix.\n */\n\nL.Transformation = function (a, b, c, d) {\n\tthis._a = a;\n\tthis._b = b;\n\tthis._c = c;\n\tthis._d = d;\n};\n\nL.Transformation.prototype = {\n\ttransform: function (point, scale) { // (Point, Number) -> Point\n\t\treturn this._transform(point.clone(), scale);\n\t},\n\n\t// destructive transform (faster)\n\t_transform: function (point, scale) {\n\t\tscale = scale || 1;\n\t\tpoint.x = scale * (this._a * point.x + this._b);\n\t\tpoint.y = scale * (this._c * point.y + this._d);\n\t\treturn point;\n\t},\n\n\tuntransform: function (point, scale) {\n\t\tscale = scale || 1;\n\t\treturn new L.Point(\n\t\t        (point.x / scale - this._b) / this._a,\n\t\t        (point.y / scale - this._d) / this._c);\n\t}\n};\n\n\n\n/*\n * L.DomUtil contains various utility functions for working with DOM.\n */\n\nL.DomUtil = {\n\tget: function (id) {\n\t\treturn typeof id === 'string' ? document.getElementById(id) : id;\n\t},\n\n\tgetStyle: function (el, style) {\n\n\t\tvar value = el.style[style] || (el.currentStyle && el.currentStyle[style]);\n\n\t\tif ((!value || value === 'auto') && document.defaultView) {\n\t\t\tvar css = document.defaultView.getComputedStyle(el, null);\n\t\t\tvalue = css ? css[style] : null;\n\t\t}\n\n\t\treturn value === 'auto' ? null : value;\n\t},\n\n\tcreate: function (tagName, className, container) {\n\n\t\tvar el = document.createElement(tagName);\n\t\tel.className = className;\n\n\t\tif (container) {\n\t\t\tcontainer.appendChild(el);\n\t\t}\n\n\t\treturn el;\n\t},\n\n\tremove: function (el) {\n\t\tvar parent = el.parentNode;\n\t\tif (parent) {\n\t\t\tparent.removeChild(el);\n\t\t}\n\t},\n\n\tempty: function (el) {\n\t\twhile (el.firstChild) {\n\t\t\tel.removeChild(el.firstChild);\n\t\t}\n\t},\n\n\ttoFront: function (el) {\n\t\tel.parentNode.appendChild(el);\n\t},\n\n\ttoBack: function (el) {\n\t\tvar parent = el.parentNode;\n\t\tparent.insertBefore(el, parent.firstChild);\n\t},\n\n\thasClass: function (el, name) {\n\t\tif (el.classList !== undefined) {\n\t\t\treturn el.classList.contains(name);\n\t\t}\n\t\tvar className = L.DomUtil.getClass(el);\n\t\treturn className.length > 0 && new RegExp('(^|\\\\s)' + name + '(\\\\s|$)').test(className);\n\t},\n\n\taddClass: function (el, name) {\n\t\tif (el.classList !== undefined) {\n\t\t\tvar classes = L.Util.splitWords(name);\n\t\t\tfor (var i = 0, len = classes.length; i < len; i++) {\n\t\t\t\tel.classList.add(classes[i]);\n\t\t\t}\n\t\t} else if (!L.DomUtil.hasClass(el, name)) {\n\t\t\tvar className = L.DomUtil.getClass(el);\n\t\t\tL.DomUtil.setClass(el, (className ? className + ' ' : '') + name);\n\t\t}\n\t},\n\n\tremoveClass: function (el, name) {\n\t\tif (el.classList !== undefined) {\n\t\t\tel.classList.remove(name);\n\t\t} else {\n\t\t\tL.DomUtil.setClass(el, L.Util.trim((' ' + L.DomUtil.getClass(el) + ' ').replace(' ' + name + ' ', ' ')));\n\t\t}\n\t},\n\n\tsetClass: function (el, name) {\n\t\tif (el.className.baseVal === undefined) {\n\t\t\tel.className = name;\n\t\t} else {\n\t\t\t// in case of SVG element\n\t\t\tel.className.baseVal = name;\n\t\t}\n\t},\n\n\tgetClass: function (el) {\n\t\treturn el.className.baseVal === undefined ? el.className : el.className.baseVal;\n\t},\n\n\tsetOpacity: function (el, value) {\n\n\t\tif ('opacity' in el.style) {\n\t\t\tel.style.opacity = value;\n\n\t\t} else if ('filter' in el.style) {\n\t\t\tL.DomUtil._setOpacityIE(el, value);\n\t\t}\n\t},\n\n\t_setOpacityIE: function (el, value) {\n\t\tvar filter = false,\n\t\t    filterName = 'DXImageTransform.Microsoft.Alpha';\n\n\t\t// filters collection throws an error if we try to retrieve a filter that doesn't exist\n\t\ttry {\n\t\t\tfilter = el.filters.item(filterName);\n\t\t} catch (e) {\n\t\t\t// don't set opacity to 1 if we haven't already set an opacity,\n\t\t\t// it isn't needed and breaks transparent pngs.\n\t\t\tif (value === 1) { return; }\n\t\t}\n\n\t\tvalue = Math.round(value * 100);\n\n\t\tif (filter) {\n\t\t\tfilter.Enabled = (value !== 100);\n\t\t\tfilter.Opacity = value;\n\t\t} else {\n\t\t\tel.style.filter += ' progid:' + filterName + '(opacity=' + value + ')';\n\t\t}\n\t},\n\n\ttestProp: function (props) {\n\n\t\tvar style = document.documentElement.style;\n\n\t\tfor (var i = 0; i < props.length; i++) {\n\t\t\tif (props[i] in style) {\n\t\t\t\treturn props[i];\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t},\n\n\tsetTransform: function (el, offset, scale) {\n\t\tvar pos = offset || new L.Point(0, 0);\n\n\t\tel.style[L.DomUtil.TRANSFORM] =\n\t\t\t(L.Browser.ie3d ?\n\t\t\t\t'translate(' + pos.x + 'px,' + pos.y + 'px)' :\n\t\t\t\t'translate3d(' + pos.x + 'px,' + pos.y + 'px,0)') +\n\t\t\t(scale ? ' scale(' + scale + ')' : '');\n\t},\n\n\tsetPosition: function (el, point) { // (HTMLElement, Point[, Boolean])\n\n\t\t/*eslint-disable */\n\t\tel._leaflet_pos = point;\n\t\t/*eslint-enable */\n\n\t\tif (L.Browser.any3d) {\n\t\t\tL.DomUtil.setTransform(el, point);\n\t\t} else {\n\t\t\tel.style.left = point.x + 'px';\n\t\t\tel.style.top = point.y + 'px';\n\t\t}\n\t},\n\n\tgetPosition: function (el) {\n\t\t// this method is only used for elements previously positioned using setPosition,\n\t\t// so it's safe to cache the position for performance\n\n\t\treturn el._leaflet_pos;\n\t}\n};\n\n\n(function () {\n\t// prefix style property names\n\n\tL.DomUtil.TRANSFORM = L.DomUtil.testProp(\n\t\t\t['transform', 'WebkitTransform', 'OTransform', 'MozTransform', 'msTransform']);\n\n\n\t// webkitTransition comes first because some browser versions that drop vendor prefix don't do\n\t// the same for the transitionend event, in particular the Android 4.1 stock browser\n\n\tvar transition = L.DomUtil.TRANSITION = L.DomUtil.testProp(\n\t\t\t['webkitTransition', 'transition', 'OTransition', 'MozTransition', 'msTransition']);\n\n\tL.DomUtil.TRANSITION_END =\n\t\t\ttransition === 'webkitTransition' || transition === 'OTransition' ? transition + 'End' : 'transitionend';\n\n\n\tif ('onselectstart' in document) {\n\t\tL.DomUtil.disableTextSelection = function () {\n\t\t\tL.DomEvent.on(window, 'selectstart', L.DomEvent.preventDefault);\n\t\t};\n\t\tL.DomUtil.enableTextSelection = function () {\n\t\t\tL.DomEvent.off(window, 'selectstart', L.DomEvent.preventDefault);\n\t\t};\n\n\t} else {\n\t\tvar userSelectProperty = L.DomUtil.testProp(\n\t\t\t['userSelect', 'WebkitUserSelect', 'OUserSelect', 'MozUserSelect', 'msUserSelect']);\n\n\t\tL.DomUtil.disableTextSelection = function () {\n\t\t\tif (userSelectProperty) {\n\t\t\t\tvar style = document.documentElement.style;\n\t\t\t\tthis._userSelect = style[userSelectProperty];\n\t\t\t\tstyle[userSelectProperty] = 'none';\n\t\t\t}\n\t\t};\n\t\tL.DomUtil.enableTextSelection = function () {\n\t\t\tif (userSelectProperty) {\n\t\t\t\tdocument.documentElement.style[userSelectProperty] = this._userSelect;\n\t\t\t\tdelete this._userSelect;\n\t\t\t}\n\t\t};\n\t}\n\n\tL.DomUtil.disableImageDrag = function () {\n\t\tL.DomEvent.on(window, 'dragstart', L.DomEvent.preventDefault);\n\t};\n\tL.DomUtil.enableImageDrag = function () {\n\t\tL.DomEvent.off(window, 'dragstart', L.DomEvent.preventDefault);\n\t};\n\n\tL.DomUtil.preventOutline = function (element) {\n\t\twhile (element.tabIndex === -1) {\n\t\t\telement = element.parentNode;\n\t\t}\n\t\tif (!element || !element.style) { return; }\n\t\tL.DomUtil.restoreOutline();\n\t\tthis._outlineElement = element;\n\t\tthis._outlineStyle = element.style.outline;\n\t\telement.style.outline = 'none';\n\t\tL.DomEvent.on(window, 'keydown', L.DomUtil.restoreOutline, this);\n\t};\n\tL.DomUtil.restoreOutline = function () {\n\t\tif (!this._outlineElement) { return; }\n\t\tthis._outlineElement.style.outline = this._outlineStyle;\n\t\tdelete this._outlineElement;\n\t\tdelete this._outlineStyle;\n\t\tL.DomEvent.off(window, 'keydown', L.DomUtil.restoreOutline, this);\n\t};\n})();\n\n\n\n/*\n * L.LatLng represents a geographical point with latitude and longitude coordinates.\n */\n\nL.LatLng = function (lat, lng, alt) {\n\tif (isNaN(lat) || isNaN(lng)) {\n\t\tthrow new Error('Invalid LatLng object: (' + lat + ', ' + lng + ')');\n\t}\n\n\tthis.lat = +lat;\n\tthis.lng = +lng;\n\n\tif (alt !== undefined) {\n\t\tthis.alt = +alt;\n\t}\n};\n\nL.LatLng.prototype = {\n\tequals: function (obj, maxMargin) {\n\t\tif (!obj) { return false; }\n\n\t\tobj = L.latLng(obj);\n\n\t\tvar margin = Math.max(\n\t\t        Math.abs(this.lat - obj.lat),\n\t\t        Math.abs(this.lng - obj.lng));\n\n\t\treturn margin <= (maxMargin === undefined ? 1.0E-9 : maxMargin);\n\t},\n\n\ttoString: function (precision) {\n\t\treturn 'LatLng(' +\n\t\t        L.Util.formatNum(this.lat, precision) + ', ' +\n\t\t        L.Util.formatNum(this.lng, precision) + ')';\n\t},\n\n\tdistanceTo: function (other) {\n\t\treturn L.CRS.Earth.distance(this, L.latLng(other));\n\t},\n\n\twrap: function () {\n\t\treturn L.CRS.Earth.wrapLatLng(this);\n\t},\n\n\ttoBounds: function (sizeInMeters) {\n\t\tvar latAccuracy = 180 * sizeInMeters / 40075017,\n\t\t    lngAccuracy = latAccuracy / Math.cos((Math.PI / 180) * this.lat);\n\n\t\treturn L.latLngBounds(\n\t\t        [this.lat - latAccuracy, this.lng - lngAccuracy],\n\t\t        [this.lat + latAccuracy, this.lng + lngAccuracy]);\n\t},\n\n\tclone: function () {\n\t\treturn new L.LatLng(this.lat, this.lng, this.alt);\n\t}\n};\n\n\n// constructs LatLng with different signatures\n// (LatLng) or ([Number, Number]) or (Number, Number) or (Object)\n\nL.latLng = function (a, b, c) {\n\tif (a instanceof L.LatLng) {\n\t\treturn a;\n\t}\n\tif (L.Util.isArray(a) && typeof a[0] !== 'object') {\n\t\tif (a.length === 3) {\n\t\t\treturn new L.LatLng(a[0], a[1], a[2]);\n\t\t}\n\t\tif (a.length === 2) {\n\t\t\treturn new L.LatLng(a[0], a[1]);\n\t\t}\n\t\treturn null;\n\t}\n\tif (a === undefined || a === null) {\n\t\treturn a;\n\t}\n\tif (typeof a === 'object' && 'lat' in a) {\n\t\treturn new L.LatLng(a.lat, 'lng' in a ? a.lng : a.lon, a.alt);\n\t}\n\tif (b === undefined) {\n\t\treturn null;\n\t}\n\treturn new L.LatLng(a, b, c);\n};\n\n\n\n/*\n * L.LatLngBounds represents a rectangular area on the map in geographical coordinates.\n */\n\nL.LatLngBounds = function (southWest, northEast) { // (LatLng, LatLng) or (LatLng[])\n\tif (!southWest) { return; }\n\n\tvar latlngs = northEast ? [southWest, northEast] : southWest;\n\n\tfor (var i = 0, len = latlngs.length; i < len; i++) {\n\t\tthis.extend(latlngs[i]);\n\t}\n};\n\nL.LatLngBounds.prototype = {\n\n\t// extend the bounds to contain the given point or bounds\n\textend: function (obj) { // (LatLng) or (LatLngBounds)\n\t\tvar sw = this._southWest,\n\t\t    ne = this._northEast,\n\t\t    sw2, ne2;\n\n\t\tif (obj instanceof L.LatLng) {\n\t\t\tsw2 = obj;\n\t\t\tne2 = obj;\n\n\t\t} else if (obj instanceof L.LatLngBounds) {\n\t\t\tsw2 = obj._southWest;\n\t\t\tne2 = obj._northEast;\n\n\t\t\tif (!sw2 || !ne2) { return this; }\n\n\t\t} else {\n\t\t\treturn obj ? this.extend(L.latLng(obj) || L.latLngBounds(obj)) : this;\n\t\t}\n\n\t\tif (!sw && !ne) {\n\t\t\tthis._southWest = new L.LatLng(sw2.lat, sw2.lng);\n\t\t\tthis._northEast = new L.LatLng(ne2.lat, ne2.lng);\n\t\t} else {\n\t\t\tsw.lat = Math.min(sw2.lat, sw.lat);\n\t\t\tsw.lng = Math.min(sw2.lng, sw.lng);\n\t\t\tne.lat = Math.max(ne2.lat, ne.lat);\n\t\t\tne.lng = Math.max(ne2.lng, ne.lng);\n\t\t}\n\n\t\treturn this;\n\t},\n\n\t// extend the bounds by a percentage\n\tpad: function (bufferRatio) { // (Number) -> LatLngBounds\n\t\tvar sw = this._southWest,\n\t\t    ne = this._northEast,\n\t\t    heightBuffer = Math.abs(sw.lat - ne.lat) * bufferRatio,\n\t\t    widthBuffer = Math.abs(sw.lng - ne.lng) * bufferRatio;\n\n\t\treturn new L.LatLngBounds(\n\t\t        new L.LatLng(sw.lat - heightBuffer, sw.lng - widthBuffer),\n\t\t        new L.LatLng(ne.lat + heightBuffer, ne.lng + widthBuffer));\n\t},\n\n\tgetCenter: function () { // -> LatLng\n\t\treturn new L.LatLng(\n\t\t        (this._southWest.lat + this._northEast.lat) / 2,\n\t\t        (this._southWest.lng + this._northEast.lng) / 2);\n\t},\n\n\tgetSouthWest: function () {\n\t\treturn this._southWest;\n\t},\n\n\tgetNorthEast: function () {\n\t\treturn this._northEast;\n\t},\n\n\tgetNorthWest: function () {\n\t\treturn new L.LatLng(this.getNorth(), this.getWest());\n\t},\n\n\tgetSouthEast: function () {\n\t\treturn new L.LatLng(this.getSouth(), this.getEast());\n\t},\n\n\tgetWest: function () {\n\t\treturn this._southWest.lng;\n\t},\n\n\tgetSouth: function () {\n\t\treturn this._southWest.lat;\n\t},\n\n\tgetEast: function () {\n\t\treturn this._northEast.lng;\n\t},\n\n\tgetNorth: function () {\n\t\treturn this._northEast.lat;\n\t},\n\n\tcontains: function (obj) { // (LatLngBounds) or (LatLng) -> Boolean\n\t\tif (typeof obj[0] === 'number' || obj instanceof L.LatLng) {\n\t\t\tobj = L.latLng(obj);\n\t\t} else {\n\t\t\tobj = L.latLngBounds(obj);\n\t\t}\n\n\t\tvar sw = this._southWest,\n\t\t    ne = this._northEast,\n\t\t    sw2, ne2;\n\n\t\tif (obj instanceof L.LatLngBounds) {\n\t\t\tsw2 = obj.getSouthWest();\n\t\t\tne2 = obj.getNorthEast();\n\t\t} else {\n\t\t\tsw2 = ne2 = obj;\n\t\t}\n\n\t\treturn (sw2.lat >= sw.lat) && (ne2.lat <= ne.lat) &&\n\t\t       (sw2.lng >= sw.lng) && (ne2.lng <= ne.lng);\n\t},\n\n\tintersects: function (bounds) { // (LatLngBounds) -> Boolean\n\t\tbounds = L.latLngBounds(bounds);\n\n\t\tvar sw = this._southWest,\n\t\t    ne = this._northEast,\n\t\t    sw2 = bounds.getSouthWest(),\n\t\t    ne2 = bounds.getNorthEast(),\n\n\t\t    latIntersects = (ne2.lat >= sw.lat) && (sw2.lat <= ne.lat),\n\t\t    lngIntersects = (ne2.lng >= sw.lng) && (sw2.lng <= ne.lng);\n\n\t\treturn latIntersects && lngIntersects;\n\t},\n\n\toverlaps: function (bounds) { // (LatLngBounds) -> Boolean\n\t\tbounds = L.latLngBounds(bounds);\n\n\t\tvar sw = this._southWest,\n\t\t    ne = this._northEast,\n\t\t    sw2 = bounds.getSouthWest(),\n\t\t    ne2 = bounds.getNorthEast(),\n\n\t\t    latOverlaps = (ne2.lat > sw.lat) && (sw2.lat < ne.lat),\n\t\t    lngOverlaps = (ne2.lng > sw.lng) && (sw2.lng < ne.lng);\n\n\t\treturn latOverlaps && lngOverlaps;\n\t},\n\n\ttoBBoxString: function () {\n\t\treturn [this.getWest(), this.getSouth(), this.getEast(), this.getNorth()].join(',');\n\t},\n\n\tequals: function (bounds) { // (LatLngBounds)\n\t\tif (!bounds) { return false; }\n\n\t\tbounds = L.latLngBounds(bounds);\n\n\t\treturn this._southWest.equals(bounds.getSouthWest()) &&\n\t\t       this._northEast.equals(bounds.getNorthEast());\n\t},\n\n\tisValid: function () {\n\t\treturn !!(this._southWest && this._northEast);\n\t}\n};\n\n// TODO International date line?\n\nL.latLngBounds = function (a, b) { // (LatLngBounds) or (LatLng, LatLng)\n\tif (!a || a instanceof L.LatLngBounds) {\n\t\treturn a;\n\t}\n\treturn new L.LatLngBounds(a, b);\n};\n\n\n\n/*\n * Simple equirectangular (Plate Carree) projection, used by CRS like EPSG:4326 and Simple.\n */\n\nL.Projection = {};\n\nL.Projection.LonLat = {\n\tproject: function (latlng) {\n\t\treturn new L.Point(latlng.lng, latlng.lat);\n\t},\n\n\tunproject: function (point) {\n\t\treturn new L.LatLng(point.y, point.x);\n\t},\n\n\tbounds: L.bounds([-180, -90], [180, 90])\n};\n\n\n\n/*\n * Spherical Mercator is the most popular map projection, used by EPSG:3857 CRS used by default.\n */\n\nL.Projection.SphericalMercator = {\n\n\tR: 6378137,\n\tMAX_LATITUDE: 85.0511287798,\n\n\tproject: function (latlng) {\n\t\tvar d = Math.PI / 180,\n\t\t    max = this.MAX_LATITUDE,\n\t\t    lat = Math.max(Math.min(max, latlng.lat), -max),\n\t\t    sin = Math.sin(lat * d);\n\n\t\treturn new L.Point(\n\t\t\t\tthis.R * latlng.lng * d,\n\t\t\t\tthis.R * Math.log((1 + sin) / (1 - sin)) / 2);\n\t},\n\n\tunproject: function (point) {\n\t\tvar d = 180 / Math.PI;\n\n\t\treturn new L.LatLng(\n\t\t\t(2 * Math.atan(Math.exp(point.y / this.R)) - (Math.PI / 2)) * d,\n\t\t\tpoint.x * d / this.R);\n\t},\n\n\tbounds: (function () {\n\t\tvar d = 6378137 * Math.PI;\n\t\treturn L.bounds([-d, -d], [d, d]);\n\t})()\n};\n\n\n\n/*\n * L.CRS is the base object for all defined CRS (Coordinate Reference Systems) in Leaflet.\n */\n\nL.CRS = {\n\t// converts geo coords to pixel ones\n\tlatLngToPoint: function (latlng, zoom) {\n\t\tvar projectedPoint = this.projection.project(latlng),\n\t\t    scale = this.scale(zoom);\n\n\t\treturn this.transformation._transform(projectedPoint, scale);\n\t},\n\n\t// converts pixel coords to geo coords\n\tpointToLatLng: function (point, zoom) {\n\t\tvar scale = this.scale(zoom),\n\t\t    untransformedPoint = this.transformation.untransform(point, scale);\n\n\t\treturn this.projection.unproject(untransformedPoint);\n\t},\n\n\t// converts geo coords to projection-specific coords (e.g. in meters)\n\tproject: function (latlng) {\n\t\treturn this.projection.project(latlng);\n\t},\n\n\t// converts projected coords to geo coords\n\tunproject: function (point) {\n\t\treturn this.projection.unproject(point);\n\t},\n\n\t// defines how the world scales with zoom\n\tscale: function (zoom) {\n\t\treturn 256 * Math.pow(2, zoom);\n\t},\n\n\tzoom: function (scale) {\n\t\treturn Math.log(scale / 256) / Math.LN2;\n\t},\n\n\t// returns the bounds of the world in projected coords if applicable\n\tgetProjectedBounds: function (zoom) {\n\t\tif (this.infinite) { return null; }\n\n\t\tvar b = this.projection.bounds,\n\t\t    s = this.scale(zoom),\n\t\t    min = this.transformation.transform(b.min, s),\n\t\t    max = this.transformation.transform(b.max, s);\n\n\t\treturn L.bounds(min, max);\n\t},\n\n\t// whether a coordinate axis wraps in a given range (e.g. longitude from -180 to 180); depends on CRS\n\t// wrapLng: [min, max],\n\t// wrapLat: [min, max],\n\n\t// if true, the coordinate space will be unbounded (infinite in all directions)\n\t// infinite: false,\n\n\t// wraps geo coords in certain ranges if applicable\n\twrapLatLng: function (latlng) {\n\t\tvar lng = this.wrapLng ? L.Util.wrapNum(latlng.lng, this.wrapLng, true) : latlng.lng,\n\t\t    lat = this.wrapLat ? L.Util.wrapNum(latlng.lat, this.wrapLat, true) : latlng.lat,\n\t\t    alt = latlng.alt;\n\n\t\treturn L.latLng(lat, lng, alt);\n\t}\n};\n\n\n\n/*\n * A simple CRS that can be used for flat non-Earth maps like panoramas or game maps.\n */\n\nL.CRS.Simple = L.extend({}, L.CRS, {\n\tprojection: L.Projection.LonLat,\n\ttransformation: new L.Transformation(1, 0, -1, 0),\n\n\tscale: function (zoom) {\n\t\treturn Math.pow(2, zoom);\n\t},\n\n\tzoom: function (scale) {\n\t\treturn Math.log(scale) / Math.LN2;\n\t},\n\n\tdistance: function (latlng1, latlng2) {\n\t\tvar dx = latlng2.lng - latlng1.lng,\n\t\t    dy = latlng2.lat - latlng1.lat;\n\n\t\treturn Math.sqrt(dx * dx + dy * dy);\n\t},\n\n\tinfinite: true\n});\n\n\n\n/*\n * L.CRS.Earth is the base class for all CRS representing Earth.\n */\n\nL.CRS.Earth = L.extend({}, L.CRS, {\n\twrapLng: [-180, 180],\n\n\tR: 6378137,\n\n\t// distance between two geographical points using spherical law of cosines approximation\n\tdistance: function (latlng1, latlng2) {\n\t\tvar rad = Math.PI / 180,\n\t\t    lat1 = latlng1.lat * rad,\n\t\t    lat2 = latlng2.lat * rad,\n\t\t    a = Math.sin(lat1) * Math.sin(lat2) +\n\t\t        Math.cos(lat1) * Math.cos(lat2) * Math.cos((latlng2.lng - latlng1.lng) * rad);\n\n\t\treturn this.R * Math.acos(Math.min(a, 1));\n\t}\n});\n\n\n\n/*\n * L.CRS.EPSG3857 (Spherical Mercator) is the most common CRS for web mapping and is used by Leaflet by default.\n */\n\nL.CRS.EPSG3857 = L.extend({}, L.CRS.Earth, {\n\tcode: 'EPSG:3857',\n\tprojection: L.Projection.SphericalMercator,\n\n\ttransformation: (function () {\n\t\tvar scale = 0.5 / (Math.PI * L.Projection.SphericalMercator.R);\n\t\treturn new L.Transformation(scale, 0.5, -scale, 0.5);\n\t}())\n});\n\nL.CRS.EPSG900913 = L.extend({}, L.CRS.EPSG3857, {\n\tcode: 'EPSG:900913'\n});\n\n\n\n/*\n * L.CRS.EPSG4326 is a CRS popular among advanced GIS specialists.\n */\n\nL.CRS.EPSG4326 = L.extend({}, L.CRS.Earth, {\n\tcode: 'EPSG:4326',\n\tprojection: L.Projection.LonLat,\n\ttransformation: new L.Transformation(1 / 180, 1, -1 / 180, 0.5)\n});\n\n\n\n/*\n * L.Map is the central class of the API - it is used to create a map.\n */\n\nL.Map = L.Evented.extend({\n\n\toptions: {\n\t\tcrs: L.CRS.EPSG3857,\n\n\t\t/*\n\t\tcenter: LatLng,\n\t\tzoom: Number,\n\t\tlayers: Array,\n\t\t*/\n\n\t\tfadeAnimation: true,\n\t\ttrackResize: true,\n\t\tmarkerZoomAnimation: true,\n\t\tmaxBoundsViscosity: 0.0,\n\t\ttransform3DLimit: 8388608 // Precision limit of a 32-bit float\n\t},\n\n\tinitialize: function (id, options) { // (HTMLElement or String, Object)\n\t\toptions = L.setOptions(this, options);\n\n\t\tthis._initContainer(id);\n\t\tthis._initLayout();\n\n\t\t// hack for https://github.com/Leaflet/Leaflet/issues/1980\n\t\tthis._onResize = L.bind(this._onResize, this);\n\n\t\tthis._initEvents();\n\n\t\tif (options.maxBounds) {\n\t\t\tthis.setMaxBounds(options.maxBounds);\n\t\t}\n\n\t\tif (options.zoom !== undefined) {\n\t\t\tthis._zoom = this._limitZoom(options.zoom);\n\t\t}\n\n\t\tif (options.center && options.zoom !== undefined) {\n\t\t\tthis.setView(L.latLng(options.center), options.zoom, {reset: true});\n\t\t}\n\n\t\tthis._handlers = [];\n\t\tthis._layers = {};\n\t\tthis._zoomBoundLayers = {};\n\t\tthis._sizeChanged = true;\n\n\t\tthis.callInitHooks();\n\n\t\tthis._addLayers(this.options.layers);\n\t},\n\n\n\t// public methods that modify map state\n\n\t// replaced by animation-powered implementation in Map.PanAnimation.js\n\tsetView: function (center, zoom) {\n\t\tzoom = zoom === undefined ? this.getZoom() : zoom;\n\t\tthis._resetView(L.latLng(center), zoom);\n\t\treturn this;\n\t},\n\n\tsetZoom: function (zoom, options) {\n\t\tif (!this._loaded) {\n\t\t\tthis._zoom = zoom;\n\t\t\treturn this;\n\t\t}\n\t\treturn this.setView(this.getCenter(), zoom, {zoom: options});\n\t},\n\n\tzoomIn: function (delta, options) {\n\t\treturn this.setZoom(this._zoom + (delta || 1), options);\n\t},\n\n\tzoomOut: function (delta, options) {\n\t\treturn this.setZoom(this._zoom - (delta || 1), options);\n\t},\n\n\tsetZoomAround: function (latlng, zoom, options) {\n\t\tvar scale = this.getZoomScale(zoom),\n\t\t    viewHalf = this.getSize().divideBy(2),\n\t\t    containerPoint = latlng instanceof L.Point ? latlng : this.latLngToContainerPoint(latlng),\n\n\t\t    centerOffset = containerPoint.subtract(viewHalf).multiplyBy(1 - 1 / scale),\n\t\t    newCenter = this.containerPointToLatLng(viewHalf.add(centerOffset));\n\n\t\treturn this.setView(newCenter, zoom, {zoom: options});\n\t},\n\n\t_getBoundsCenterZoom: function (bounds, options) {\n\n\t\toptions = options || {};\n\t\tbounds = bounds.getBounds ? bounds.getBounds() : L.latLngBounds(bounds);\n\n\t\tvar paddingTL = L.point(options.paddingTopLeft || options.padding || [0, 0]),\n\t\t    paddingBR = L.point(options.paddingBottomRight || options.padding || [0, 0]),\n\n\t\t    zoom = this.getBoundsZoom(bounds, false, paddingTL.add(paddingBR));\n\n\t\tzoom = options.maxZoom ? Math.min(options.maxZoom, zoom) : zoom;\n\n\t\tvar paddingOffset = paddingBR.subtract(paddingTL).divideBy(2),\n\n\t\t    swPoint = this.project(bounds.getSouthWest(), zoom),\n\t\t    nePoint = this.project(bounds.getNorthEast(), zoom),\n\t\t    center = this.unproject(swPoint.add(nePoint).divideBy(2).add(paddingOffset), zoom);\n\n\t\treturn {\n\t\t\tcenter: center,\n\t\t\tzoom: zoom\n\t\t};\n\t},\n\n\tfitBounds: function (bounds, options) {\n\t\tvar target = this._getBoundsCenterZoom(bounds, options);\n\t\treturn this.setView(target.center, target.zoom, options);\n\t},\n\n\tfitWorld: function (options) {\n\t\treturn this.fitBounds([[-90, -180], [90, 180]], options);\n\t},\n\n\tpanTo: function (center, options) { // (LatLng)\n\t\treturn this.setView(center, this._zoom, {pan: options});\n\t},\n\n\tpanBy: function (offset) { // (Point)\n\t\t// replaced with animated panBy in Map.PanAnimation.js\n\t\tthis.fire('movestart');\n\n\t\tthis._rawPanBy(L.point(offset));\n\n\t\tthis.fire('move');\n\t\treturn this.fire('moveend');\n\t},\n\n\tsetMaxBounds: function (bounds) {\n\t\tbounds = L.latLngBounds(bounds);\n\n\t\tif (!bounds) {\n\t\t\treturn this.off('moveend', this._panInsideMaxBounds);\n\t\t} else if (this.options.maxBounds) {\n\t\t\tthis.off('moveend', this._panInsideMaxBounds);\n\t\t}\n\n\t\tthis.options.maxBounds = bounds;\n\n\t\tif (this._loaded) {\n\t\t\tthis._panInsideMaxBounds();\n\t\t}\n\n\t\treturn this.on('moveend', this._panInsideMaxBounds);\n\t},\n\n\tsetMinZoom: function (zoom) {\n\t\tthis.options.minZoom = zoom;\n\n\t\tif (this._loaded && this.getZoom() < this.options.minZoom) {\n\t\t\treturn this.setZoom(zoom);\n\t\t}\n\n\t\treturn this;\n\t},\n\n\tsetMaxZoom: function (zoom) {\n\t\tthis.options.maxZoom = zoom;\n\n\t\tif (this._loaded && (this.getZoom() > this.options.maxZoom)) {\n\t\t\treturn this.setZoom(zoom);\n\t\t}\n\n\t\treturn this;\n\t},\n\n\tpanInsideBounds: function (bounds, options) {\n\t\tthis._enforcingBounds = true;\n\t\tvar center = this.getCenter(),\n\t\t    newCenter = this._limitCenter(center, this._zoom, L.latLngBounds(bounds));\n\n\t\tif (center.equals(newCenter)) { return this; }\n\n\t\tthis.panTo(newCenter, options);\n\t\tthis._enforcingBounds = false;\n\t\treturn this;\n\t},\n\n\tinvalidateSize: function (options) {\n\t\tif (!this._loaded) { return this; }\n\n\t\toptions = L.extend({\n\t\t\tanimate: false,\n\t\t\tpan: true\n\t\t}, options === true ? {animate: true} : options);\n\n\t\tvar oldSize = this.getSize();\n\t\tthis._sizeChanged = true;\n\t\tthis._lastCenter = null;\n\n\t\tvar newSize = this.getSize(),\n\t\t    oldCenter = oldSize.divideBy(2).round(),\n\t\t    newCenter = newSize.divideBy(2).round(),\n\t\t    offset = oldCenter.subtract(newCenter);\n\n\t\tif (!offset.x && !offset.y) { return this; }\n\n\t\tif (options.animate && options.pan) {\n\t\t\tthis.panBy(offset);\n\n\t\t} else {\n\t\t\tif (options.pan) {\n\t\t\t\tthis._rawPanBy(offset);\n\t\t\t}\n\n\t\t\tthis.fire('move');\n\n\t\t\tif (options.debounceMoveend) {\n\t\t\t\tclearTimeout(this._sizeTimer);\n\t\t\t\tthis._sizeTimer = setTimeout(L.bind(this.fire, this, 'moveend'), 200);\n\t\t\t} else {\n\t\t\t\tthis.fire('moveend');\n\t\t\t}\n\t\t}\n\n\t\treturn this.fire('resize', {\n\t\t\toldSize: oldSize,\n\t\t\tnewSize: newSize\n\t\t});\n\t},\n\n\tstop: function () {\n\t\tL.Util.cancelAnimFrame(this._flyToFrame);\n\t\tif (this._panAnim) {\n\t\t\tthis._panAnim.stop();\n\t\t}\n\t\treturn this;\n\t},\n\n\t// TODO handler.addTo\n\taddHandler: function (name, HandlerClass) {\n\t\tif (!HandlerClass) { return this; }\n\n\t\tvar handler = this[name] = new HandlerClass(this);\n\n\t\tthis._handlers.push(handler);\n\n\t\tif (this.options[name]) {\n\t\t\thandler.enable();\n\t\t}\n\n\t\treturn this;\n\t},\n\n\tremove: function () {\n\n\t\tthis._initEvents(true);\n\n\t\ttry {\n\t\t\t// throws error in IE6-8\n\t\t\tdelete this._container._leaflet;\n\t\t} catch (e) {\n\t\t\tthis._container._leaflet = undefined;\n\t\t}\n\n\t\tL.DomUtil.remove(this._mapPane);\n\n\t\tif (this._clearControlPos) {\n\t\t\tthis._clearControlPos();\n\t\t}\n\n\t\tthis._clearHandlers();\n\n\t\tif (this._loaded) {\n\t\t\tthis.fire('unload');\n\t\t}\n\n\t\tfor (var i in this._layers) {\n\t\t\tthis._layers[i].remove();\n\t\t}\n\n\t\treturn this;\n\t},\n\n\tcreatePane: function (name, container) {\n\t\tvar className = 'leaflet-pane' + (name ? ' leaflet-' + name.replace('Pane', '') + '-pane' : ''),\n\t\t    pane = L.DomUtil.create('div', className, container || this._mapPane);\n\n\t\tif (name) {\n\t\t\tthis._panes[name] = pane;\n\t\t}\n\t\treturn pane;\n\t},\n\n\n\t// public methods for getting map state\n\n\tgetCenter: function () { // (Boolean) -> LatLng\n\t\tthis._checkIfLoaded();\n\n\t\tif (this._lastCenter && !this._moved()) {\n\t\t\treturn this._lastCenter;\n\t\t}\n\t\treturn this.layerPointToLatLng(this._getCenterLayerPoint());\n\t},\n\n\tgetZoom: function () {\n\t\treturn this._zoom;\n\t},\n\n\tgetBounds: function () {\n\t\tvar bounds = this.getPixelBounds(),\n\t\t    sw = this.unproject(bounds.getBottomLeft()),\n\t\t    ne = this.unproject(bounds.getTopRight());\n\n\t\treturn new L.LatLngBounds(sw, ne);\n\t},\n\n\tgetMinZoom: function () {\n\t\treturn this.options.minZoom === undefined ? this._layersMinZoom || 0 : this.options.minZoom;\n\t},\n\n\tgetMaxZoom: function () {\n\t\treturn this.options.maxZoom === undefined ?\n\t\t\t(this._layersMaxZoom === undefined ? Infinity : this._layersMaxZoom) :\n\t\t\tthis.options.maxZoom;\n\t},\n\n\tgetBoundsZoom: function (bounds, inside, padding) { // (LatLngBounds[, Boolean, Point]) -> Number\n\t\tbounds = L.latLngBounds(bounds);\n\n\t\tvar zoom = this.getMinZoom() - (inside ? 1 : 0),\n\t\t    maxZoom = this.getMaxZoom(),\n\t\t    size = this.getSize(),\n\n\t\t    nw = bounds.getNorthWest(),\n\t\t    se = bounds.getSouthEast(),\n\n\t\t    zoomNotFound = true,\n\t\t    boundsSize;\n\n\t\tpadding = L.point(padding || [0, 0]);\n\n\t\tdo {\n\t\t\tzoom++;\n\t\t\tboundsSize = this.project(se, zoom).subtract(this.project(nw, zoom)).add(padding).floor();\n\t\t\tzoomNotFound = !inside ? size.contains(boundsSize) : boundsSize.x < size.x || boundsSize.y < size.y;\n\n\t\t} while (zoomNotFound && zoom <= maxZoom);\n\n\t\tif (zoomNotFound && inside) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn inside ? zoom : zoom - 1;\n\t},\n\n\tgetSize: function () {\n\t\tif (!this._size || this._sizeChanged) {\n\t\t\tthis._size = new L.Point(\n\t\t\t\tthis._container.clientWidth,\n\t\t\t\tthis._container.clientHeight);\n\n\t\t\tthis._sizeChanged = false;\n\t\t}\n\t\treturn this._size.clone();\n\t},\n\n\tgetPixelBounds: function (center, zoom) {\n\t\tvar topLeftPoint = this._getTopLeftPoint(center, zoom);\n\t\treturn new L.Bounds(topLeftPoint, topLeftPoint.add(this.getSize()));\n\t},\n\n\tgetPixelOrigin: function () {\n\t\tthis._checkIfLoaded();\n\t\treturn this._pixelOrigin;\n\t},\n\n\tgetPixelWorldBounds: function (zoom) {\n\t\treturn this.options.crs.getProjectedBounds(zoom === undefined ? this.getZoom() : zoom);\n\t},\n\n\tgetPane: function (pane) {\n\t\treturn typeof pane === 'string' ? this._panes[pane] : pane;\n\t},\n\n\tgetPanes: function () {\n\t\treturn this._panes;\n\t},\n\n\tgetContainer: function () {\n\t\treturn this._container;\n\t},\n\n\n\t// TODO replace with universal implementation after refactoring projections\n\n\tgetZoomScale: function (toZoom, fromZoom) {\n\t\tvar crs = this.options.crs;\n\t\tfromZoom = fromZoom === undefined ? this._zoom : fromZoom;\n\t\treturn crs.scale(toZoom) / crs.scale(fromZoom);\n\t},\n\n\tgetScaleZoom: function (scale, fromZoom) {\n\t\tvar crs = this.options.crs;\n\t\tfromZoom = fromZoom === undefined ? this._zoom : fromZoom;\n\t\treturn crs.zoom(scale * crs.scale(fromZoom));\n\t},\n\n\t// conversion methods\n\n\tproject: function (latlng, zoom) { // (LatLng[, Number]) -> Point\n\t\tzoom = zoom === undefined ? this._zoom : zoom;\n\t\treturn this.options.crs.latLngToPoint(L.latLng(latlng), zoom);\n\t},\n\n\tunproject: function (point, zoom) { // (Point[, Number]) -> LatLng\n\t\tzoom = zoom === undefined ? this._zoom : zoom;\n\t\treturn this.options.crs.pointToLatLng(L.point(point), zoom);\n\t},\n\n\tlayerPointToLatLng: function (point) { // (Point)\n\t\tvar projectedPoint = L.point(point).add(this.getPixelOrigin());\n\t\treturn this.unproject(projectedPoint);\n\t},\n\n\tlatLngToLayerPoint: function (latlng) { // (LatLng)\n\t\tvar projectedPoint = this.project(L.latLng(latlng))._round();\n\t\treturn projectedPoint._subtract(this.getPixelOrigin());\n\t},\n\n\twrapLatLng: function (latlng) {\n\t\treturn this.options.crs.wrapLatLng(L.latLng(latlng));\n\t},\n\n\tdistance: function (latlng1, latlng2) {\n\t\treturn this.options.crs.distance(L.latLng(latlng1), L.latLng(latlng2));\n\t},\n\n\tcontainerPointToLayerPoint: function (point) { // (Point)\n\t\treturn L.point(point).subtract(this._getMapPanePos());\n\t},\n\n\tlayerPointToContainerPoint: function (point) { // (Point)\n\t\treturn L.point(point).add(this._getMapPanePos());\n\t},\n\n\tcontainerPointToLatLng: function (point) {\n\t\tvar layerPoint = this.containerPointToLayerPoint(L.point(point));\n\t\treturn this.layerPointToLatLng(layerPoint);\n\t},\n\n\tlatLngToContainerPoint: function (latlng) {\n\t\treturn this.layerPointToContainerPoint(this.latLngToLayerPoint(L.latLng(latlng)));\n\t},\n\n\tmouseEventToContainerPoint: function (e) { // (MouseEvent)\n\t\treturn L.DomEvent.getMousePosition(e, this._container);\n\t},\n\n\tmouseEventToLayerPoint: function (e) { // (MouseEvent)\n\t\treturn this.containerPointToLayerPoint(this.mouseEventToContainerPoint(e));\n\t},\n\n\tmouseEventToLatLng: function (e) { // (MouseEvent)\n\t\treturn this.layerPointToLatLng(this.mouseEventToLayerPoint(e));\n\t},\n\n\n\t// map initialization methods\n\n\t_initContainer: function (id) {\n\t\tvar container = this._container = L.DomUtil.get(id);\n\n\t\tif (!container) {\n\t\t\tthrow new Error('Map container not found.');\n\t\t} else if (container._leaflet) {\n\t\t\tthrow new Error('Map container is already initialized.');\n\t\t}\n\n\t\tL.DomEvent.addListener(container, 'scroll', this._onScroll, this);\n\t\tcontainer._leaflet = true;\n\t},\n\n\t_initLayout: function () {\n\t\tvar container = this._container;\n\n\t\tthis._fadeAnimated = this.options.fadeAnimation && L.Browser.any3d;\n\n\t\tL.DomUtil.addClass(container, 'leaflet-container' +\n\t\t\t(L.Browser.touch ? ' leaflet-touch' : '') +\n\t\t\t(L.Browser.retina ? ' leaflet-retina' : '') +\n\t\t\t(L.Browser.ielt9 ? ' leaflet-oldie' : '') +\n\t\t\t(L.Browser.safari ? ' leaflet-safari' : '') +\n\t\t\t(this._fadeAnimated ? ' leaflet-fade-anim' : ''));\n\n\t\tvar position = L.DomUtil.getStyle(container, 'position');\n\n\t\tif (position !== 'absolute' && position !== 'relative' && position !== 'fixed') {\n\t\t\tcontainer.style.position = 'relative';\n\t\t}\n\n\t\tthis._initPanes();\n\n\t\tif (this._initControlPos) {\n\t\t\tthis._initControlPos();\n\t\t}\n\t},\n\n\t_initPanes: function () {\n\t\tvar panes = this._panes = {};\n\t\tthis._paneRenderers = {};\n\n\t\tthis._mapPane = this.createPane('mapPane', this._container);\n\t\tL.DomUtil.setPosition(this._mapPane, new L.Point(0, 0));\n\n\t\tthis.createPane('tilePane');\n\t\tthis.createPane('shadowPane');\n\t\tthis.createPane('overlayPane');\n\t\tthis.createPane('markerPane');\n\t\tthis.createPane('popupPane');\n\n\t\tif (!this.options.markerZoomAnimation) {\n\t\t\tL.DomUtil.addClass(panes.markerPane, 'leaflet-zoom-hide');\n\t\t\tL.DomUtil.addClass(panes.shadowPane, 'leaflet-zoom-hide');\n\t\t}\n\t},\n\n\n\t// private methods that modify map state\n\n\t_resetView: function (center, zoom) {\n\t\tL.DomUtil.setPosition(this._mapPane, new L.Point(0, 0));\n\n\t\tvar loading = !this._loaded;\n\t\tthis._loaded = true;\n\t\tzoom = this._limitZoom(zoom);\n\n\t\tvar zoomChanged = this._zoom !== zoom;\n\t\tthis\n\t\t\t._moveStart(zoomChanged)\n\t\t\t._move(center, zoom)\n\t\t\t._moveEnd(zoomChanged);\n\n\t\tthis.fire('viewreset');\n\n\t\tif (loading) {\n\t\t\tthis.fire('load');\n\t\t}\n\t},\n\n\t_moveStart: function (zoomChanged) {\n\t\tif (zoomChanged) {\n\t\t\tthis.fire('zoomstart');\n\t\t}\n\t\treturn this.fire('movestart');\n\t},\n\n\t_move: function (center, zoom, data) {\n\t\tif (zoom === undefined) {\n\t\t\tzoom = this._zoom;\n\t\t}\n\n\t\tvar zoomChanged = this._zoom !== zoom;\n\n\t\tthis._zoom = zoom;\n\t\tthis._lastCenter = center;\n\t\tthis._pixelOrigin = this._getNewPixelOrigin(center);\n\n\t\tif (zoomChanged) {\n\t\t\tthis.fire('zoom', data);\n\t\t}\n\t\treturn this.fire('move', data);\n\t},\n\n\t_moveEnd: function (zoomChanged) {\n\t\tif (zoomChanged) {\n\t\t\tthis.fire('zoomend');\n\t\t}\n\t\treturn this.fire('moveend');\n\t},\n\n\t_rawPanBy: function (offset) {\n\t\tL.DomUtil.setPosition(this._mapPane, this._getMapPanePos().subtract(offset));\n\t},\n\n\t_getZoomSpan: function () {\n\t\treturn this.getMaxZoom() - this.getMinZoom();\n\t},\n\n\t_panInsideMaxBounds: function () {\n\t\tif (!this._enforcingBounds) {\n\t\t\tthis.panInsideBounds(this.options.maxBounds);\n\t\t}\n\t},\n\n\t_checkIfLoaded: function () {\n\t\tif (!this._loaded) {\n\t\t\tthrow new Error('Set map center and zoom first.');\n\t\t}\n\t},\n\n\t// DOM event handling\n\n\t_initEvents: function (remove) {\n\t\tif (!L.DomEvent) { return; }\n\n\t\tthis._targets = {};\n\t\tthis._targets[L.stamp(this._container)] = this;\n\n\t\tvar onOff = remove ? 'off' : 'on';\n\n\t\tL.DomEvent[onOff](this._container, 'click dblclick mousedown mouseup ' +\n\t\t\t'mouseover mouseout mousemove contextmenu keypress', this._handleDOMEvent, this);\n\n\t\tif (this.options.trackResize) {\n\t\t\tL.DomEvent[onOff](window, 'resize', this._onResize, this);\n\t\t}\n\n\t\tif (L.Browser.any3d && this.options.transform3DLimit) {\n\t\t\tthis[onOff]('moveend', this._onMoveEnd);\n\t\t}\n\t},\n\n\t_onResize: function () {\n\t\tL.Util.cancelAnimFrame(this._resizeRequest);\n\t\tthis._resizeRequest = L.Util.requestAnimFrame(\n\t\t        function () { this.invalidateSize({debounceMoveend: true}); }, this);\n\t},\n\n\t_onScroll: function () {\n\t\tthis._container.scrollTop  = 0;\n\t\tthis._container.scrollLeft = 0;\n\t},\n\n\t_onMoveEnd: function () {\n\t\tvar pos = this._getMapPanePos();\n\t\tif (Math.max(Math.abs(pos.x), Math.abs(pos.y)) >= this.options.transform3DLimit) {\n\t\t\t// https://bugzilla.mozilla.org/show_bug.cgi?id=1203873 but Webkit also have\n\t\t\t// a pixel offset on very high values, see: http://jsfiddle.net/dg6r5hhb/\n\t\t\tthis._resetView(this.getCenter(), this.getZoom());\n\t\t}\n\t},\n\n\t_findEventTargets: function (e, type) {\n\t\tvar targets = [],\n\t\t    target,\n\t\t    isHover = type === 'mouseout' || type === 'mouseover',\n\t\t    src = e.target || e.srcElement;\n\n\t\twhile (src) {\n\t\t\ttarget = this._targets[L.stamp(src)];\n\t\t\tif (target && target.listens(type, true)) {\n\t\t\t\tif (isHover && !L.DomEvent._isExternalTarget(src, e)) { break; }\n\t\t\t\ttargets.push(target);\n\t\t\t\tif (isHover) { break; }\n\t\t\t}\n\t\t\tif (src === this._container) { break; }\n\t\t\tsrc = src.parentNode;\n\t\t}\n\t\tif (!targets.length && !isHover && L.DomEvent._isExternalTarget(src, e)) {\n\t\t\ttargets = [this];\n\t\t}\n\t\treturn targets;\n\t},\n\n\t_handleDOMEvent: function (e) {\n\t\tif (!this._loaded || L.DomEvent._skipped(e)) { return; }\n\n\t\t// find the layer the event is propagating from and its parents\n\t\tvar type = e.type === 'keypress' && e.keyCode === 13 ? 'click' : e.type;\n\n\t\tif (e.type === 'click') {\n\t\t\t// Fire a synthetic 'preclick' event which propagates up (mainly for closing popups).\n\t\t\tvar synth = L.Util.extend({}, e);\n\t\t\tsynth.type = 'preclick';\n\t\t\tthis._handleDOMEvent(synth);\n\t\t}\n\n\t\tif (type === 'mousedown') {\n\t\t\t// prevents outline when clicking on keyboard-focusable element\n\t\t\tL.DomUtil.preventOutline(e.target || e.srcElement);\n\t\t}\n\n\t\tthis._fireDOMEvent(e, type);\n\t},\n\n\t_fireDOMEvent: function (e, type, targets) {\n\n\t\tif (e._stopped) { return; }\n\n\t\ttargets = (targets || []).concat(this._findEventTargets(e, type));\n\n\t\tif (!targets.length) { return; }\n\n\t\tvar target = targets[0];\n\t\tif (type === 'contextmenu' && target.listens(type, true)) {\n\t\t\tL.DomEvent.preventDefault(e);\n\t\t}\n\n\t\t// prevents firing click after you just dragged an object\n\t\tif ((e.type === 'click' || e.type === 'preclick') && !e._simulated && this._draggableMoved(target)) { return; }\n\n\t\tvar data = {\n\t\t\toriginalEvent: e\n\t\t};\n\n\t\tif (e.type !== 'keypress') {\n\t\t\tvar isMarker = target instanceof L.Marker;\n\t\t\tdata.containerPoint = isMarker ?\n\t\t\t\t\tthis.latLngToContainerPoint(target.getLatLng()) : this.mouseEventToContainerPoint(e);\n\t\t\tdata.layerPoint = this.containerPointToLayerPoint(data.containerPoint);\n\t\t\tdata.latlng = isMarker ? target.getLatLng() : this.layerPointToLatLng(data.layerPoint);\n\t\t}\n\n\t\tfor (var i = 0; i < targets.length; i++) {\n\t\t\ttargets[i].fire(type, data, true);\n\t\t\tif (data.originalEvent._stopped ||\n\t\t\t\t(targets[i].options.nonBubblingEvents && L.Util.indexOf(targets[i].options.nonBubblingEvents, type) !== -1)) { return; }\n\t\t}\n\t},\n\n\t_draggableMoved: function (obj) {\n\t\tobj = obj.options.draggable ? obj : this;\n\t\treturn (obj.dragging && obj.dragging.moved()) || (this.boxZoom && this.boxZoom.moved());\n\t},\n\n\t_clearHandlers: function () {\n\t\tfor (var i = 0, len = this._handlers.length; i < len; i++) {\n\t\t\tthis._handlers[i].disable();\n\t\t}\n\t},\n\n\twhenReady: function (callback, context) {\n\t\tif (this._loaded) {\n\t\t\tcallback.call(context || this, {target: this});\n\t\t} else {\n\t\t\tthis.on('load', callback, context);\n\t\t}\n\t\treturn this;\n\t},\n\n\n\t// private methods for getting map state\n\n\t_getMapPanePos: function () {\n\t\treturn L.DomUtil.getPosition(this._mapPane) || new L.Point(0, 0);\n\t},\n\n\t_moved: function () {\n\t\tvar pos = this._getMapPanePos();\n\t\treturn pos && !pos.equals([0, 0]);\n\t},\n\n\t_getTopLeftPoint: function (center, zoom) {\n\t\tvar pixelOrigin = center && zoom !== undefined ?\n\t\t\tthis._getNewPixelOrigin(center, zoom) :\n\t\t\tthis.getPixelOrigin();\n\t\treturn pixelOrigin.subtract(this._getMapPanePos());\n\t},\n\n\t_getNewPixelOrigin: function (center, zoom) {\n\t\tvar viewHalf = this.getSize()._divideBy(2);\n\t\treturn this.project(center, zoom)._subtract(viewHalf)._add(this._getMapPanePos())._round();\n\t},\n\n\t_latLngToNewLayerPoint: function (latlng, zoom, center) {\n\t\tvar topLeft = this._getNewPixelOrigin(center, zoom);\n\t\treturn this.project(latlng, zoom)._subtract(topLeft);\n\t},\n\n\t// layer point of the current center\n\t_getCenterLayerPoint: function () {\n\t\treturn this.containerPointToLayerPoint(this.getSize()._divideBy(2));\n\t},\n\n\t// offset of the specified place to the current center in pixels\n\t_getCenterOffset: function (latlng) {\n\t\treturn this.latLngToLayerPoint(latlng).subtract(this._getCenterLayerPoint());\n\t},\n\n\t// adjust center for view to get inside bounds\n\t_limitCenter: function (center, zoom, bounds) {\n\n\t\tif (!bounds) { return center; }\n\n\t\tvar centerPoint = this.project(center, zoom),\n\t\t    viewHalf = this.getSize().divideBy(2),\n\t\t    viewBounds = new L.Bounds(centerPoint.subtract(viewHalf), centerPoint.add(viewHalf)),\n\t\t    offset = this._getBoundsOffset(viewBounds, bounds, zoom);\n\n\t\treturn this.unproject(centerPoint.add(offset), zoom);\n\t},\n\n\t// adjust offset for view to get inside bounds\n\t_limitOffset: function (offset, bounds) {\n\t\tif (!bounds) { return offset; }\n\n\t\tvar viewBounds = this.getPixelBounds(),\n\t\t    newBounds = new L.Bounds(viewBounds.min.add(offset), viewBounds.max.add(offset));\n\n\t\treturn offset.add(this._getBoundsOffset(newBounds, bounds));\n\t},\n\n\t// returns offset needed for pxBounds to get inside maxBounds at a specified zoom\n\t_getBoundsOffset: function (pxBounds, maxBounds, zoom) {\n\t\tvar nwOffset = this.project(maxBounds.getNorthWest(), zoom).subtract(pxBounds.min),\n\t\t    seOffset = this.project(maxBounds.getSouthEast(), zoom).subtract(pxBounds.max),\n\n\t\t    dx = this._rebound(nwOffset.x, -seOffset.x),\n\t\t    dy = this._rebound(nwOffset.y, -seOffset.y);\n\n\t\treturn new L.Point(dx, dy);\n\t},\n\n\t_rebound: function (left, right) {\n\t\treturn left + right > 0 ?\n\t\t\tMath.round(left - right) / 2 :\n\t\t\tMath.max(0, Math.ceil(left)) - Math.max(0, Math.floor(right));\n\t},\n\n\t_limitZoom: function (zoom) {\n\t\tvar min = this.getMinZoom(),\n\t\t    max = this.getMaxZoom();\n\t\tif (!L.Browser.any3d) { zoom = Math.round(zoom); }\n\n\t\treturn Math.max(min, Math.min(max, zoom));\n\t}\n});\n\nL.map = function (id, options) {\n\treturn new L.Map(id, options);\n};\n\n\n\n\nL.Layer = L.Evented.extend({\n\n\toptions: {\n\t\tpane: 'overlayPane',\n\t\tnonBubblingEvents: []  // Array of events that should not be bubbled to DOM parents (like the map)\n\t},\n\n\taddTo: function (map) {\n\t\tmap.addLayer(this);\n\t\treturn this;\n\t},\n\n\tremove: function () {\n\t\treturn this.removeFrom(this._map || this._mapToAdd);\n\t},\n\n\tremoveFrom: function (obj) {\n\t\tif (obj) {\n\t\t\tobj.removeLayer(this);\n\t\t}\n\t\treturn this;\n\t},\n\n\tgetPane: function (name) {\n\t\treturn this._map.getPane(name ? (this.options[name] || name) : this.options.pane);\n\t},\n\n\taddInteractiveTarget: function (targetEl) {\n\t\tthis._map._targets[L.stamp(targetEl)] = this;\n\t\treturn this;\n\t},\n\n\tremoveInteractiveTarget: function (targetEl) {\n\t\tdelete this._map._targets[L.stamp(targetEl)];\n\t\treturn this;\n\t},\n\n\t_layerAdd: function (e) {\n\t\tvar map = e.target;\n\n\t\t// check in case layer gets added and then removed before the map is ready\n\t\tif (!map.hasLayer(this)) { return; }\n\n\t\tthis._map = map;\n\t\tthis._zoomAnimated = map._zoomAnimated;\n\n\t\tif (this.getEvents) {\n\t\t\tmap.on(this.getEvents(), this);\n\t\t}\n\n\t\tthis.onAdd(map);\n\n\t\tif (this.getAttribution && this._map.attributionControl) {\n\t\t\tthis._map.attributionControl.addAttribution(this.getAttribution());\n\t\t}\n\n\t\tthis.fire('add');\n\t\tmap.fire('layeradd', {layer: this});\n\t}\n});\n\n\nL.Map.include({\n\taddLayer: function (layer) {\n\t\tvar id = L.stamp(layer);\n\t\tif (this._layers[id]) { return layer; }\n\t\tthis._layers[id] = layer;\n\n\t\tlayer._mapToAdd = this;\n\n\t\tif (layer.beforeAdd) {\n\t\t\tlayer.beforeAdd(this);\n\t\t}\n\n\t\tthis.whenReady(layer._layerAdd, layer);\n\n\t\treturn this;\n\t},\n\n\tremoveLayer: function (layer) {\n\t\tvar id = L.stamp(layer);\n\n\t\tif (!this._layers[id]) { return this; }\n\n\t\tif (this._loaded) {\n\t\t\tlayer.onRemove(this);\n\t\t}\n\n\t\tif (layer.getAttribution && this.attributionControl) {\n\t\t\tthis.attributionControl.removeAttribution(layer.getAttribution());\n\t\t}\n\n\t\tif (layer.getEvents) {\n\t\t\tthis.off(layer.getEvents(), layer);\n\t\t}\n\n\t\tdelete this._layers[id];\n\n\t\tif (this._loaded) {\n\t\t\tthis.fire('layerremove', {layer: layer});\n\t\t\tlayer.fire('remove');\n\t\t}\n\n\t\tlayer._map = layer._mapToAdd = null;\n\n\t\treturn this;\n\t},\n\n\thasLayer: function (layer) {\n\t\treturn !!layer && (L.stamp(layer) in this._layers);\n\t},\n\n\teachLayer: function (method, context) {\n\t\tfor (var i in this._layers) {\n\t\t\tmethod.call(context, this._layers[i]);\n\t\t}\n\t\treturn this;\n\t},\n\n\t_addLayers: function (layers) {\n\t\tlayers = layers ? (L.Util.isArray(layers) ? layers : [layers]) : [];\n\n\t\tfor (var i = 0, len = layers.length; i < len; i++) {\n\t\t\tthis.addLayer(layers[i]);\n\t\t}\n\t},\n\n\t_addZoomLimit: function (layer) {\n\t\tif (isNaN(layer.options.maxZoom) || !isNaN(layer.options.minZoom)) {\n\t\t\tthis._zoomBoundLayers[L.stamp(layer)] = layer;\n\t\t\tthis._updateZoomLevels();\n\t\t}\n\t},\n\n\t_removeZoomLimit: function (layer) {\n\t\tvar id = L.stamp(layer);\n\n\t\tif (this._zoomBoundLayers[id]) {\n\t\t\tdelete this._zoomBoundLayers[id];\n\t\t\tthis._updateZoomLevels();\n\t\t}\n\t},\n\n\t_updateZoomLevels: function () {\n\t\tvar minZoom = Infinity,\n\t\t    maxZoom = -Infinity,\n\t\t    oldZoomSpan = this._getZoomSpan();\n\n\t\tfor (var i in this._zoomBoundLayers) {\n\t\t\tvar options = this._zoomBoundLayers[i].options;\n\n\t\t\tminZoom = options.minZoom === undefined ? minZoom : Math.min(minZoom, options.minZoom);\n\t\t\tmaxZoom = options.maxZoom === undefined ? maxZoom : Math.max(maxZoom, options.maxZoom);\n\t\t}\n\n\t\tthis._layersMaxZoom = maxZoom === -Infinity ? undefined : maxZoom;\n\t\tthis._layersMinZoom = minZoom === Infinity ? undefined : minZoom;\n\n\t\tif (oldZoomSpan !== this._getZoomSpan()) {\n\t\t\tthis.fire('zoomlevelschange');\n\t\t}\n\t}\n});\n\n\n\n/*\n * Mercator projection that takes into account that the Earth is not a perfect sphere.\n * Less popular than spherical mercator; used by projections like EPSG:3395.\n */\n\nL.Projection.Mercator = {\n\tR: 6378137,\n\tR_MINOR: 6356752.314245179,\n\n\tbounds: L.bounds([-20037508.34279, -15496570.73972], [20037508.34279, 18764656.23138]),\n\n\tproject: function (latlng) {\n\t\tvar d = Math.PI / 180,\n\t\t    r = this.R,\n\t\t    y = latlng.lat * d,\n\t\t    tmp = this.R_MINOR / r,\n\t\t    e = Math.sqrt(1 - tmp * tmp),\n\t\t    con = e * Math.sin(y);\n\n\t\tvar ts = Math.tan(Math.PI / 4 - y / 2) / Math.pow((1 - con) / (1 + con), e / 2);\n\t\ty = -r * Math.log(Math.max(ts, 1E-10));\n\n\t\treturn new L.Point(latlng.lng * d * r, y);\n\t},\n\n\tunproject: function (point) {\n\t\tvar d = 180 / Math.PI,\n\t\t    r = this.R,\n\t\t    tmp = this.R_MINOR / r,\n\t\t    e = Math.sqrt(1 - tmp * tmp),\n\t\t    ts = Math.exp(-point.y / r),\n\t\t    phi = Math.PI / 2 - 2 * Math.atan(ts);\n\n\t\tfor (var i = 0, dphi = 0.1, con; i < 15 && Math.abs(dphi) > 1e-7; i++) {\n\t\t\tcon = e * Math.sin(phi);\n\t\t\tcon = Math.pow((1 - con) / (1 + con), e / 2);\n\t\t\tdphi = Math.PI / 2 - 2 * Math.atan(ts * con) - phi;\n\t\t\tphi += dphi;\n\t\t}\n\n\t\treturn new L.LatLng(phi * d, point.x * d / r);\n\t}\n};\n\n\n\n/*\n * L.CRS.EPSG3857 (World Mercator) CRS implementation.\n */\n\nL.CRS.EPSG3395 = L.extend({}, L.CRS.Earth, {\n\tcode: 'EPSG:3395',\n\tprojection: L.Projection.Mercator,\n\n\ttransformation: (function () {\n\t\tvar scale = 0.5 / (Math.PI * L.Projection.Mercator.R);\n\t\treturn new L.Transformation(scale, 0.5, -scale, 0.5);\n\t}())\n});\n\n\n\n/*\n * L.GridLayer is used as base class for grid-like layers like TileLayer.\n */\n\nL.GridLayer = L.Layer.extend({\n\n\toptions: {\n\t\tpane: 'tilePane',\n\n\t\ttileSize: 256,\n\t\topacity: 1,\n\t\tzIndex: 1,\n\n\t\tupdateWhenIdle: L.Browser.mobile,\n\t\tupdateInterval: 200,\n\n\t\tattribution: null,\n\t\tbounds: null,\n\n\t\tminZoom: 0\n\t\t// maxZoom: <Number>\n\t\t// noWrap: false\n\t},\n\n\tinitialize: function (options) {\n\t\toptions = L.setOptions(this, options);\n\t},\n\n\tonAdd: function () {\n\t\tthis._initContainer();\n\n\t\tthis._levels = {};\n\t\tthis._tiles = {};\n\n\t\tthis._resetView();\n\t\tthis._update();\n\t},\n\n\tbeforeAdd: function (map) {\n\t\tmap._addZoomLimit(this);\n\t},\n\n\tonRemove: function (map) {\n\t\tL.DomUtil.remove(this._container);\n\t\tmap._removeZoomLimit(this);\n\t\tthis._container = null;\n\t\tthis._tileZoom = null;\n\t},\n\n\tbringToFront: function () {\n\t\tif (this._map) {\n\t\t\tL.DomUtil.toFront(this._container);\n\t\t\tthis._setAutoZIndex(Math.max);\n\t\t}\n\t\treturn this;\n\t},\n\n\tbringToBack: function () {\n\t\tif (this._map) {\n\t\t\tL.DomUtil.toBack(this._container);\n\t\t\tthis._setAutoZIndex(Math.min);\n\t\t}\n\t\treturn this;\n\t},\n\n\tgetAttribution: function () {\n\t\treturn this.options.attribution;\n\t},\n\n\tgetContainer: function () {\n\t\treturn this._container;\n\t},\n\n\tsetOpacity: function (opacity) {\n\t\tthis.options.opacity = opacity;\n\t\tthis._updateOpacity();\n\t\treturn this;\n\t},\n\n\tsetZIndex: function (zIndex) {\n\t\tthis.options.zIndex = zIndex;\n\t\tthis._updateZIndex();\n\n\t\treturn this;\n\t},\n\n\tisLoading: function () {\n\t\treturn this._loading;\n\t},\n\n\tredraw: function () {\n\t\tif (this._map) {\n\t\t\tthis._removeAllTiles();\n\t\t\tthis._update();\n\t\t}\n\t\treturn this;\n\t},\n\n\tgetEvents: function () {\n\t\tvar events = {\n\t\t\tviewreset: this._resetAll,\n\t\t\tzoom: this._resetView,\n\t\t\tmoveend: this._onMoveEnd\n\t\t};\n\n\t\tif (!this.options.updateWhenIdle) {\n\t\t\t// update tiles on move, but not more often than once per given interval\n\t\t\tif (!this._onMove) {\n\t\t\t\tthis._onMove = L.Util.throttle(this._onMoveEnd, this.options.updateInterval, this);\n\t\t\t}\n\n\t\t\tevents.move = this._onMove;\n\t\t}\n\n\t\tif (this._zoomAnimated) {\n\t\t\tevents.zoomanim = this._animateZoom;\n\t\t}\n\n\t\treturn events;\n\t},\n\n\tcreateTile: function () {\n\t\treturn document.createElement('div');\n\t},\n\n\tgetTileSize: function () {\n\t\tvar s = this.options.tileSize;\n\t\treturn s instanceof L.Point ? s : new L.Point(s, s);\n\t},\n\n\t_updateZIndex: function () {\n\t\tif (this._container && this.options.zIndex !== undefined && this.options.zIndex !== null) {\n\t\t\tthis._container.style.zIndex = this.options.zIndex;\n\t\t}\n\t},\n\n\t_setAutoZIndex: function (compare) {\n\t\t// go through all other layers of the same pane, set zIndex to max + 1 (front) or min - 1 (back)\n\n\t\tvar layers = this.getPane().children,\n\t\t    edgeZIndex = -compare(-Infinity, Infinity); // -Infinity for max, Infinity for min\n\n\t\tfor (var i = 0, len = layers.length, zIndex; i < len; i++) {\n\n\t\t\tzIndex = layers[i].style.zIndex;\n\n\t\t\tif (layers[i] !== this._container && zIndex) {\n\t\t\t\tedgeZIndex = compare(edgeZIndex, +zIndex);\n\t\t\t}\n\t\t}\n\n\t\tif (isFinite(edgeZIndex)) {\n\t\t\tthis.options.zIndex = edgeZIndex + compare(-1, 1);\n\t\t\tthis._updateZIndex();\n\t\t}\n\t},\n\n\t_updateOpacity: function () {\n\t\tif (!this._map) { return; }\n\n\t\t// IE doesn't inherit filter opacity properly, so we're forced to set it on tiles\n\t\tif (L.Browser.ielt9 || !this._map._fadeAnimated) {\n\t\t\treturn;\n\t\t}\n\n\t\tL.DomUtil.setOpacity(this._container, this.options.opacity);\n\n\t\tvar now = +new Date(),\n\t\t    nextFrame = false,\n\t\t    willPrune = false;\n\n\t\tfor (var key in this._tiles) {\n\t\t\tvar tile = this._tiles[key];\n\t\t\tif (!tile.current || !tile.loaded) { continue; }\n\n\t\t\tvar fade = Math.min(1, (now - tile.loaded) / 200);\n\n\t\t\tL.DomUtil.setOpacity(tile.el, fade);\n\t\t\tif (fade < 1) {\n\t\t\t\tnextFrame = true;\n\t\t\t} else {\n\t\t\t\tif (tile.active) { willPrune = true; }\n\t\t\t\ttile.active = true;\n\t\t\t}\n\t\t}\n\n\t\tif (willPrune && !this._noPrune) { this._pruneTiles(); }\n\n\t\tif (nextFrame) {\n\t\t\tL.Util.cancelAnimFrame(this._fadeFrame);\n\t\t\tthis._fadeFrame = L.Util.requestAnimFrame(this._updateOpacity, this);\n\t\t}\n\t},\n\n\t_initContainer: function () {\n\t\tif (this._container) { return; }\n\n\t\tthis._container = L.DomUtil.create('div', 'leaflet-layer');\n\t\tthis._updateZIndex();\n\n\t\tif (this.options.opacity < 1) {\n\t\t\tthis._updateOpacity();\n\t\t}\n\n\t\tthis.getPane().appendChild(this._container);\n\t},\n\n\t_updateLevels: function () {\n\n\t\tvar zoom = this._tileZoom,\n\t\t    maxZoom = this.options.maxZoom;\n\n\t\tfor (var z in this._levels) {\n\t\t\tif (this._levels[z].el.children.length || z === zoom) {\n\t\t\t\tthis._levels[z].el.style.zIndex = maxZoom - Math.abs(zoom - z);\n\t\t\t} else {\n\t\t\t\tL.DomUtil.remove(this._levels[z].el);\n\t\t\t\tdelete this._levels[z];\n\t\t\t}\n\t\t}\n\n\t\tvar level = this._levels[zoom],\n\t\t    map = this._map;\n\n\t\tif (!level) {\n\t\t\tlevel = this._levels[zoom] = {};\n\n\t\t\tlevel.el = L.DomUtil.create('div', 'leaflet-tile-container leaflet-zoom-animated', this._container);\n\t\t\tlevel.el.style.zIndex = maxZoom;\n\n\t\t\tlevel.origin = map.project(map.unproject(map.getPixelOrigin()), zoom).round();\n\t\t\tlevel.zoom = zoom;\n\n\t\t\tthis._setZoomTransform(level, map.getCenter(), map.getZoom());\n\n\t\t\t// force the browser to consider the newly added element for transition\n\t\t\tL.Util.falseFn(level.el.offsetWidth);\n\t\t}\n\n\t\tthis._level = level;\n\n\t\treturn level;\n\t},\n\n\t_pruneTiles: function () {\n\t\tvar key, tile;\n\n\t\tvar zoom = this._map.getZoom();\n\t\tif (zoom > this.options.maxZoom ||\n\t\t\tzoom < this.options.minZoom) { return this._removeAllTiles(); }\n\n\t\tfor (key in this._tiles) {\n\t\t\ttile = this._tiles[key];\n\t\t\ttile.retain = tile.current;\n\t\t}\n\n\t\tfor (key in this._tiles) {\n\t\t\ttile = this._tiles[key];\n\t\t\tif (tile.current && !tile.active) {\n\t\t\t\tvar coords = tile.coords;\n\t\t\t\tif (!this._retainParent(coords.x, coords.y, coords.z, coords.z - 5)) {\n\t\t\t\t\tthis._retainChildren(coords.x, coords.y, coords.z, coords.z + 2);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor (key in this._tiles) {\n\t\t\tif (!this._tiles[key].retain) {\n\t\t\t\tthis._removeTile(key);\n\t\t\t}\n\t\t}\n\t},\n\n\t_removeAllTiles: function () {\n\t\tfor (var key in this._tiles) {\n\t\t\tthis._removeTile(key);\n\t\t}\n\t},\n\n\t_resetAll: function () {\n\t\tfor (var z in this._levels) {\n\t\t\tL.DomUtil.remove(this._levels[z].el);\n\t\t\tdelete this._levels[z];\n\t\t}\n\t\tthis._removeAllTiles();\n\n\t\tthis._tileZoom = null;\n\t\tthis._resetView();\n\t},\n\n\t_retainParent: function (x, y, z, minZoom) {\n\t\tvar x2 = Math.floor(x / 2),\n\t\t    y2 = Math.floor(y / 2),\n\t\t    z2 = z - 1;\n\n\t\tvar key = x2 + ':' + y2 + ':' + z2,\n\t\t    tile = this._tiles[key];\n\n\t\tif (tile && tile.active) {\n\t\t\ttile.retain = true;\n\t\t\treturn true;\n\n\t\t} else if (tile && tile.loaded) {\n\t\t\ttile.retain = true;\n\t\t}\n\n\t\tif (z2 > minZoom) {\n\t\t\treturn this._retainParent(x2, y2, z2, minZoom);\n\t\t}\n\n\t\treturn false;\n\t},\n\n\t_retainChildren: function (x, y, z, maxZoom) {\n\n\t\tfor (var i = 2 * x; i < 2 * x + 2; i++) {\n\t\t\tfor (var j = 2 * y; j < 2 * y + 2; j++) {\n\n\t\t\t\tvar key = i + ':' + j + ':' + (z + 1),\n\t\t\t\t    tile = this._tiles[key];\n\n\t\t\t\tif (tile && tile.active) {\n\t\t\t\t\ttile.retain = true;\n\t\t\t\t\tcontinue;\n\n\t\t\t\t} else if (tile && tile.loaded) {\n\t\t\t\t\ttile.retain = true;\n\t\t\t\t}\n\n\t\t\t\tif (z + 1 < maxZoom) {\n\t\t\t\t\tthis._retainChildren(i, j, z + 1, maxZoom);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\t_resetView: function (e) {\n\t\tvar animating = e && (e.pinch || e.flyTo);\n\t\tthis._setView(this._map.getCenter(), this._map.getZoom(), animating, animating);\n\t},\n\n\t_animateZoom: function (e) {\n\t\tthis._setView(e.center, e.zoom, true, e.noUpdate);\n\t},\n\n\t_setView: function (center, zoom, noPrune, noUpdate) {\n\t\tvar tileZoom = Math.round(zoom);\n\t\tif ((this.options.maxZoom !== undefined && tileZoom > this.options.maxZoom) ||\n\t\t    (this.options.minZoom !== undefined && tileZoom < this.options.minZoom)) {\n\t\t\ttileZoom = undefined;\n\t\t}\n\n\t\tvar tileZoomChanged = (tileZoom !== this._tileZoom);\n\n\t\tif (!noUpdate || tileZoomChanged) {\n\n\t\t\tthis._tileZoom = tileZoom;\n\n\t\t\tif (this._abortLoading) {\n\t\t\t\tthis._abortLoading();\n\t\t\t}\n\n\t\t\tthis._updateLevels();\n\t\t\tthis._resetGrid();\n\n\t\t\tif (tileZoom !== undefined) {\n\t\t\t\tthis._update(center);\n\t\t\t}\n\n\t\t\tif (!noPrune) {\n\t\t\t\tthis._pruneTiles();\n\t\t\t}\n\n\t\t\t// Flag to prevent _updateOpacity from pruning tiles during\n\t\t\t// a zoom anim or a pinch gesture\n\t\t\tthis._noPrune = !!noPrune;\n\t\t}\n\n\t\tthis._setZoomTransforms(center, zoom);\n\t},\n\n\t_setZoomTransforms: function (center, zoom) {\n\t\tfor (var i in this._levels) {\n\t\t\tthis._setZoomTransform(this._levels[i], center, zoom);\n\t\t}\n\t},\n\n\t_setZoomTransform: function (level, center, zoom) {\n\t\tvar scale = this._map.getZoomScale(zoom, level.zoom),\n\t\t    translate = level.origin.multiplyBy(scale)\n\t\t        .subtract(this._map._getNewPixelOrigin(center, zoom)).round();\n\n\t\tif (L.Browser.any3d) {\n\t\t\tL.DomUtil.setTransform(level.el, translate, scale);\n\t\t} else {\n\t\t\tL.DomUtil.setPosition(level.el, translate);\n\t\t}\n\t},\n\n\t_resetGrid: function () {\n\t\tvar map = this._map,\n\t\t    crs = map.options.crs,\n\t\t    tileSize = this._tileSize = this.getTileSize(),\n\t\t    tileZoom = this._tileZoom;\n\n\t\tvar bounds = this._map.getPixelWorldBounds(this._tileZoom);\n\t\tif (bounds) {\n\t\t\tthis._globalTileRange = this._pxBoundsToTileRange(bounds);\n\t\t}\n\n\t\tthis._wrapX = crs.wrapLng && !this.options.noWrap && [\n\t\t\tMath.floor(map.project([0, crs.wrapLng[0]], tileZoom).x / tileSize.x),\n\t\t\tMath.ceil(map.project([0, crs.wrapLng[1]], tileZoom).x / tileSize.y)\n\t\t];\n\t\tthis._wrapY = crs.wrapLat && !this.options.noWrap && [\n\t\t\tMath.floor(map.project([crs.wrapLat[0], 0], tileZoom).y / tileSize.x),\n\t\t\tMath.ceil(map.project([crs.wrapLat[1], 0], tileZoom).y / tileSize.y)\n\t\t];\n\t},\n\n\t_onMoveEnd: function () {\n\t\tif (!this._map || this._map._animatingZoom) { return; }\n\n\t\tthis._resetView();\n\t},\n\n\t_getTiledPixelBounds: function (center, zoom, tileZoom) {\n\t\tvar map = this._map,\n\t\t    scale = map.getZoomScale(zoom, tileZoom),\n\t\t    pixelCenter = map.project(center, tileZoom).floor(),\n\t\t    halfSize = map.getSize().divideBy(scale * 2);\n\n\t\treturn new L.Bounds(pixelCenter.subtract(halfSize), pixelCenter.add(halfSize));\n\t},\n\n\t// Private method to load tiles in the grid's active zoom level according to map bounds\n\t_update: function (center) {\n\t\tvar map = this._map;\n\t\tif (!map) { return; }\n\t\tvar zoom = map.getZoom();\n\n\t\tif (center === undefined) { center = map.getCenter(); }\n\t\tif (this._tileZoom === undefined) { return; }\t// if out of minzoom/maxzoom\n\n\t\tvar pixelBounds = this._getTiledPixelBounds(center, zoom, this._tileZoom),\n\t\t    tileRange = this._pxBoundsToTileRange(pixelBounds),\n\t\t    tileCenter = tileRange.getCenter(),\n\t\t    queue = [];\n\n\t\tfor (var key in this._tiles) {\n\t\t\tthis._tiles[key].current = false;\n\t\t}\n\n\t\t// _update just loads more tiles. If the tile zoom level differs too much\n\t\t// from the map's, let _setView reset levels and prune old tiles.\n\t\tif (Math.abs(zoom - this._tileZoom) > 1) { this._setView(center, zoom); return; }\n\n\t\t// create a queue of coordinates to load tiles from\n\t\tfor (var j = tileRange.min.y; j <= tileRange.max.y; j++) {\n\t\t\tfor (var i = tileRange.min.x; i <= tileRange.max.x; i++) {\n\t\t\t\tvar coords = new L.Point(i, j);\n\t\t\t\tcoords.z = this._tileZoom;\n\n\t\t\t\tif (!this._isValidTile(coords)) { continue; }\n\n\t\t\t\tvar tile = this._tiles[this._tileCoordsToKey(coords)];\n\t\t\t\tif (tile) {\n\t\t\t\t\ttile.current = true;\n\t\t\t\t} else {\n\t\t\t\t\tqueue.push(coords);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// sort tile queue to load tiles in order of their distance to center\n\t\tqueue.sort(function (a, b) {\n\t\t\treturn a.distanceTo(tileCenter) - b.distanceTo(tileCenter);\n\t\t});\n\n\t\tif (queue.length !== 0) {\n\t\t\t// if its the first batch of tiles to load\n\t\t\tif (!this._loading) {\n\t\t\t\tthis._loading = true;\n\t\t\t\tthis.fire('loading');\n\t\t\t}\n\n\t\t\t// create DOM fragment to append tiles in one batch\n\t\t\tvar fragment = document.createDocumentFragment();\n\n\t\t\tfor (i = 0; i < queue.length; i++) {\n\t\t\t\tthis._addTile(queue[i], fragment);\n\t\t\t}\n\n\t\t\tthis._level.el.appendChild(fragment);\n\t\t}\n\t},\n\n\t_isValidTile: function (coords) {\n\t\tvar crs = this._map.options.crs;\n\n\t\tif (!crs.infinite) {\n\t\t\t// don't load tile if it's out of bounds and not wrapped\n\t\t\tvar bounds = this._globalTileRange;\n\t\t\tif ((!crs.wrapLng && (coords.x < bounds.min.x || coords.x > bounds.max.x)) ||\n\t\t\t    (!crs.wrapLat && (coords.y < bounds.min.y || coords.y > bounds.max.y))) { return false; }\n\t\t}\n\n\t\tif (!this.options.bounds) { return true; }\n\n\t\t// don't load tile if it doesn't intersect the bounds in options\n\t\tvar tileBounds = this._tileCoordsToBounds(coords);\n\t\treturn L.latLngBounds(this.options.bounds).overlaps(tileBounds);\n\t},\n\n\t_keyToBounds: function (key) {\n\t\treturn this._tileCoordsToBounds(this._keyToTileCoords(key));\n\t},\n\n\t// converts tile coordinates to its geographical bounds\n\t_tileCoordsToBounds: function (coords) {\n\n\t\tvar map = this._map,\n\t\t    tileSize = this.getTileSize(),\n\n\t\t    nwPoint = coords.scaleBy(tileSize),\n\t\t    sePoint = nwPoint.add(tileSize),\n\n\t\t    nw = map.wrapLatLng(map.unproject(nwPoint, coords.z)),\n\t\t    se = map.wrapLatLng(map.unproject(sePoint, coords.z));\n\n\t\treturn new L.LatLngBounds(nw, se);\n\t},\n\n\t// converts tile coordinates to key for the tile cache\n\t_tileCoordsToKey: function (coords) {\n\t\treturn coords.x + ':' + coords.y + ':' + coords.z;\n\t},\n\n\t// converts tile cache key to coordinates\n\t_keyToTileCoords: function (key) {\n\t\tvar k = key.split(':'),\n\t\t    coords = new L.Point(+k[0], +k[1]);\n\t\tcoords.z = +k[2];\n\t\treturn coords;\n\t},\n\n\t_removeTile: function (key) {\n\t\tvar tile = this._tiles[key];\n\t\tif (!tile) { return; }\n\n\t\tL.DomUtil.remove(tile.el);\n\n\t\tdelete this._tiles[key];\n\n\t\tthis.fire('tileunload', {\n\t\t\ttile: tile.el,\n\t\t\tcoords: this._keyToTileCoords(key)\n\t\t});\n\t},\n\n\t_initTile: function (tile) {\n\t\tL.DomUtil.addClass(tile, 'leaflet-tile');\n\n\t\tvar tileSize = this.getTileSize();\n\t\ttile.style.width = tileSize.x + 'px';\n\t\ttile.style.height = tileSize.y + 'px';\n\n\t\ttile.onselectstart = L.Util.falseFn;\n\t\ttile.onmousemove = L.Util.falseFn;\n\n\t\t// update opacity on tiles in IE7-8 because of filter inheritance problems\n\t\tif (L.Browser.ielt9 && this.options.opacity < 1) {\n\t\t\tL.DomUtil.setOpacity(tile, this.options.opacity);\n\t\t}\n\n\t\t// without this hack, tiles disappear after zoom on Chrome for Android\n\t\t// https://github.com/Leaflet/Leaflet/issues/2078\n\t\tif (L.Browser.android && !L.Browser.android23) {\n\t\t\ttile.style.WebkitBackfaceVisibility = 'hidden';\n\t\t}\n\t},\n\n\t_addTile: function (coords, container) {\n\t\tvar tilePos = this._getTilePos(coords),\n\t\t    key = this._tileCoordsToKey(coords);\n\n\t\tvar tile = this.createTile(this._wrapCoords(coords), L.bind(this._tileReady, this, coords));\n\n\t\tthis._initTile(tile);\n\n\t\t// if createTile is defined with a second argument (\"done\" callback),\n\t\t// we know that tile is async and will be ready later; otherwise\n\t\tif (this.createTile.length < 2) {\n\t\t\t// mark tile as ready, but delay one frame for opacity animation to happen\n\t\t\tL.Util.requestAnimFrame(L.bind(this._tileReady, this, coords, null, tile));\n\t\t}\n\n\t\tL.DomUtil.setPosition(tile, tilePos);\n\n\t\t// save tile in cache\n\t\tthis._tiles[key] = {\n\t\t\tel: tile,\n\t\t\tcoords: coords,\n\t\t\tcurrent: true\n\t\t};\n\n\t\tcontainer.appendChild(tile);\n\t\tthis.fire('tileloadstart', {\n\t\t\ttile: tile,\n\t\t\tcoords: coords\n\t\t});\n\t},\n\n\t_tileReady: function (coords, err, tile) {\n\t\tif (!this._map) { return; }\n\n\t\tif (err) {\n\t\t\tthis.fire('tileerror', {\n\t\t\t\terror: err,\n\t\t\t\ttile: tile,\n\t\t\t\tcoords: coords\n\t\t\t});\n\t\t}\n\n\t\tvar key = this._tileCoordsToKey(coords);\n\n\t\ttile = this._tiles[key];\n\t\tif (!tile) { return; }\n\n\t\ttile.loaded = +new Date();\n\t\tif (this._map._fadeAnimated) {\n\t\t\tL.DomUtil.setOpacity(tile.el, 0);\n\t\t\tL.Util.cancelAnimFrame(this._fadeFrame);\n\t\t\tthis._fadeFrame = L.Util.requestAnimFrame(this._updateOpacity, this);\n\t\t} else {\n\t\t\ttile.active = true;\n\t\t\tthis._pruneTiles();\n\t\t}\n\n\t\tL.DomUtil.addClass(tile.el, 'leaflet-tile-loaded');\n\n\t\tthis.fire('tileload', {\n\t\t\ttile: tile.el,\n\t\t\tcoords: coords\n\t\t});\n\n\t\tif (this._noTilesToLoad()) {\n\t\t\tthis._loading = false;\n\t\t\tthis.fire('load');\n\t\t}\n\t},\n\n\t_getTilePos: function (coords) {\n\t\treturn coords.scaleBy(this.getTileSize()).subtract(this._level.origin);\n\t},\n\n\t_wrapCoords: function (coords) {\n\t\tvar newCoords = new L.Point(\n\t\t\tthis._wrapX ? L.Util.wrapNum(coords.x, this._wrapX) : coords.x,\n\t\t\tthis._wrapY ? L.Util.wrapNum(coords.y, this._wrapY) : coords.y);\n\t\tnewCoords.z = coords.z;\n\t\treturn newCoords;\n\t},\n\n\t_pxBoundsToTileRange: function (bounds) {\n\t\tvar tileSize = this.getTileSize();\n\t\treturn new L.Bounds(\n\t\t\tbounds.min.unscaleBy(tileSize).floor(),\n\t\t\tbounds.max.unscaleBy(tileSize).ceil().subtract([1, 1]));\n\t},\n\n\t_noTilesToLoad: function () {\n\t\tfor (var key in this._tiles) {\n\t\t\tif (!this._tiles[key].loaded) { return false; }\n\t\t}\n\t\treturn true;\n\t}\n});\n\nL.gridLayer = function (options) {\n\treturn new L.GridLayer(options);\n};\n\n\n\n/*\n * L.TileLayer is used for standard xyz-numbered tile layers.\n */\n\nL.TileLayer = L.GridLayer.extend({\n\n\toptions: {\n\t\tmaxZoom: 18,\n\n\t\tsubdomains: 'abc',\n\t\terrorTileUrl: '',\n\t\tzoomOffset: 0,\n\n\t\tmaxNativeZoom: null, // Number\n\t\ttms: false,\n\t\tzoomReverse: false,\n\t\tdetectRetina: false,\n\t\tcrossOrigin: false\n\t},\n\n\tinitialize: function (url, options) {\n\n\t\tthis._url = url;\n\n\t\toptions = L.setOptions(this, options);\n\n\t\t// detecting retina displays, adjusting tileSize and zoom levels\n\t\tif (options.detectRetina && L.Browser.retina && options.maxZoom > 0) {\n\n\t\t\toptions.tileSize = Math.floor(options.tileSize / 2);\n\t\t\toptions.zoomOffset++;\n\n\t\t\toptions.minZoom = Math.max(0, options.minZoom);\n\t\t\toptions.maxZoom--;\n\t\t}\n\n\t\tif (typeof options.subdomains === 'string') {\n\t\t\toptions.subdomains = options.subdomains.split('');\n\t\t}\n\n\t\t// for https://github.com/Leaflet/Leaflet/issues/137\n\t\tif (!L.Browser.android) {\n\t\t\tthis.on('tileunload', this._onTileRemove);\n\t\t}\n\t},\n\n\tsetUrl: function (url, noRedraw) {\n\t\tthis._url = url;\n\n\t\tif (!noRedraw) {\n\t\t\tthis.redraw();\n\t\t}\n\t\treturn this;\n\t},\n\n\tcreateTile: function (coords, done) {\n\t\tvar tile = document.createElement('img');\n\n\t\tL.DomEvent.on(tile, 'load', L.bind(this._tileOnLoad, this, done, tile));\n\t\tL.DomEvent.on(tile, 'error', L.bind(this._tileOnError, this, done, tile));\n\n\t\tif (this.options.crossOrigin) {\n\t\t\ttile.crossOrigin = '';\n\t\t}\n\n\t\t/*\n\t\t Alt tag is set to empty string to keep screen readers from reading URL and for compliance reasons\n\t\t http://www.w3.org/TR/WCAG20-TECHS/H67\n\t\t*/\n\t\ttile.alt = '';\n\n\t\ttile.src = this.getTileUrl(coords);\n\n\t\treturn tile;\n\t},\n\n\tgetTileUrl: function (coords) {\n\t\treturn L.Util.template(this._url, L.extend({\n\t\t\tr: this.options.detectRetina && L.Browser.retina && this.options.maxZoom > 0 ? '@2x' : '',\n\t\t\ts: this._getSubdomain(coords),\n\t\t\tx: coords.x,\n\t\t\ty: this.options.tms ? this._globalTileRange.max.y - coords.y : coords.y,\n\t\t\tz: this._getZoomForUrl()\n\t\t}, this.options));\n\t},\n\n\t_tileOnLoad: function (done, tile) {\n\t\t// For https://github.com/Leaflet/Leaflet/issues/3332\n\t\tif (L.Browser.ielt9) {\n\t\t\tsetTimeout(L.bind(done, this, null, tile), 0);\n\t\t} else {\n\t\t\tdone(null, tile);\n\t\t}\n\t},\n\n\t_tileOnError: function (done, tile, e) {\n\t\tvar errorUrl = this.options.errorTileUrl;\n\t\tif (errorUrl) {\n\t\t\ttile.src = errorUrl;\n\t\t}\n\t\tdone(e, tile);\n\t},\n\n\tgetTileSize: function () {\n\t\tvar map = this._map,\n\t\t    tileSize = L.GridLayer.prototype.getTileSize.call(this),\n\t\t    zoom = this._tileZoom + this.options.zoomOffset,\n\t\t    zoomN = this.options.maxNativeZoom;\n\n\t\t// increase tile size when overscaling\n\t\treturn zoomN !== null && zoom > zoomN ?\n\t\t\t\ttileSize.divideBy(map.getZoomScale(zoomN, zoom)).round() :\n\t\t\t\ttileSize;\n\t},\n\n\t_onTileRemove: function (e) {\n\t\te.tile.onload = null;\n\t},\n\n\t_getZoomForUrl: function () {\n\n\t\tvar options = this.options,\n\t\t    zoom = this._tileZoom;\n\n\t\tif (options.zoomReverse) {\n\t\t\tzoom = options.maxZoom - zoom;\n\t\t}\n\n\t\tzoom += options.zoomOffset;\n\n\t\treturn options.maxNativeZoom !== null ? Math.min(zoom, options.maxNativeZoom) : zoom;\n\t},\n\n\t_getSubdomain: function (tilePoint) {\n\t\tvar index = Math.abs(tilePoint.x + tilePoint.y) % this.options.subdomains.length;\n\t\treturn this.options.subdomains[index];\n\t},\n\n\t// stops loading all tiles in the background layer\n\t_abortLoading: function () {\n\t\tvar i, tile;\n\t\tfor (i in this._tiles) {\n\t\t\tif (this._tiles[i].coords.z !== this._tileZoom) {\n\t\t\t\ttile = this._tiles[i].el;\n\n\t\t\t\ttile.onload = L.Util.falseFn;\n\t\t\t\ttile.onerror = L.Util.falseFn;\n\n\t\t\t\tif (!tile.complete) {\n\t\t\t\t\ttile.src = L.Util.emptyImageUrl;\n\t\t\t\t\tL.DomUtil.remove(tile);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n});\n\nL.tileLayer = function (url, options) {\n\treturn new L.TileLayer(url, options);\n};\n\n\n\n/*\n * L.TileLayer.WMS is used for WMS tile layers.\n */\n\nL.TileLayer.WMS = L.TileLayer.extend({\n\n\tdefaultWmsParams: {\n\t\tservice: 'WMS',\n\t\trequest: 'GetMap',\n\t\tversion: '1.1.1',\n\t\tlayers: '',\n\t\tstyles: '',\n\t\tformat: 'image/jpeg',\n\t\ttransparent: false\n\t},\n\n\toptions: {\n\t\tcrs: null,\n\t\tuppercase: false\n\t},\n\n\tinitialize: function (url, options) {\n\n\t\tthis._url = url;\n\n\t\tvar wmsParams = L.extend({}, this.defaultWmsParams);\n\n\t\t// all keys that are not TileLayer options go to WMS params\n\t\tfor (var i in options) {\n\t\t\tif (!(i in this.options)) {\n\t\t\t\twmsParams[i] = options[i];\n\t\t\t}\n\t\t}\n\n\t\toptions = L.setOptions(this, options);\n\n\t\twmsParams.width = wmsParams.height = options.tileSize * (options.detectRetina && L.Browser.retina ? 2 : 1);\n\n\t\tthis.wmsParams = wmsParams;\n\t},\n\n\tonAdd: function (map) {\n\n\t\tthis._crs = this.options.crs || map.options.crs;\n\t\tthis._wmsVersion = parseFloat(this.wmsParams.version);\n\n\t\tvar projectionKey = this._wmsVersion >= 1.3 ? 'crs' : 'srs';\n\t\tthis.wmsParams[projectionKey] = this._crs.code;\n\n\t\tL.TileLayer.prototype.onAdd.call(this, map);\n\t},\n\n\tgetTileUrl: function (coords) {\n\n\t\tvar tileBounds = this._tileCoordsToBounds(coords),\n\t\t    nw = this._crs.project(tileBounds.getNorthWest()),\n\t\t    se = this._crs.project(tileBounds.getSouthEast()),\n\n\t\t    bbox = (this._wmsVersion >= 1.3 && this._crs === L.CRS.EPSG4326 ?\n\t\t\t    [se.y, nw.x, nw.y, se.x] :\n\t\t\t    [nw.x, se.y, se.x, nw.y]).join(','),\n\n\t\t    url = L.TileLayer.prototype.getTileUrl.call(this, coords);\n\n\t\treturn url +\n\t\t\tL.Util.getParamString(this.wmsParams, url, this.options.uppercase) +\n\t\t\t(this.options.uppercase ? '&BBOX=' : '&bbox=') + bbox;\n\t},\n\n\tsetParams: function (params, noRedraw) {\n\n\t\tL.extend(this.wmsParams, params);\n\n\t\tif (!noRedraw) {\n\t\t\tthis.redraw();\n\t\t}\n\n\t\treturn this;\n\t}\n});\n\nL.tileLayer.wms = function (url, options) {\n\treturn new L.TileLayer.WMS(url, options);\n};\n\n\n\n/*\n * L.ImageOverlay is used to overlay images over the map (to specific geographical bounds).\n */\n\nL.ImageOverlay = L.Layer.extend({\n\n\toptions: {\n\t\topacity: 1,\n\t\talt: '',\n\t\tinteractive: false\n\n\t\t/*\n\t\tcrossOrigin: <Boolean>,\n\t\t*/\n\t},\n\n\tinitialize: function (url, bounds, options) { // (String, LatLngBounds, Object)\n\t\tthis._url = url;\n\t\tthis._bounds = L.latLngBounds(bounds);\n\n\t\tL.setOptions(this, options);\n\t},\n\n\tonAdd: function () {\n\t\tif (!this._image) {\n\t\t\tthis._initImage();\n\n\t\t\tif (this.options.opacity < 1) {\n\t\t\t\tthis._updateOpacity();\n\t\t\t}\n\t\t}\n\n\t\tif (this.options.interactive) {\n\t\t\tL.DomUtil.addClass(this._image, 'leaflet-interactive');\n\t\t\tthis.addInteractiveTarget(this._image);\n\t\t}\n\n\t\tthis.getPane().appendChild(this._image);\n\t\tthis._reset();\n\t},\n\n\tonRemove: function () {\n\t\tL.DomUtil.remove(this._image);\n\t\tif (this.options.interactive) {\n\t\t\tthis.removeInteractiveTarget(this._image);\n\t\t}\n\t},\n\n\tsetOpacity: function (opacity) {\n\t\tthis.options.opacity = opacity;\n\n\t\tif (this._image) {\n\t\t\tthis._updateOpacity();\n\t\t}\n\t\treturn this;\n\t},\n\n\tsetStyle: function (styleOpts) {\n\t\tif (styleOpts.opacity) {\n\t\t\tthis.setOpacity(styleOpts.opacity);\n\t\t}\n\t\treturn this;\n\t},\n\n\tbringToFront: function () {\n\t\tif (this._map) {\n\t\t\tL.DomUtil.toFront(this._image);\n\t\t}\n\t\treturn this;\n\t},\n\n\tbringToBack: function () {\n\t\tif (this._map) {\n\t\t\tL.DomUtil.toBack(this._image);\n\t\t}\n\t\treturn this;\n\t},\n\n\tsetUrl: function (url) {\n\t\tthis._url = url;\n\n\t\tif (this._image) {\n\t\t\tthis._image.src = url;\n\t\t}\n\t\treturn this;\n\t},\n\n\tsetBounds: function (bounds) {\n\t\tthis._bounds = bounds;\n\n\t\tif (this._map) {\n\t\t\tthis._reset();\n\t\t}\n\t\treturn this;\n\t},\n\n\tgetAttribution: function () {\n\t\treturn this.options.attribution;\n\t},\n\n\tgetEvents: function () {\n\t\tvar events = {\n\t\t\tzoom: this._reset,\n\t\t\tviewreset: this._reset\n\t\t};\n\n\t\tif (this._zoomAnimated) {\n\t\t\tevents.zoomanim = this._animateZoom;\n\t\t}\n\n\t\treturn events;\n\t},\n\n\tgetBounds: function () {\n\t\treturn this._bounds;\n\t},\n\n\tgetElement: function () {\n\t\treturn this._image;\n\t},\n\n\t_initImage: function () {\n\t\tvar img = this._image = L.DomUtil.create('img',\n\t\t\t\t'leaflet-image-layer ' + (this._zoomAnimated ? 'leaflet-zoom-animated' : ''));\n\n\t\timg.onselectstart = L.Util.falseFn;\n\t\timg.onmousemove = L.Util.falseFn;\n\n\t\timg.onload = L.bind(this.fire, this, 'load');\n\n\t\tif (this.options.crossOrigin) {\n\t\t\timg.crossOrigin = '';\n\t\t}\n\n\t\timg.src = this._url;\n\t\timg.alt = this.options.alt;\n\t},\n\n\t_animateZoom: function (e) {\n\t\tvar scale = this._map.getZoomScale(e.zoom),\n\t\t    offset = this._map._latLngToNewLayerPoint(this._bounds.getNorthWest(), e.zoom, e.center);\n\n\t\tL.DomUtil.setTransform(this._image, offset, scale);\n\t},\n\n\t_reset: function () {\n\t\tvar image = this._image,\n\t\t    bounds = new L.Bounds(\n\t\t        this._map.latLngToLayerPoint(this._bounds.getNorthWest()),\n\t\t        this._map.latLngToLayerPoint(this._bounds.getSouthEast())),\n\t\t    size = bounds.getSize();\n\n\t\tL.DomUtil.setPosition(image, bounds.min);\n\n\t\timage.style.width  = size.x + 'px';\n\t\timage.style.height = size.y + 'px';\n\t},\n\n\t_updateOpacity: function () {\n\t\tL.DomUtil.setOpacity(this._image, this.options.opacity);\n\t}\n});\n\nL.imageOverlay = function (url, bounds, options) {\n\treturn new L.ImageOverlay(url, bounds, options);\n};\n\n\n\n/*\n * L.Icon is an image-based icon class that you can use with L.Marker for custom markers.\n */\n\nL.Icon = L.Class.extend({\n\t/*\n\toptions: {\n\t\ticonUrl: (String) (required)\n\t\ticonRetinaUrl: (String) (optional, used for retina devices if detected)\n\t\ticonSize: (Point) (can be set through CSS)\n\t\ticonAnchor: (Point) (centered by default, can be set in CSS with negative margins)\n\t\tpopupAnchor: (Point) (if not specified, popup opens in the anchor point)\n\t\tshadowUrl: (String) (no shadow by default)\n\t\tshadowRetinaUrl: (String) (optional, used for retina devices if detected)\n\t\tshadowSize: (Point)\n\t\tshadowAnchor: (Point)\n\t\tclassName: (String)\n\t},\n\t*/\n\n\tinitialize: function (options) {\n\t\tL.setOptions(this, options);\n\t},\n\n\tcreateIcon: function (oldIcon) {\n\t\treturn this._createIcon('icon', oldIcon);\n\t},\n\n\tcreateShadow: function (oldIcon) {\n\t\treturn this._createIcon('shadow', oldIcon);\n\t},\n\n\t_createIcon: function (name, oldIcon) {\n\t\tvar src = this._getIconUrl(name);\n\n\t\tif (!src) {\n\t\t\tif (name === 'icon') {\n\t\t\t\tthrow new Error('iconUrl not set in Icon options (see the docs).');\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\n\t\tvar img = this._createImg(src, oldIcon && oldIcon.tagName === 'IMG' ? oldIcon : null);\n\t\tthis._setIconStyles(img, name);\n\n\t\treturn img;\n\t},\n\n\t_setIconStyles: function (img, name) {\n\t\tvar options = this.options,\n\t\t    size = L.point(options[name + 'Size']),\n\t\t    anchor = L.point(name === 'shadow' && options.shadowAnchor || options.iconAnchor ||\n\t\t            size && size.divideBy(2, true));\n\n\t\timg.className = 'leaflet-marker-' + name + ' ' + (options.className || '');\n\n\t\tif (anchor) {\n\t\t\timg.style.marginLeft = (-anchor.x) + 'px';\n\t\t\timg.style.marginTop  = (-anchor.y) + 'px';\n\t\t}\n\n\t\tif (size) {\n\t\t\timg.style.width  = size.x + 'px';\n\t\t\timg.style.height = size.y + 'px';\n\t\t}\n\t},\n\n\t_createImg: function (src, el) {\n\t\tel = el || document.createElement('img');\n\t\tel.src = src;\n\t\treturn el;\n\t},\n\n\t_getIconUrl: function (name) {\n\t\treturn L.Browser.retina && this.options[name + 'RetinaUrl'] || this.options[name + 'Url'];\n\t}\n});\n\nL.icon = function (options) {\n\treturn new L.Icon(options);\n};\n\n\n\n/*\n * L.Icon.Default is the blue marker icon used by default in Leaflet.\n */\n\nL.Icon.Default = L.Icon.extend({\n\n\toptions: {\n\t\ticonSize:    [25, 41],\n\t\ticonAnchor:  [12, 41],\n\t\tpopupAnchor: [1, -34],\n\t\tshadowSize:  [41, 41]\n\t},\n\n\t_getIconUrl: function (name) {\n\t\tvar key = name + 'Url';\n\n\t\tif (this.options[key]) {\n\t\t\treturn this.options[key];\n\t\t}\n\n\t\tvar path = L.Icon.Default.imagePath;\n\n\t\tif (!path) {\n\t\t\tthrow new Error('Couldn\\'t autodetect L.Icon.Default.imagePath, set it manually.');\n\t\t}\n\n\t\treturn path + '/marker-' + name + (L.Browser.retina && name === 'icon' ? '-2x' : '') + '.png';\n\t}\n});\n\nL.Icon.Default.imagePath = (function () {\n\tvar scripts = document.getElementsByTagName('script'),\n\t    leafletRe = /[\\/^]leaflet[\\-\\._]?([\\w\\-\\._]*)\\.js\\??/;\n\n\tvar i, len, src, path;\n\n\tfor (i = 0, len = scripts.length; i < len; i++) {\n\t\tsrc = scripts[i].src || '';\n\n\t\tif (src.match(leafletRe)) {\n\t\t\tpath = src.split(leafletRe)[0];\n\t\t\treturn (path ? path + '/' : '') + 'images';\n\t\t}\n\t}\n}());\n\n\n\n/*\n * L.Marker is used to display clickable/draggable icons on the map.\n */\n\nL.Marker = L.Layer.extend({\n\n\toptions: {\n\t\tpane: 'markerPane',\n\t\tnonBubblingEvents: ['click', 'dblclick', 'mouseover', 'mouseout', 'contextmenu'],\n\n\t\ticon: new L.Icon.Default(),\n\t\t// title: '',\n\t\t// alt: '',\n\t\tinteractive: true,\n\t\t// draggable: false,\n\t\tkeyboard: true,\n\t\tzIndexOffset: 0,\n\t\topacity: 1,\n\t\t// riseOnHover: false,\n\t\triseOffset: 250\n\t},\n\n\tinitialize: function (latlng, options) {\n\t\tL.setOptions(this, options);\n\t\tthis._latlng = L.latLng(latlng);\n\t},\n\n\tonAdd: function (map) {\n\t\tthis._zoomAnimated = this._zoomAnimated && map.options.markerZoomAnimation;\n\n\t\tthis._initIcon();\n\t\tthis.update();\n\t},\n\n\tonRemove: function () {\n\t\tif (this.dragging && this.dragging.enabled()) {\n\t\t\tthis.options.draggable = true;\n\t\t\tthis.dragging.removeHooks();\n\t\t}\n\n\t\tthis._removeIcon();\n\t\tthis._removeShadow();\n\t},\n\n\tgetEvents: function () {\n\t\tvar events = {\n\t\t\tzoom: this.update,\n\t\t\tviewreset: this.update\n\t\t};\n\n\t\tif (this._zoomAnimated) {\n\t\t\tevents.zoomanim = this._animateZoom;\n\t\t}\n\n\t\treturn events;\n\t},\n\n\tgetLatLng: function () {\n\t\treturn this._latlng;\n\t},\n\n\tsetLatLng: function (latlng) {\n\t\tvar oldLatLng = this._latlng;\n\t\tthis._latlng = L.latLng(latlng);\n\t\tthis.update();\n\t\treturn this.fire('move', {oldLatLng: oldLatLng, latlng: this._latlng});\n\t},\n\n\tsetZIndexOffset: function (offset) {\n\t\tthis.options.zIndexOffset = offset;\n\t\treturn this.update();\n\t},\n\n\tsetIcon: function (icon) {\n\n\t\tthis.options.icon = icon;\n\n\t\tif (this._map) {\n\t\t\tthis._initIcon();\n\t\t\tthis.update();\n\t\t}\n\n\t\tif (this._popup) {\n\t\t\tthis.bindPopup(this._popup, this._popup.options);\n\t\t}\n\n\t\treturn this;\n\t},\n\n\tgetElement: function () {\n\t\treturn this._icon;\n\t},\n\n\tupdate: function () {\n\n\t\tif (this._icon) {\n\t\t\tvar pos = this._map.latLngToLayerPoint(this._latlng).round();\n\t\t\tthis._setPos(pos);\n\t\t}\n\n\t\treturn this;\n\t},\n\n\t_initIcon: function () {\n\t\tvar options = this.options,\n\t\t    classToAdd = 'leaflet-zoom-' + (this._zoomAnimated ? 'animated' : 'hide');\n\n\t\tvar icon = options.icon.createIcon(this._icon),\n\t\t    addIcon = false;\n\n\t\t// if we're not reusing the icon, remove the old one and init new one\n\t\tif (icon !== this._icon) {\n\t\t\tif (this._icon) {\n\t\t\t\tthis._removeIcon();\n\t\t\t}\n\t\t\taddIcon = true;\n\n\t\t\tif (options.title) {\n\t\t\t\ticon.title = options.title;\n\t\t\t}\n\t\t\tif (options.alt) {\n\t\t\t\ticon.alt = options.alt;\n\t\t\t}\n\t\t}\n\n\t\tL.DomUtil.addClass(icon, classToAdd);\n\n\t\tif (options.keyboard) {\n\t\t\ticon.tabIndex = '0';\n\t\t}\n\n\t\tthis._icon = icon;\n\n\t\tif (options.riseOnHover) {\n\t\t\tthis.on({\n\t\t\t\tmouseover: this._bringToFront,\n\t\t\t\tmouseout: this._resetZIndex\n\t\t\t});\n\t\t}\n\n\t\tvar newShadow = options.icon.createShadow(this._shadow),\n\t\t    addShadow = false;\n\n\t\tif (newShadow !== this._shadow) {\n\t\t\tthis._removeShadow();\n\t\t\taddShadow = true;\n\t\t}\n\n\t\tif (newShadow) {\n\t\t\tL.DomUtil.addClass(newShadow, classToAdd);\n\t\t}\n\t\tthis._shadow = newShadow;\n\n\n\t\tif (options.opacity < 1) {\n\t\t\tthis._updateOpacity();\n\t\t}\n\n\n\t\tif (addIcon) {\n\t\t\tthis.getPane().appendChild(this._icon);\n\t\t\tthis._initInteraction();\n\t\t}\n\t\tif (newShadow && addShadow) {\n\t\t\tthis.getPane('shadowPane').appendChild(this._shadow);\n\t\t}\n\t},\n\n\t_removeIcon: function () {\n\t\tif (this.options.riseOnHover) {\n\t\t\tthis.off({\n\t\t\t\tmouseover: this._bringToFront,\n\t\t\t\tmouseout: this._resetZIndex\n\t\t\t});\n\t\t}\n\n\t\tL.DomUtil.remove(this._icon);\n\t\tthis.removeInteractiveTarget(this._icon);\n\n\t\tthis._icon = null;\n\t},\n\n\t_removeShadow: function () {\n\t\tif (this._shadow) {\n\t\t\tL.DomUtil.remove(this._shadow);\n\t\t}\n\t\tthis._shadow = null;\n\t},\n\n\t_setPos: function (pos) {\n\t\tL.DomUtil.setPosition(this._icon, pos);\n\n\t\tif (this._shadow) {\n\t\t\tL.DomUtil.setPosition(this._shadow, pos);\n\t\t}\n\n\t\tthis._zIndex = pos.y + this.options.zIndexOffset;\n\n\t\tthis._resetZIndex();\n\t},\n\n\t_updateZIndex: function (offset) {\n\t\tthis._icon.style.zIndex = this._zIndex + offset;\n\t},\n\n\t_animateZoom: function (opt) {\n\t\tvar pos = this._map._latLngToNewLayerPoint(this._latlng, opt.zoom, opt.center).round();\n\n\t\tthis._setPos(pos);\n\t},\n\n\t_initInteraction: function () {\n\n\t\tif (!this.options.interactive) { return; }\n\n\t\tL.DomUtil.addClass(this._icon, 'leaflet-interactive');\n\n\t\tthis.addInteractiveTarget(this._icon);\n\n\t\tif (L.Handler.MarkerDrag) {\n\t\t\tvar draggable = this.options.draggable;\n\t\t\tif (this.dragging) {\n\t\t\t\tdraggable = this.dragging.enabled();\n\t\t\t\tthis.dragging.disable();\n\t\t\t}\n\n\t\t\tthis.dragging = new L.Handler.MarkerDrag(this);\n\n\t\t\tif (draggable) {\n\t\t\t\tthis.dragging.enable();\n\t\t\t}\n\t\t}\n\t},\n\n\tsetOpacity: function (opacity) {\n\t\tthis.options.opacity = opacity;\n\t\tif (this._map) {\n\t\t\tthis._updateOpacity();\n\t\t}\n\n\t\treturn this;\n\t},\n\n\t_updateOpacity: function () {\n\t\tvar opacity = this.options.opacity;\n\n\t\tL.DomUtil.setOpacity(this._icon, opacity);\n\n\t\tif (this._shadow) {\n\t\t\tL.DomUtil.setOpacity(this._shadow, opacity);\n\t\t}\n\t},\n\n\t_bringToFront: function () {\n\t\tthis._updateZIndex(this.options.riseOffset);\n\t},\n\n\t_resetZIndex: function () {\n\t\tthis._updateZIndex(0);\n\t}\n});\n\nL.marker = function (latlng, options) {\n\treturn new L.Marker(latlng, options);\n};\n\n\n\n/*\n * L.DivIcon is a lightweight HTML-based icon class (as opposed to the image-based L.Icon)\n * to use with L.Marker.\n */\n\nL.DivIcon = L.Icon.extend({\n\toptions: {\n\t\ticonSize: [12, 12], // also can be set through CSS\n\t\t/*\n\t\ticonAnchor: (Point)\n\t\tpopupAnchor: (Point)\n\t\thtml: (String)\n\t\tbgPos: (Point)\n\t\t*/\n\t\tclassName: 'leaflet-div-icon',\n\t\thtml: false\n\t},\n\n\tcreateIcon: function (oldIcon) {\n\t\tvar div = (oldIcon && oldIcon.tagName === 'DIV') ? oldIcon : document.createElement('div'),\n\t\t    options = this.options;\n\n\t\tdiv.innerHTML = options.html !== false ? options.html : '';\n\n\t\tif (options.bgPos) {\n\t\t\tdiv.style.backgroundPosition = (-options.bgPos.x) + 'px ' + (-options.bgPos.y) + 'px';\n\t\t}\n\t\tthis._setIconStyles(div, 'icon');\n\n\t\treturn div;\n\t},\n\n\tcreateShadow: function () {\n\t\treturn null;\n\t}\n});\n\nL.divIcon = function (options) {\n\treturn new L.DivIcon(options);\n};\n\n\n\n/*\n * L.Popup is used for displaying popups on the map.\n */\n\nL.Map.mergeOptions({\n\tclosePopupOnClick: true\n});\n\nL.Popup = L.Layer.extend({\n\n\toptions: {\n\t\tpane: 'popupPane',\n\n\t\tminWidth: 50,\n\t\tmaxWidth: 300,\n\t\t// maxHeight: <Number>,\n\t\toffset: [0, 7],\n\n\t\tautoPan: true,\n\t\tautoPanPadding: [5, 5],\n\t\t// autoPanPaddingTopLeft: <Point>,\n\t\t// autoPanPaddingBottomRight: <Point>,\n\n\t\tcloseButton: true,\n\t\tautoClose: true,\n\t\t// keepInView: false,\n\t\t// className: '',\n\t\tzoomAnimation: true\n\t},\n\n\tinitialize: function (options, source) {\n\t\tL.setOptions(this, options);\n\n\t\tthis._source = source;\n\t},\n\n\tonAdd: function (map) {\n\t\tthis._zoomAnimated = this._zoomAnimated && this.options.zoomAnimation;\n\n\t\tif (!this._container) {\n\t\t\tthis._initLayout();\n\t\t}\n\n\t\tif (map._fadeAnimated) {\n\t\t\tL.DomUtil.setOpacity(this._container, 0);\n\t\t}\n\n\t\tclearTimeout(this._removeTimeout);\n\t\tthis.getPane().appendChild(this._container);\n\t\tthis.update();\n\n\t\tif (map._fadeAnimated) {\n\t\t\tL.DomUtil.setOpacity(this._container, 1);\n\t\t}\n\n\t\tmap.fire('popupopen', {popup: this});\n\n\t\tif (this._source) {\n\t\t\tthis._source.fire('popupopen', {popup: this}, true);\n\t\t}\n\t},\n\n\topenOn: function (map) {\n\t\tmap.openPopup(this);\n\t\treturn this;\n\t},\n\n\tonRemove: function (map) {\n\t\tif (map._fadeAnimated) {\n\t\t\tL.DomUtil.setOpacity(this._container, 0);\n\t\t\tthis._removeTimeout = setTimeout(L.bind(L.DomUtil.remove, L.DomUtil, this._container), 200);\n\t\t} else {\n\t\t\tL.DomUtil.remove(this._container);\n\t\t}\n\n\t\tmap.fire('popupclose', {popup: this});\n\n\t\tif (this._source) {\n\t\t\tthis._source.fire('popupclose', {popup: this}, true);\n\t\t}\n\t},\n\n\tgetLatLng: function () {\n\t\treturn this._latlng;\n\t},\n\n\tsetLatLng: function (latlng) {\n\t\tthis._latlng = L.latLng(latlng);\n\t\tif (this._map) {\n\t\t\tthis._updatePosition();\n\t\t\tthis._adjustPan();\n\t\t}\n\t\treturn this;\n\t},\n\n\tgetContent: function () {\n\t\treturn this._content;\n\t},\n\n\tsetContent: function (content) {\n\t\tthis._content = content;\n\t\tthis.update();\n\t\treturn this;\n\t},\n\n\tgetElement: function () {\n\t\treturn this._container;\n\t},\n\n\tupdate: function () {\n\t\tif (!this._map) { return; }\n\n\t\tthis._container.style.visibility = 'hidden';\n\n\t\tthis._updateContent();\n\t\tthis._updateLayout();\n\t\tthis._updatePosition();\n\n\t\tthis._container.style.visibility = '';\n\n\t\tthis._adjustPan();\n\t},\n\n\tgetEvents: function () {\n\t\tvar events = {\n\t\t\tzoom: this._updatePosition,\n\t\t\tviewreset: this._updatePosition\n\t\t};\n\n\t\tif (this._zoomAnimated) {\n\t\t\tevents.zoomanim = this._animateZoom;\n\t\t}\n\t\tif ('closeOnClick' in this.options ? this.options.closeOnClick : this._map.options.closePopupOnClick) {\n\t\t\tevents.preclick = this._close;\n\t\t}\n\t\tif (this.options.keepInView) {\n\t\t\tevents.moveend = this._adjustPan;\n\t\t}\n\t\treturn events;\n\t},\n\n\tisOpen: function () {\n\t\treturn !!this._map && this._map.hasLayer(this);\n\t},\n\n\tbringToFront: function () {\n\t\tif (this._map) {\n\t\t\tL.DomUtil.toFront(this._container);\n\t\t}\n\t\treturn this;\n\t},\n\n\tbringToBack: function () {\n\t\tif (this._map) {\n\t\t\tL.DomUtil.toBack(this._container);\n\t\t}\n\t\treturn this;\n\t},\n\n\t_close: function () {\n\t\tif (this._map) {\n\t\t\tthis._map.closePopup(this);\n\t\t}\n\t},\n\n\t_initLayout: function () {\n\t\tvar prefix = 'leaflet-popup',\n\t\t    container = this._container = L.DomUtil.create('div',\n\t\t\tprefix + ' ' + (this.options.className || '') +\n\t\t\t' leaflet-zoom-' + (this._zoomAnimated ? 'animated' : 'hide'));\n\n\t\tif (this.options.closeButton) {\n\t\t\tvar closeButton = this._closeButton = L.DomUtil.create('a', prefix + '-close-button', container);\n\t\t\tcloseButton.href = '#close';\n\t\t\tcloseButton.innerHTML = '&#215;';\n\n\t\t\tL.DomEvent.on(closeButton, 'click', this._onCloseButtonClick, this);\n\t\t}\n\n\t\tvar wrapper = this._wrapper = L.DomUtil.create('div', prefix + '-content-wrapper', container);\n\t\tthis._contentNode = L.DomUtil.create('div', prefix + '-content', wrapper);\n\n\t\tL.DomEvent\n\t\t\t.disableClickPropagation(wrapper)\n\t\t\t.disableScrollPropagation(this._contentNode)\n\t\t\t.on(wrapper, 'contextmenu', L.DomEvent.stopPropagation);\n\n\t\tthis._tipContainer = L.DomUtil.create('div', prefix + '-tip-container', container);\n\t\tthis._tip = L.DomUtil.create('div', prefix + '-tip', this._tipContainer);\n\t},\n\n\t_updateContent: function () {\n\t\tif (!this._content) { return; }\n\n\t\tvar node = this._contentNode;\n\t\tvar content = (typeof this._content === 'function') ? this._content(this._source || this) : this._content;\n\n\t\tif (typeof content === 'string') {\n\t\t\tnode.innerHTML = content;\n\t\t} else {\n\t\t\twhile (node.hasChildNodes()) {\n\t\t\t\tnode.removeChild(node.firstChild);\n\t\t\t}\n\t\t\tnode.appendChild(content);\n\t\t}\n\t\tthis.fire('contentupdate');\n\t},\n\n\t_updateLayout: function () {\n\t\tvar container = this._contentNode,\n\t\t    style = container.style;\n\n\t\tstyle.width = '';\n\t\tstyle.whiteSpace = 'nowrap';\n\n\t\tvar width = container.offsetWidth;\n\t\twidth = Math.min(width, this.options.maxWidth);\n\t\twidth = Math.max(width, this.options.minWidth);\n\n\t\tstyle.width = (width + 1) + 'px';\n\t\tstyle.whiteSpace = '';\n\n\t\tstyle.height = '';\n\n\t\tvar height = container.offsetHeight,\n\t\t    maxHeight = this.options.maxHeight,\n\t\t    scrolledClass = 'leaflet-popup-scrolled';\n\n\t\tif (maxHeight && height > maxHeight) {\n\t\t\tstyle.height = maxHeight + 'px';\n\t\t\tL.DomUtil.addClass(container, scrolledClass);\n\t\t} else {\n\t\t\tL.DomUtil.removeClass(container, scrolledClass);\n\t\t}\n\n\t\tthis._containerWidth = this._container.offsetWidth;\n\t},\n\n\t_updatePosition: function () {\n\t\tif (!this._map) { return; }\n\n\t\tvar pos = this._map.latLngToLayerPoint(this._latlng),\n\t\t    offset = L.point(this.options.offset);\n\n\t\tif (this._zoomAnimated) {\n\t\t\tL.DomUtil.setPosition(this._container, pos);\n\t\t} else {\n\t\t\toffset = offset.add(pos);\n\t\t}\n\n\t\tvar bottom = this._containerBottom = -offset.y,\n\t\t    left = this._containerLeft = -Math.round(this._containerWidth / 2) + offset.x;\n\n\t\t// bottom position the popup in case the height of the popup changes (images loading etc)\n\t\tthis._container.style.bottom = bottom + 'px';\n\t\tthis._container.style.left = left + 'px';\n\t},\n\n\t_animateZoom: function (e) {\n\t\tvar pos = this._map._latLngToNewLayerPoint(this._latlng, e.zoom, e.center);\n\t\tL.DomUtil.setPosition(this._container, pos);\n\t},\n\n\t_adjustPan: function () {\n\t\tif (!this.options.autoPan || (this._map._panAnim && this._map._panAnim._inProgress)) { return; }\n\n\t\tvar map = this._map,\n\t\t    containerHeight = this._container.offsetHeight,\n\t\t    containerWidth = this._containerWidth,\n\t\t    layerPos = new L.Point(this._containerLeft, -containerHeight - this._containerBottom);\n\n\t\tif (this._zoomAnimated) {\n\t\t\tlayerPos._add(L.DomUtil.getPosition(this._container));\n\t\t}\n\n\t\tvar containerPos = map.layerPointToContainerPoint(layerPos),\n\t\t    padding = L.point(this.options.autoPanPadding),\n\t\t    paddingTL = L.point(this.options.autoPanPaddingTopLeft || padding),\n\t\t    paddingBR = L.point(this.options.autoPanPaddingBottomRight || padding),\n\t\t    size = map.getSize(),\n\t\t    dx = 0,\n\t\t    dy = 0;\n\n\t\tif (containerPos.x + containerWidth + paddingBR.x > size.x) { // right\n\t\t\tdx = containerPos.x + containerWidth - size.x + paddingBR.x;\n\t\t}\n\t\tif (containerPos.x - dx - paddingTL.x < 0) { // left\n\t\t\tdx = containerPos.x - paddingTL.x;\n\t\t}\n\t\tif (containerPos.y + containerHeight + paddingBR.y > size.y) { // bottom\n\t\t\tdy = containerPos.y + containerHeight - size.y + paddingBR.y;\n\t\t}\n\t\tif (containerPos.y - dy - paddingTL.y < 0) { // top\n\t\t\tdy = containerPos.y - paddingTL.y;\n\t\t}\n\n\t\tif (dx || dy) {\n\t\t\tmap\n\t\t\t    .fire('autopanstart')\n\t\t\t    .panBy([dx, dy]);\n\t\t}\n\t},\n\n\t_onCloseButtonClick: function (e) {\n\t\tthis._close();\n\t\tL.DomEvent.stop(e);\n\t}\n});\n\nL.popup = function (options, source) {\n\treturn new L.Popup(options, source);\n};\n\n\nL.Map.include({\n\topenPopup: function (popup, latlng, options) { // (Popup) or (String || HTMLElement, LatLng[, Object])\n\t\tif (!(popup instanceof L.Popup)) {\n\t\t\tpopup = new L.Popup(options).setContent(popup);\n\t\t}\n\n\t\tif (latlng) {\n\t\t\tpopup.setLatLng(latlng);\n\t\t}\n\n\t\tif (this.hasLayer(popup)) {\n\t\t\treturn this;\n\t\t}\n\n\t\tif (this._popup && this._popup.options.autoClose) {\n\t\t\tthis.closePopup();\n\t\t}\n\n\t\tthis._popup = popup;\n\t\treturn this.addLayer(popup);\n\t},\n\n\tclosePopup: function (popup) {\n\t\tif (!popup || popup === this._popup) {\n\t\t\tpopup = this._popup;\n\t\t\tthis._popup = null;\n\t\t}\n\t\tif (popup) {\n\t\t\tthis.removeLayer(popup);\n\t\t}\n\t\treturn this;\n\t}\n});\n\n\n\n/*\n * Adds popup-related methods to all layers.\n */\n\nL.Layer.include({\n\n\tbindPopup: function (content, options) {\n\n\t\tif (content instanceof L.Popup) {\n\t\t\tL.setOptions(content, options);\n\t\t\tthis._popup = content;\n\t\t\tcontent._source = this;\n\t\t} else {\n\t\t\tif (!this._popup || options) {\n\t\t\t\tthis._popup = new L.Popup(options, this);\n\t\t\t}\n\t\t\tthis._popup.setContent(content);\n\t\t}\n\n\t\tif (!this._popupHandlersAdded) {\n\t\t\tthis.on({\n\t\t\t\tclick: this._openPopup,\n\t\t\t\tremove: this.closePopup,\n\t\t\t\tmove: this._movePopup\n\t\t\t});\n\t\t\tthis._popupHandlersAdded = true;\n\t\t}\n\n\t\t// save the originally passed offset\n\t\tthis._originalPopupOffset = this._popup.options.offset;\n\n\t\treturn this;\n\t},\n\n\tunbindPopup: function () {\n\t\tif (this._popup) {\n\t\t\tthis.off({\n\t\t\t\tclick: this._openPopup,\n\t\t\t\tremove: this.closePopup,\n\t\t\t\tmove: this._movePopup\n\t\t\t});\n\t\t\tthis._popupHandlersAdded = false;\n\t\t\tthis._popup = null;\n\t\t}\n\t\treturn this;\n\t},\n\n\topenPopup: function (layer, latlng) {\n\t\tif (!(layer instanceof L.Layer)) {\n\t\t\tlatlng = layer;\n\t\t\tlayer = this;\n\t\t}\n\n\t\tif (layer instanceof L.FeatureGroup) {\n\t\t\tfor (var id in this._layers) {\n\t\t\t\tlayer = this._layers[id];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (!latlng) {\n\t\t\tlatlng = layer.getCenter ? layer.getCenter() : layer.getLatLng();\n\t\t}\n\n\t\tif (this._popup && this._map) {\n\t\t\t// set the popup offset for this layer\n\t\t\tthis._popup.options.offset = this._popupAnchor(layer);\n\n\t\t\t// set popup source to this layer\n\t\t\tthis._popup._source = layer;\n\n\t\t\t// update the popup (content, layout, ect...)\n\t\t\tthis._popup.update();\n\n\t\t\t// open the popup on the map\n\t\t\tthis._map.openPopup(this._popup, latlng);\n\t\t}\n\n\t\treturn this;\n\t},\n\n\tclosePopup: function () {\n\t\tif (this._popup) {\n\t\t\tthis._popup._close();\n\t\t}\n\t\treturn this;\n\t},\n\n\ttogglePopup: function (target) {\n\t\tif (this._popup) {\n\t\t\tif (this._popup._map) {\n\t\t\t\tthis.closePopup();\n\t\t\t} else {\n\t\t\t\tthis.openPopup(target);\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t},\n\n\tisPopupOpen: function () {\n\t\treturn this._popup.isOpen();\n\t},\n\n\tsetPopupContent: function (content) {\n\t\tif (this._popup) {\n\t\t\tthis._popup.setContent(content);\n\t\t}\n\t\treturn this;\n\t},\n\n\tgetPopup: function () {\n\t\treturn this._popup;\n\t},\n\n\t_openPopup: function (e) {\n\t\tvar layer = e.layer || e.target;\n\n\t\tif (!this._popup) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._map) {\n\t\t\treturn;\n\t\t}\n\n\t\t// if this inherits from Path its a vector and we can just\n\t\t// open the popup at the new location\n\t\tif (layer instanceof L.Path) {\n\t\t\tthis.openPopup(e.layer || e.target, e.latlng);\n\t\t\treturn;\n\t\t}\n\n\t\t// otherwise treat it like a marker and figure out\n\t\t// if we should toggle it open/closed\n\t\tif (this._map.hasLayer(this._popup) && this._popup._source === layer) {\n\t\t\tthis.closePopup();\n\t\t} else {\n\t\t\tthis.openPopup(layer, e.latlng);\n\t\t}\n\t},\n\n\t_popupAnchor: function (layer) {\n\t\t// where shold we anchor the popup on this layer?\n\t\tvar anchor = layer._getPopupAnchor ? layer._getPopupAnchor() : [0, 0];\n\n\t\t// add the users passed offset to that\n\t\tvar offsetToAdd = this._originalPopupOffset || L.Popup.prototype.options.offset;\n\n\t\t// return the final point to anchor the popup\n\t\treturn L.point(anchor).add(offsetToAdd);\n\t},\n\n\t_movePopup: function (e) {\n\t\tthis._popup.setLatLng(e.latlng);\n\t}\n});\n\n\n\n/*\n * Popup extension to L.Marker, adding popup-related methods.\n */\n\nL.Marker.include({\n\t_getPopupAnchor: function () {\n\t\treturn this.options.icon.options.popupAnchor || [0, 0];\n\t}\n});\n\n\n\n/*\n * L.LayerGroup is a class to combine several layers into one so that\n * you can manipulate the group (e.g. add/remove it) as one layer.\n */\n\nL.LayerGroup = L.Layer.extend({\n\n\tinitialize: function (layers) {\n\t\tthis._layers = {};\n\n\t\tvar i, len;\n\n\t\tif (layers) {\n\t\t\tfor (i = 0, len = layers.length; i < len; i++) {\n\t\t\t\tthis.addLayer(layers[i]);\n\t\t\t}\n\t\t}\n\t},\n\n\taddLayer: function (layer) {\n\t\tvar id = this.getLayerId(layer);\n\n\t\tthis._layers[id] = layer;\n\n\t\tif (this._map) {\n\t\t\tthis._map.addLayer(layer);\n\t\t}\n\n\t\treturn this;\n\t},\n\n\tremoveLayer: function (layer) {\n\t\tvar id = layer in this._layers ? layer : this.getLayerId(layer);\n\n\t\tif (this._map && this._layers[id]) {\n\t\t\tthis._map.removeLayer(this._layers[id]);\n\t\t}\n\n\t\tdelete this._layers[id];\n\n\t\treturn this;\n\t},\n\n\thasLayer: function (layer) {\n\t\treturn !!layer && (layer in this._layers || this.getLayerId(layer) in this._layers);\n\t},\n\n\tclearLayers: function () {\n\t\tfor (var i in this._layers) {\n\t\t\tthis.removeLayer(this._layers[i]);\n\t\t}\n\t\treturn this;\n\t},\n\n\tinvoke: function (methodName) {\n\t\tvar args = Array.prototype.slice.call(arguments, 1),\n\t\t    i, layer;\n\n\t\tfor (i in this._layers) {\n\t\t\tlayer = this._layers[i];\n\n\t\t\tif (layer[methodName]) {\n\t\t\t\tlayer[methodName].apply(layer, args);\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t},\n\n\tonAdd: function (map) {\n\t\tfor (var i in this._layers) {\n\t\t\tmap.addLayer(this._layers[i]);\n\t\t}\n\t},\n\n\tonRemove: function (map) {\n\t\tfor (var i in this._layers) {\n\t\t\tmap.removeLayer(this._layers[i]);\n\t\t}\n\t},\n\n\teachLayer: function (method, context) {\n\t\tfor (var i in this._layers) {\n\t\t\tmethod.call(context, this._layers[i]);\n\t\t}\n\t\treturn this;\n\t},\n\n\tgetLayer: function (id) {\n\t\treturn this._layers[id];\n\t},\n\n\tgetLayers: function () {\n\t\tvar layers = [];\n\n\t\tfor (var i in this._layers) {\n\t\t\tlayers.push(this._layers[i]);\n\t\t}\n\t\treturn layers;\n\t},\n\n\tsetZIndex: function (zIndex) {\n\t\treturn this.invoke('setZIndex', zIndex);\n\t},\n\n\tgetLayerId: function (layer) {\n\t\treturn L.stamp(layer);\n\t}\n});\n\nL.layerGroup = function (layers) {\n\treturn new L.LayerGroup(layers);\n};\n\n\n\n/*\n * L.FeatureGroup extends L.LayerGroup by introducing mouse events and additional methods\n * shared between a group of interactive layers (like vectors or markers).\n */\n\nL.FeatureGroup = L.LayerGroup.extend({\n\n\taddLayer: function (layer) {\n\t\tif (this.hasLayer(layer)) {\n\t\t\treturn this;\n\t\t}\n\n\t\tlayer.addEventParent(this);\n\n\t\tL.LayerGroup.prototype.addLayer.call(this, layer);\n\n\t\treturn this.fire('layeradd', {layer: layer});\n\t},\n\n\tremoveLayer: function (layer) {\n\t\tif (!this.hasLayer(layer)) {\n\t\t\treturn this;\n\t\t}\n\t\tif (layer in this._layers) {\n\t\t\tlayer = this._layers[layer];\n\t\t}\n\n\t\tlayer.removeEventParent(this);\n\n\t\tL.LayerGroup.prototype.removeLayer.call(this, layer);\n\n\t\treturn this.fire('layerremove', {layer: layer});\n\t},\n\n\tsetStyle: function (style) {\n\t\treturn this.invoke('setStyle', style);\n\t},\n\n\tbringToFront: function () {\n\t\treturn this.invoke('bringToFront');\n\t},\n\n\tbringToBack: function () {\n\t\treturn this.invoke('bringToBack');\n\t},\n\n\tgetBounds: function () {\n\t\tvar bounds = new L.LatLngBounds();\n\n\t\tfor (var id in this._layers) {\n\t\t\tvar layer = this._layers[id];\n\t\t\tbounds.extend(layer.getBounds ? layer.getBounds() : layer.getLatLng());\n\t\t}\n\t\treturn bounds;\n\t}\n});\n\nL.featureGroup = function (layers) {\n\treturn new L.FeatureGroup(layers);\n};\n\n\n\n/*\n * L.Renderer is a base class for renderer implementations (SVG, Canvas);\n * handles renderer container, bounds and zoom animation.\n */\n\nL.Renderer = L.Layer.extend({\n\n\toptions: {\n\t\t// how much to extend the clip area around the map view (relative to its size)\n\t\t// e.g. 0.1 would be 10% of map view in each direction; defaults to clip with the map view\n\t\tpadding: 0.1\n\t},\n\n\tinitialize: function (options) {\n\t\tL.setOptions(this, options);\n\t\tL.stamp(this);\n\t},\n\n\tonAdd: function () {\n\t\tif (!this._container) {\n\t\t\tthis._initContainer(); // defined by renderer implementations\n\n\t\t\tif (this._zoomAnimated) {\n\t\t\t\tL.DomUtil.addClass(this._container, 'leaflet-zoom-animated');\n\t\t\t}\n\t\t}\n\n\t\tthis.getPane().appendChild(this._container);\n\t\tthis._update();\n\t},\n\n\tonRemove: function () {\n\t\tL.DomUtil.remove(this._container);\n\t},\n\n\tgetEvents: function () {\n\t\tvar events = {\n\t\t\tviewreset: this._reset,\n\t\t\tzoomstart: this._onZoomStart,\n\t\t\tzoom: this._onZoom,\n\t\t\tmoveend: this._update\n\t\t};\n\t\tif (this._zoomAnimated) {\n\t\t\tevents.zoomanim = this._onAnimZoom;\n\t\t}\n\t\treturn events;\n\t},\n\n\t_onAnimZoom: function (ev) {\n\t\tthis._updateTransform(ev.center, ev.zoom);\n\t},\n\n\t_onZoom: function () {\n\t\tthis._updateTransform(this._map.getCenter(), this._map.getZoom());\n\t},\n\n\t_onZoomStart: function () {\n\t\t// Drag-then-pinch interactions might mess up the center and zoom.\n\t\t// In this case, the easiest way to prevent this is re-do the renderer\n\t\t//   bounds and padding when the zooming starts.\n\t\tthis._update();\n\t},\n\n\t_updateTransform: function (center, zoom) {\n\t\tvar scale = this._map.getZoomScale(zoom, this._zoom),\n\t\t    position = L.DomUtil.getPosition(this._container),\n\t\t    viewHalf = this._map.getSize().multiplyBy(0.5 + this.options.padding),\n\t\t    currentCenterPoint = this._map.project(this._center, zoom),\n\t\t    destCenterPoint = this._map.project(center, zoom),\n\t\t    centerOffset = destCenterPoint.subtract(currentCenterPoint),\n\n\t\t    topLeftOffset = viewHalf.multiplyBy(-scale).add(position).add(viewHalf).subtract(centerOffset);\n\n\t\tL.DomUtil.setTransform(this._container, topLeftOffset, scale);\n\t},\n\n\t_reset: function () {\n\t\tthis._update();\n\t\tthis._updateTransform(this._center, this._zoom);\n\t},\n\n\t_update: function () {\n\t\t// update pixel bounds of renderer container (for positioning/sizing/clipping later)\n\t\tvar p = this.options.padding,\n\t\t    size = this._map.getSize(),\n\t\t    min = this._map.containerPointToLayerPoint(size.multiplyBy(-p)).round();\n\n\t\tthis._bounds = new L.Bounds(min, min.add(size.multiplyBy(1 + p * 2)).round());\n\n\t\tthis._center = this._map.getCenter();\n\t\tthis._zoom = this._map.getZoom();\n\t}\n});\n\n\nL.Map.include({\n\t// used by each vector layer to decide which renderer to use\n\tgetRenderer: function (layer) {\n\t\tvar renderer = layer.options.renderer || this._getPaneRenderer(layer.options.pane) || this.options.renderer || this._renderer;\n\n\t\tif (!renderer) {\n\t\t\trenderer = this._renderer = (this.options.preferCanvas && L.canvas()) || L.svg();\n\t\t}\n\n\t\tif (!this.hasLayer(renderer)) {\n\t\t\tthis.addLayer(renderer);\n\t\t}\n\t\treturn renderer;\n\t},\n\n\t_getPaneRenderer: function (name) {\n\t\tif (name === 'overlayPane' || name === undefined) {\n\t\t\treturn false;\n\t\t}\n\n\t\tvar renderer = this._paneRenderers[name];\n\t\tif (renderer === undefined) {\n\t\t\trenderer = (L.SVG && L.svg({pane: name})) || (L.Canvas && L.canvas({pane: name}));\n\t\t\tthis._paneRenderers[name] = renderer;\n\t\t}\n\t\treturn renderer;\n\t}\n});\n\n\n\n/*\n * L.Path is the base class for all Leaflet vector layers like polygons and circles.\n */\n\nL.Path = L.Layer.extend({\n\n\toptions: {\n\t\tstroke: true,\n\t\tcolor: '#3388ff',\n\t\tweight: 3,\n\t\topacity: 1,\n\t\tlineCap: 'round',\n\t\tlineJoin: 'round',\n\t\t// dashArray: null\n\t\t// dashOffset: null\n\n\t\t// fill: false\n\t\t// fillColor: same as color by default\n\t\tfillOpacity: 0.2,\n\t\tfillRule: 'evenodd',\n\n\t\t// className: ''\n\t\tinteractive: true\n\t},\n\n\tbeforeAdd: function (map) {\n\t\t// Renderer is set here because we need to call renderer.getEvents\n\t\t// before this.getEvents.\n\t\tthis._renderer = map.getRenderer(this);\n\t},\n\n\tonAdd: function () {\n\t\tthis._renderer._initPath(this);\n\t\tthis._reset();\n\t\tthis._renderer._addPath(this);\n\t},\n\n\tonRemove: function () {\n\t\tthis._renderer._removePath(this);\n\t},\n\n\tgetEvents: function () {\n\t\treturn {\n\t\t\tzoomend: this._project,\n\t\t\tmoveend: this._update,\n\t\t\tviewreset: this._reset\n\t\t};\n\t},\n\n\tredraw: function () {\n\t\tif (this._map) {\n\t\t\tthis._renderer._updatePath(this);\n\t\t}\n\t\treturn this;\n\t},\n\n\tsetStyle: function (style) {\n\t\tL.setOptions(this, style);\n\t\tif (this._renderer) {\n\t\t\tthis._renderer._updateStyle(this);\n\t\t}\n\t\treturn this;\n\t},\n\n\tbringToFront: function () {\n\t\tif (this._renderer) {\n\t\t\tthis._renderer._bringToFront(this);\n\t\t}\n\t\treturn this;\n\t},\n\n\tbringToBack: function () {\n\t\tif (this._renderer) {\n\t\t\tthis._renderer._bringToBack(this);\n\t\t}\n\t\treturn this;\n\t},\n\n\tgetElement: function () {\n\t\treturn this._path;\n\t},\n\n\t_reset: function () {\n\t\t// defined in children classes\n\t\tthis._project();\n\t\tthis._update();\n\t},\n\n\t_clickTolerance: function () {\n\t\t// used when doing hit detection for Canvas layers\n\t\treturn (this.options.stroke ? this.options.weight / 2 : 0) + (L.Browser.touch ? 10 : 0);\n\t}\n});\n\n\n\n/*\n * L.LineUtil contains different utility functions for line segments\n * and polylines (clipping, simplification, distances, etc.)\n */\n\nL.LineUtil = {\n\n\t// Simplify polyline with vertex reduction and Douglas-Peucker simplification.\n\t// Improves rendering performance dramatically by lessening the number of points to draw.\n\n\tsimplify: function (points, tolerance) {\n\t\tif (!tolerance || !points.length) {\n\t\t\treturn points.slice();\n\t\t}\n\n\t\tvar sqTolerance = tolerance * tolerance;\n\n\t\t// stage 1: vertex reduction\n\t\tpoints = this._reducePoints(points, sqTolerance);\n\n\t\t// stage 2: Douglas-Peucker simplification\n\t\tpoints = this._simplifyDP(points, sqTolerance);\n\n\t\treturn points;\n\t},\n\n\t// distance from a point to a segment between two points\n\tpointToSegmentDistance:  function (p, p1, p2) {\n\t\treturn Math.sqrt(this._sqClosestPointOnSegment(p, p1, p2, true));\n\t},\n\n\tclosestPointOnSegment: function (p, p1, p2) {\n\t\treturn this._sqClosestPointOnSegment(p, p1, p2);\n\t},\n\n\t// Douglas-Peucker simplification, see http://en.wikipedia.org/wiki/Douglas-Peucker_algorithm\n\t_simplifyDP: function (points, sqTolerance) {\n\n\t\tvar len = points.length,\n\t\t    ArrayConstructor = typeof Uint8Array !== undefined + '' ? Uint8Array : Array,\n\t\t    markers = new ArrayConstructor(len);\n\n\t\tmarkers[0] = markers[len - 1] = 1;\n\n\t\tthis._simplifyDPStep(points, markers, sqTolerance, 0, len - 1);\n\n\t\tvar i,\n\t\t    newPoints = [];\n\n\t\tfor (i = 0; i < len; i++) {\n\t\t\tif (markers[i]) {\n\t\t\t\tnewPoints.push(points[i]);\n\t\t\t}\n\t\t}\n\n\t\treturn newPoints;\n\t},\n\n\t_simplifyDPStep: function (points, markers, sqTolerance, first, last) {\n\n\t\tvar maxSqDist = 0,\n\t\t    index, i, sqDist;\n\n\t\tfor (i = first + 1; i <= last - 1; i++) {\n\t\t\tsqDist = this._sqClosestPointOnSegment(points[i], points[first], points[last], true);\n\n\t\t\tif (sqDist > maxSqDist) {\n\t\t\t\tindex = i;\n\t\t\t\tmaxSqDist = sqDist;\n\t\t\t}\n\t\t}\n\n\t\tif (maxSqDist > sqTolerance) {\n\t\t\tmarkers[index] = 1;\n\n\t\t\tthis._simplifyDPStep(points, markers, sqTolerance, first, index);\n\t\t\tthis._simplifyDPStep(points, markers, sqTolerance, index, last);\n\t\t}\n\t},\n\n\t// reduce points that are too close to each other to a single point\n\t_reducePoints: function (points, sqTolerance) {\n\t\tvar reducedPoints = [points[0]];\n\n\t\tfor (var i = 1, prev = 0, len = points.length; i < len; i++) {\n\t\t\tif (this._sqDist(points[i], points[prev]) > sqTolerance) {\n\t\t\t\treducedPoints.push(points[i]);\n\t\t\t\tprev = i;\n\t\t\t}\n\t\t}\n\t\tif (prev < len - 1) {\n\t\t\treducedPoints.push(points[len - 1]);\n\t\t}\n\t\treturn reducedPoints;\n\t},\n\n\t// Cohen-Sutherland line clipping algorithm.\n\t// Used to avoid rendering parts of a polyline that are not currently visible.\n\n\tclipSegment: function (a, b, bounds, useLastCode, round) {\n\t\tvar codeA = useLastCode ? this._lastCode : this._getBitCode(a, bounds),\n\t\t    codeB = this._getBitCode(b, bounds),\n\n\t\t    codeOut, p, newCode;\n\n\t\t// save 2nd code to avoid calculating it on the next segment\n\t\tthis._lastCode = codeB;\n\n\t\twhile (true) {\n\t\t\t// if a,b is inside the clip window (trivial accept)\n\t\t\tif (!(codeA | codeB)) { return [a, b]; }\n\n\t\t\t// if a,b is outside the clip window (trivial reject)\n\t\t\tif (codeA & codeB) { return false; }\n\n\t\t\t// other cases\n\t\t\tcodeOut = codeA || codeB;\n\t\t\tp = this._getEdgeIntersection(a, b, codeOut, bounds, round);\n\t\t\tnewCode = this._getBitCode(p, bounds);\n\n\t\t\tif (codeOut === codeA) {\n\t\t\t\ta = p;\n\t\t\t\tcodeA = newCode;\n\t\t\t} else {\n\t\t\t\tb = p;\n\t\t\t\tcodeB = newCode;\n\t\t\t}\n\t\t}\n\t},\n\n\t_getEdgeIntersection: function (a, b, code, bounds, round) {\n\t\tvar dx = b.x - a.x,\n\t\t    dy = b.y - a.y,\n\t\t    min = bounds.min,\n\t\t    max = bounds.max,\n\t\t    x, y;\n\n\t\tif (code & 8) { // top\n\t\t\tx = a.x + dx * (max.y - a.y) / dy;\n\t\t\ty = max.y;\n\n\t\t} else if (code & 4) { // bottom\n\t\t\tx = a.x + dx * (min.y - a.y) / dy;\n\t\t\ty = min.y;\n\n\t\t} else if (code & 2) { // right\n\t\t\tx = max.x;\n\t\t\ty = a.y + dy * (max.x - a.x) / dx;\n\n\t\t} else if (code & 1) { // left\n\t\t\tx = min.x;\n\t\t\ty = a.y + dy * (min.x - a.x) / dx;\n\t\t}\n\n\t\treturn new L.Point(x, y, round);\n\t},\n\n\t_getBitCode: function (p, bounds) {\n\t\tvar code = 0;\n\n\t\tif (p.x < bounds.min.x) { // left\n\t\t\tcode |= 1;\n\t\t} else if (p.x > bounds.max.x) { // right\n\t\t\tcode |= 2;\n\t\t}\n\n\t\tif (p.y < bounds.min.y) { // bottom\n\t\t\tcode |= 4;\n\t\t} else if (p.y > bounds.max.y) { // top\n\t\t\tcode |= 8;\n\t\t}\n\n\t\treturn code;\n\t},\n\n\t// square distance (to avoid unnecessary Math.sqrt calls)\n\t_sqDist: function (p1, p2) {\n\t\tvar dx = p2.x - p1.x,\n\t\t    dy = p2.y - p1.y;\n\t\treturn dx * dx + dy * dy;\n\t},\n\n\t// return closest point on segment or distance to that point\n\t_sqClosestPointOnSegment: function (p, p1, p2, sqDist) {\n\t\tvar x = p1.x,\n\t\t    y = p1.y,\n\t\t    dx = p2.x - x,\n\t\t    dy = p2.y - y,\n\t\t    dot = dx * dx + dy * dy,\n\t\t    t;\n\n\t\tif (dot > 0) {\n\t\t\tt = ((p.x - x) * dx + (p.y - y) * dy) / dot;\n\n\t\t\tif (t > 1) {\n\t\t\t\tx = p2.x;\n\t\t\t\ty = p2.y;\n\t\t\t} else if (t > 0) {\n\t\t\t\tx += dx * t;\n\t\t\t\ty += dy * t;\n\t\t\t}\n\t\t}\n\n\t\tdx = p.x - x;\n\t\tdy = p.y - y;\n\n\t\treturn sqDist ? dx * dx + dy * dy : new L.Point(x, y);\n\t}\n};\n\n\n\n/*\n * L.Polyline implements polyline vector layer (a set of points connected with lines)\n */\n\nL.Polyline = L.Path.extend({\n\n\toptions: {\n\t\t// how much to simplify the polyline on each zoom level\n\t\t// more = better performance and smoother look, less = more accurate\n\t\tsmoothFactor: 1.0\n\t\t// noClip: false\n\t},\n\n\tinitialize: function (latlngs, options) {\n\t\tL.setOptions(this, options);\n\t\tthis._setLatLngs(latlngs);\n\t},\n\n\tgetLatLngs: function () {\n\t\treturn this._latlngs;\n\t},\n\n\tsetLatLngs: function (latlngs) {\n\t\tthis._setLatLngs(latlngs);\n\t\treturn this.redraw();\n\t},\n\n\tisEmpty: function () {\n\t\treturn !this._latlngs.length;\n\t},\n\n\tclosestLayerPoint: function (p) {\n\t\tvar minDistance = Infinity,\n\t\t    minPoint = null,\n\t\t    closest = L.LineUtil._sqClosestPointOnSegment,\n\t\t    p1, p2;\n\n\t\tfor (var j = 0, jLen = this._parts.length; j < jLen; j++) {\n\t\t\tvar points = this._parts[j];\n\n\t\t\tfor (var i = 1, len = points.length; i < len; i++) {\n\t\t\t\tp1 = points[i - 1];\n\t\t\t\tp2 = points[i];\n\n\t\t\t\tvar sqDist = closest(p, p1, p2, true);\n\n\t\t\t\tif (sqDist < minDistance) {\n\t\t\t\t\tminDistance = sqDist;\n\t\t\t\t\tminPoint = closest(p, p1, p2);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (minPoint) {\n\t\t\tminPoint.distance = Math.sqrt(minDistance);\n\t\t}\n\t\treturn minPoint;\n\t},\n\n\tgetCenter: function () {\n\t\tvar i, halfDist, segDist, dist, p1, p2, ratio,\n\t\t    points = this._rings[0],\n\t\t    len = points.length;\n\n\t\tif (!len) { return null; }\n\n\t\t// polyline centroid algorithm; only uses the first ring if there are multiple\n\n\t\tfor (i = 0, halfDist = 0; i < len - 1; i++) {\n\t\t\thalfDist += points[i].distanceTo(points[i + 1]) / 2;\n\t\t}\n\n\t\t// The line is so small in the current view that all points are on the same pixel.\n\t\tif (halfDist === 0) {\n\t\t\treturn this._map.layerPointToLatLng(points[0]);\n\t\t}\n\n\t\tfor (i = 0, dist = 0; i < len - 1; i++) {\n\t\t\tp1 = points[i];\n\t\t\tp2 = points[i + 1];\n\t\t\tsegDist = p1.distanceTo(p2);\n\t\t\tdist += segDist;\n\n\t\t\tif (dist > halfDist) {\n\t\t\t\tratio = (dist - halfDist) / segDist;\n\t\t\t\treturn this._map.layerPointToLatLng([\n\t\t\t\t\tp2.x - ratio * (p2.x - p1.x),\n\t\t\t\t\tp2.y - ratio * (p2.y - p1.y)\n\t\t\t\t]);\n\t\t\t}\n\t\t}\n\t},\n\n\tgetBounds: function () {\n\t\treturn this._bounds;\n\t},\n\n\taddLatLng: function (latlng, latlngs) {\n\t\tlatlngs = latlngs || this._defaultShape();\n\t\tlatlng = L.latLng(latlng);\n\t\tlatlngs.push(latlng);\n\t\tthis._bounds.extend(latlng);\n\t\treturn this.redraw();\n\t},\n\n\t_setLatLngs: function (latlngs) {\n\t\tthis._bounds = new L.LatLngBounds();\n\t\tthis._latlngs = this._convertLatLngs(latlngs);\n\t},\n\n\t_defaultShape: function () {\n\t\treturn L.Polyline._flat(this._latlngs) ? this._latlngs : this._latlngs[0];\n\t},\n\n\t// recursively convert latlngs input into actual LatLng instances; calculate bounds along the way\n\t_convertLatLngs: function (latlngs) {\n\t\tvar result = [],\n\t\t    flat = L.Polyline._flat(latlngs);\n\n\t\tfor (var i = 0, len = latlngs.length; i < len; i++) {\n\t\t\tif (flat) {\n\t\t\t\tresult[i] = L.latLng(latlngs[i]);\n\t\t\t\tthis._bounds.extend(result[i]);\n\t\t\t} else {\n\t\t\t\tresult[i] = this._convertLatLngs(latlngs[i]);\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t},\n\n\t_project: function () {\n\t\tthis._rings = [];\n\t\tthis._projectLatlngs(this._latlngs, this._rings);\n\n\t\t// project bounds as well to use later for Canvas hit detection/etc.\n\t\tvar w = this._clickTolerance(),\n\t\t    p = new L.Point(w, -w);\n\n\t\tif (this._bounds.isValid()) {\n\t\t\tthis._pxBounds = new L.Bounds(\n\t\t\t\tthis._map.latLngToLayerPoint(this._bounds.getSouthWest())._subtract(p),\n\t\t\t\tthis._map.latLngToLayerPoint(this._bounds.getNorthEast())._add(p));\n\t\t}\n\t},\n\n\t// recursively turns latlngs into a set of rings with projected coordinates\n\t_projectLatlngs: function (latlngs, result) {\n\n\t\tvar flat = latlngs[0] instanceof L.LatLng,\n\t\t    len = latlngs.length,\n\t\t    i, ring;\n\n\t\tif (flat) {\n\t\t\tring = [];\n\t\t\tfor (i = 0; i < len; i++) {\n\t\t\t\tring[i] = this._map.latLngToLayerPoint(latlngs[i]);\n\t\t\t}\n\t\t\tresult.push(ring);\n\t\t} else {\n\t\t\tfor (i = 0; i < len; i++) {\n\t\t\t\tthis._projectLatlngs(latlngs[i], result);\n\t\t\t}\n\t\t}\n\t},\n\n\t// clip polyline by renderer bounds so that we have less to render for performance\n\t_clipPoints: function () {\n\t\tvar bounds = this._renderer._bounds;\n\n\t\tthis._parts = [];\n\t\tif (!this._pxBounds || !this._pxBounds.intersects(bounds)) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.options.noClip) {\n\t\t\tthis._parts = this._rings;\n\t\t\treturn;\n\t\t}\n\n\t\tvar parts = this._parts,\n\t\t    i, j, k, len, len2, segment, points;\n\n\t\tfor (i = 0, k = 0, len = this._rings.length; i < len; i++) {\n\t\t\tpoints = this._rings[i];\n\n\t\t\tfor (j = 0, len2 = points.length; j < len2 - 1; j++) {\n\t\t\t\tsegment = L.LineUtil.clipSegment(points[j], points[j + 1], bounds, j, true);\n\n\t\t\t\tif (!segment) { continue; }\n\n\t\t\t\tparts[k] = parts[k] || [];\n\t\t\t\tparts[k].push(segment[0]);\n\n\t\t\t\t// if segment goes out of screen, or it's the last one, it's the end of the line part\n\t\t\t\tif ((segment[1] !== points[j + 1]) || (j === len2 - 2)) {\n\t\t\t\t\tparts[k].push(segment[1]);\n\t\t\t\t\tk++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\t// simplify each clipped part of the polyline for performance\n\t_simplifyPoints: function () {\n\t\tvar parts = this._parts,\n\t\t    tolerance = this.options.smoothFactor;\n\n\t\tfor (var i = 0, len = parts.length; i < len; i++) {\n\t\t\tparts[i] = L.LineUtil.simplify(parts[i], tolerance);\n\t\t}\n\t},\n\n\t_update: function () {\n\t\tif (!this._map) { return; }\n\n\t\tthis._clipPoints();\n\t\tthis._simplifyPoints();\n\t\tthis._updatePath();\n\t},\n\n\t_updatePath: function () {\n\t\tthis._renderer._updatePoly(this);\n\t}\n});\n\nL.polyline = function (latlngs, options) {\n\treturn new L.Polyline(latlngs, options);\n};\n\nL.Polyline._flat = function (latlngs) {\n\t// true if it's a flat array of latlngs; false if nested\n\treturn !L.Util.isArray(latlngs[0]) || (typeof latlngs[0][0] !== 'object' && typeof latlngs[0][0] !== 'undefined');\n};\n\n\n\n/*\n * L.PolyUtil contains utility functions for polygons (clipping, etc.).\n */\n\nL.PolyUtil = {};\n\n/*\n * Sutherland-Hodgeman polygon clipping algorithm.\n * Used to avoid rendering parts of a polygon that are not currently visible.\n */\nL.PolyUtil.clipPolygon = function (points, bounds, round) {\n\tvar clippedPoints,\n\t    edges = [1, 4, 2, 8],\n\t    i, j, k,\n\t    a, b,\n\t    len, edge, p,\n\t    lu = L.LineUtil;\n\n\tfor (i = 0, len = points.length; i < len; i++) {\n\t\tpoints[i]._code = lu._getBitCode(points[i], bounds);\n\t}\n\n\t// for each edge (left, bottom, right, top)\n\tfor (k = 0; k < 4; k++) {\n\t\tedge = edges[k];\n\t\tclippedPoints = [];\n\n\t\tfor (i = 0, len = points.length, j = len - 1; i < len; j = i++) {\n\t\t\ta = points[i];\n\t\t\tb = points[j];\n\n\t\t\t// if a is inside the clip window\n\t\t\tif (!(a._code & edge)) {\n\t\t\t\t// if b is outside the clip window (a->b goes out of screen)\n\t\t\t\tif (b._code & edge) {\n\t\t\t\t\tp = lu._getEdgeIntersection(b, a, edge, bounds, round);\n\t\t\t\t\tp._code = lu._getBitCode(p, bounds);\n\t\t\t\t\tclippedPoints.push(p);\n\t\t\t\t}\n\t\t\t\tclippedPoints.push(a);\n\n\t\t\t// else if b is inside the clip window (a->b enters the screen)\n\t\t\t} else if (!(b._code & edge)) {\n\t\t\t\tp = lu._getEdgeIntersection(b, a, edge, bounds, round);\n\t\t\t\tp._code = lu._getBitCode(p, bounds);\n\t\t\t\tclippedPoints.push(p);\n\t\t\t}\n\t\t}\n\t\tpoints = clippedPoints;\n\t}\n\n\treturn points;\n};\n\n\n\n/*\n * L.Polygon implements polygon vector layer (closed polyline with a fill inside).\n */\n\nL.Polygon = L.Polyline.extend({\n\n\toptions: {\n\t\tfill: true\n\t},\n\n\tisEmpty: function () {\n\t\treturn !this._latlngs.length || !this._latlngs[0].length;\n\t},\n\n\tgetCenter: function () {\n\t\tvar i, j, p1, p2, f, area, x, y, center,\n\t\t    points = this._rings[0],\n\t\t    len = points.length;\n\n\t\tif (!len) { return null; }\n\n\t\t// polygon centroid algorithm; only uses the first ring if there are multiple\n\n\t\tarea = x = y = 0;\n\n\t\tfor (i = 0, j = len - 1; i < len; j = i++) {\n\t\t\tp1 = points[i];\n\t\t\tp2 = points[j];\n\n\t\t\tf = p1.y * p2.x - p2.y * p1.x;\n\t\t\tx += (p1.x + p2.x) * f;\n\t\t\ty += (p1.y + p2.y) * f;\n\t\t\tarea += f * 3;\n\t\t}\n\n\t\tif (area === 0) {\n\t\t\t// Polygon is so small that all points are on same pixel.\n\t\t\tcenter = points[0];\n\t\t} else {\n\t\t\tcenter = [x / area, y / area];\n\t\t}\n\t\treturn this._map.layerPointToLatLng(center);\n\t},\n\n\t_convertLatLngs: function (latlngs) {\n\t\tvar result = L.Polyline.prototype._convertLatLngs.call(this, latlngs),\n\t\t    len = result.length;\n\n\t\t// remove last point if it equals first one\n\t\tif (len >= 2 && result[0] instanceof L.LatLng && result[0].equals(result[len - 1])) {\n\t\t\tresult.pop();\n\t\t}\n\t\treturn result;\n\t},\n\n\t_setLatLngs: function (latlngs) {\n\t\tL.Polyline.prototype._setLatLngs.call(this, latlngs);\n\t\tif (L.Polyline._flat(this._latlngs)) {\n\t\t\tthis._latlngs = [this._latlngs];\n\t\t}\n\t},\n\n\t_defaultShape: function () {\n\t\treturn L.Polyline._flat(this._latlngs[0]) ? this._latlngs[0] : this._latlngs[0][0];\n\t},\n\n\t_clipPoints: function () {\n\t\t// polygons need a different clipping algorithm so we redefine that\n\n\t\tvar bounds = this._renderer._bounds,\n\t\t    w = this.options.weight,\n\t\t    p = new L.Point(w, w);\n\n\t\t// increase clip padding by stroke width to avoid stroke on clip edges\n\t\tbounds = new L.Bounds(bounds.min.subtract(p), bounds.max.add(p));\n\n\t\tthis._parts = [];\n\t\tif (!this._pxBounds || !this._pxBounds.intersects(bounds)) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.options.noClip) {\n\t\t\tthis._parts = this._rings;\n\t\t\treturn;\n\t\t}\n\n\t\tfor (var i = 0, len = this._rings.length, clipped; i < len; i++) {\n\t\t\tclipped = L.PolyUtil.clipPolygon(this._rings[i], bounds, true);\n\t\t\tif (clipped.length) {\n\t\t\t\tthis._parts.push(clipped);\n\t\t\t}\n\t\t}\n\t},\n\n\t_updatePath: function () {\n\t\tthis._renderer._updatePoly(this, true);\n\t}\n});\n\nL.polygon = function (latlngs, options) {\n\treturn new L.Polygon(latlngs, options);\n};\n\n\n\n/*\n * L.Rectangle extends Polygon and creates a rectangle when passed a LatLngBounds object.\n */\n\nL.Rectangle = L.Polygon.extend({\n\tinitialize: function (latLngBounds, options) {\n\t\tL.Polygon.prototype.initialize.call(this, this._boundsToLatLngs(latLngBounds), options);\n\t},\n\n\tsetBounds: function (latLngBounds) {\n\t\treturn this.setLatLngs(this._boundsToLatLngs(latLngBounds));\n\t},\n\n\t_boundsToLatLngs: function (latLngBounds) {\n\t\tlatLngBounds = L.latLngBounds(latLngBounds);\n\t\treturn [\n\t\t\tlatLngBounds.getSouthWest(),\n\t\t\tlatLngBounds.getNorthWest(),\n\t\t\tlatLngBounds.getNorthEast(),\n\t\t\tlatLngBounds.getSouthEast()\n\t\t];\n\t}\n});\n\nL.rectangle = function (latLngBounds, options) {\n\treturn new L.Rectangle(latLngBounds, options);\n};\n\n\n\n/*\n * L.CircleMarker is a circle overlay with a permanent pixel radius.\n */\n\nL.CircleMarker = L.Path.extend({\n\n\toptions: {\n\t\tfill: true,\n\t\tradius: 10\n\t},\n\n\tinitialize: function (latlng, options) {\n\t\tL.setOptions(this, options);\n\t\tthis._latlng = L.latLng(latlng);\n\t\tthis._radius = this.options.radius;\n\t},\n\n\tsetLatLng: function (latlng) {\n\t\tthis._latlng = L.latLng(latlng);\n\t\tthis.redraw();\n\t\treturn this.fire('move', {latlng: this._latlng});\n\t},\n\n\tgetLatLng: function () {\n\t\treturn this._latlng;\n\t},\n\n\tsetRadius: function (radius) {\n\t\tthis.options.radius = this._radius = radius;\n\t\treturn this.redraw();\n\t},\n\n\tgetRadius: function () {\n\t\treturn this._radius;\n\t},\n\n\tsetStyle : function (options) {\n\t\tvar radius = options && options.radius || this._radius;\n\t\tL.Path.prototype.setStyle.call(this, options);\n\t\tthis.setRadius(radius);\n\t\treturn this;\n\t},\n\n\t_project: function () {\n\t\tthis._point = this._map.latLngToLayerPoint(this._latlng);\n\t\tthis._updateBounds();\n\t},\n\n\t_updateBounds: function () {\n\t\tvar r = this._radius,\n\t\t    r2 = this._radiusY || r,\n\t\t    w = this._clickTolerance(),\n\t\t    p = [r + w, r2 + w];\n\t\tthis._pxBounds = new L.Bounds(this._point.subtract(p), this._point.add(p));\n\t},\n\n\t_update: function () {\n\t\tif (this._map) {\n\t\t\tthis._updatePath();\n\t\t}\n\t},\n\n\t_updatePath: function () {\n\t\tthis._renderer._updateCircle(this);\n\t},\n\n\t_empty: function () {\n\t\treturn this._radius && !this._renderer._bounds.intersects(this._pxBounds);\n\t}\n});\n\nL.circleMarker = function (latlng, options) {\n\treturn new L.CircleMarker(latlng, options);\n};\n\n\n\n/*\n * L.Circle is a circle overlay (with a certain radius in meters).\n * It's an approximation and starts to diverge from a real circle closer to poles (due to projection distortion)\n */\n\nL.Circle = L.CircleMarker.extend({\n\n\tinitialize: function (latlng, options) {\n\t\tL.setOptions(this, options);\n\t\tthis._latlng = L.latLng(latlng);\n\t\tthis._mRadius = this.options.radius;\n\t},\n\n\tsetRadius: function (radius) {\n\t\tthis._mRadius = radius;\n\t\treturn this.redraw();\n\t},\n\n\tgetRadius: function () {\n\t\treturn this._mRadius;\n\t},\n\n\tgetBounds: function () {\n\t\tvar half = [this._radius, this._radiusY || this._radius];\n\n\t\treturn new L.LatLngBounds(\n\t\t\tthis._map.layerPointToLatLng(this._point.subtract(half)),\n\t\t\tthis._map.layerPointToLatLng(this._point.add(half)));\n\t},\n\n\tsetStyle: L.Path.prototype.setStyle,\n\n\t_project: function () {\n\n\t\tvar lng = this._latlng.lng,\n\t\t    lat = this._latlng.lat,\n\t\t    map = this._map,\n\t\t    crs = map.options.crs;\n\n\t\tif (crs.distance === L.CRS.Earth.distance) {\n\t\t\tvar d = Math.PI / 180,\n\t\t\t    latR = (this._mRadius / L.CRS.Earth.R) / d,\n\t\t\t    top = map.project([lat + latR, lng]),\n\t\t\t    bottom = map.project([lat - latR, lng]),\n\t\t\t    p = top.add(bottom).divideBy(2),\n\t\t\t    lat2 = map.unproject(p).lat,\n\t\t\t    lngR = Math.acos((Math.cos(latR * d) - Math.sin(lat * d) * Math.sin(lat2 * d)) /\n\t\t\t            (Math.cos(lat * d) * Math.cos(lat2 * d))) / d;\n\n\t\t\tthis._point = p.subtract(map.getPixelOrigin());\n\t\t\tthis._radius = isNaN(lngR) ? 0 : Math.max(Math.round(p.x - map.project([lat2, lng - lngR]).x), 1);\n\t\t\tthis._radiusY = Math.max(Math.round(p.y - top.y), 1);\n\n\t\t} else {\n\t\t\tvar latlng2 = crs.unproject(crs.project(this._latlng).subtract([this._mRadius, 0]));\n\n\t\t\tthis._point = map.latLngToLayerPoint(this._latlng);\n\t\t\tthis._radius = this._point.x - map.latLngToLayerPoint(latlng2).x;\n\t\t}\n\n\t\tthis._updateBounds();\n\t}\n});\n\nL.circle = function (latlng, options, legacyOptions) {\n\tif (typeof options === 'number') {\n\t\t// Backwards compatibility with 0.7.x factory (latlng, radius, options?)\n\t\toptions = L.extend({}, legacyOptions, {radius: options});\n\t}\n\treturn new L.Circle(latlng, options);\n};\n\n\n\n/*\n * L.SVG renders vector layers with SVG. All SVG-specific code goes here.\n */\n\nL.SVG = L.Renderer.extend({\n\n\t_initContainer: function () {\n\t\tthis._container = L.SVG.create('svg');\n\n\t\t// makes it possible to click through svg root; we'll reset it back in individual paths\n\t\tthis._container.setAttribute('pointer-events', 'none');\n\n\t\tthis._rootGroup = L.SVG.create('g');\n\t\tthis._container.appendChild(this._rootGroup);\n\t},\n\n\t_update: function () {\n\t\tif (this._map._animatingZoom && this._bounds) { return; }\n\n\t\tL.Renderer.prototype._update.call(this);\n\n\t\tvar b = this._bounds,\n\t\t    size = b.getSize(),\n\t\t    container = this._container;\n\n\t\t// set size of svg-container if changed\n\t\tif (!this._svgSize || !this._svgSize.equals(size)) {\n\t\t\tthis._svgSize = size;\n\t\t\tcontainer.setAttribute('width', size.x);\n\t\t\tcontainer.setAttribute('height', size.y);\n\t\t}\n\n\t\t// movement: update container viewBox so that we don't have to change coordinates of individual layers\n\t\tL.DomUtil.setPosition(container, b.min);\n\t\tcontainer.setAttribute('viewBox', [b.min.x, b.min.y, size.x, size.y].join(' '));\n\t},\n\n\t// methods below are called by vector layers implementations\n\n\t_initPath: function (layer) {\n\t\tvar path = layer._path = L.SVG.create('path');\n\n\t\tif (layer.options.className) {\n\t\t\tL.DomUtil.addClass(path, layer.options.className);\n\t\t}\n\n\t\tif (layer.options.interactive) {\n\t\t\tL.DomUtil.addClass(path, 'leaflet-interactive');\n\t\t}\n\n\t\tthis._updateStyle(layer);\n\t},\n\n\t_addPath: function (layer) {\n\t\tthis._rootGroup.appendChild(layer._path);\n\t\tlayer.addInteractiveTarget(layer._path);\n\t},\n\n\t_removePath: function (layer) {\n\t\tL.DomUtil.remove(layer._path);\n\t\tlayer.removeInteractiveTarget(layer._path);\n\t},\n\n\t_updatePath: function (layer) {\n\t\tlayer._project();\n\t\tlayer._update();\n\t},\n\n\t_updateStyle: function (layer) {\n\t\tvar path = layer._path,\n\t\t    options = layer.options;\n\n\t\tif (!path) { return; }\n\n\t\tif (options.stroke) {\n\t\t\tpath.setAttribute('stroke', options.color);\n\t\t\tpath.setAttribute('stroke-opacity', options.opacity);\n\t\t\tpath.setAttribute('stroke-width', options.weight);\n\t\t\tpath.setAttribute('stroke-linecap', options.lineCap);\n\t\t\tpath.setAttribute('stroke-linejoin', options.lineJoin);\n\n\t\t\tif (options.dashArray) {\n\t\t\t\tpath.setAttribute('stroke-dasharray', options.dashArray);\n\t\t\t} else {\n\t\t\t\tpath.removeAttribute('stroke-dasharray');\n\t\t\t}\n\n\t\t\tif (options.dashOffset) {\n\t\t\t\tpath.setAttribute('stroke-dashoffset', options.dashOffset);\n\t\t\t} else {\n\t\t\t\tpath.removeAttribute('stroke-dashoffset');\n\t\t\t}\n\t\t} else {\n\t\t\tpath.setAttribute('stroke', 'none');\n\t\t}\n\n\t\tif (options.fill) {\n\t\t\tpath.setAttribute('fill', options.fillColor || options.color);\n\t\t\tpath.setAttribute('fill-opacity', options.fillOpacity);\n\t\t\tpath.setAttribute('fill-rule', options.fillRule || 'evenodd');\n\t\t} else {\n\t\t\tpath.setAttribute('fill', 'none');\n\t\t}\n\n\t\tpath.setAttribute('pointer-events', options.pointerEvents || (options.interactive ? 'visiblePainted' : 'none'));\n\t},\n\n\t_updatePoly: function (layer, closed) {\n\t\tthis._setPath(layer, L.SVG.pointsToPath(layer._parts, closed));\n\t},\n\n\t_updateCircle: function (layer) {\n\t\tvar p = layer._point,\n\t\t    r = layer._radius,\n\t\t    r2 = layer._radiusY || r,\n\t\t    arc = 'a' + r + ',' + r2 + ' 0 1,0 ';\n\n\t\t// drawing a circle with two half-arcs\n\t\tvar d = layer._empty() ? 'M0 0' :\n\t\t\t\t'M' + (p.x - r) + ',' + p.y +\n\t\t\t\tarc + (r * 2) + ',0 ' +\n\t\t\t\tarc + (-r * 2) + ',0 ';\n\n\t\tthis._setPath(layer, d);\n\t},\n\n\t_setPath: function (layer, path) {\n\t\tlayer._path.setAttribute('d', path);\n\t},\n\n\t// SVG does not have the concept of zIndex so we resort to changing the DOM order of elements\n\t_bringToFront: function (layer) {\n\t\tL.DomUtil.toFront(layer._path);\n\t},\n\n\t_bringToBack: function (layer) {\n\t\tL.DomUtil.toBack(layer._path);\n\t}\n});\n\n\nL.extend(L.SVG, {\n\tcreate: function (name) {\n\t\treturn document.createElementNS('http://www.w3.org/2000/svg', name);\n\t},\n\n\t// generates SVG path string for multiple rings, with each ring turning into \"M..L..L..\" instructions\n\tpointsToPath: function (rings, closed) {\n\t\tvar str = '',\n\t\t    i, j, len, len2, points, p;\n\n\t\tfor (i = 0, len = rings.length; i < len; i++) {\n\t\t\tpoints = rings[i];\n\n\t\t\tfor (j = 0, len2 = points.length; j < len2; j++) {\n\t\t\t\tp = points[j];\n\t\t\t\tstr += (j ? 'L' : 'M') + p.x + ' ' + p.y;\n\t\t\t}\n\n\t\t\t// closes the ring for polygons; \"x\" is VML syntax\n\t\t\tstr += closed ? (L.Browser.svg ? 'z' : 'x') : '';\n\t\t}\n\n\t\t// SVG complains about empty path strings\n\t\treturn str || 'M0 0';\n\t}\n});\n\nL.Browser.svg = !!(document.createElementNS && L.SVG.create('svg').createSVGRect);\n\nL.svg = function (options) {\n\treturn L.Browser.svg || L.Browser.vml ? new L.SVG(options) : null;\n};\n\n\n\n/*\n * Vector rendering for IE7-8 through VML.\n * Thanks to Dmitry Baranovsky and his Raphael library for inspiration!\n */\n\nL.Browser.vml = !L.Browser.svg && (function () {\n\ttry {\n\t\tvar div = document.createElement('div');\n\t\tdiv.innerHTML = '<v:shape adj=\"1\"/>';\n\n\t\tvar shape = div.firstChild;\n\t\tshape.style.behavior = 'url(#default#VML)';\n\n\t\treturn shape && (typeof shape.adj === 'object');\n\n\t} catch (e) {\n\t\treturn false;\n\t}\n}());\n\n// redefine some SVG methods to handle VML syntax which is similar but with some differences\nL.SVG.include(!L.Browser.vml ? {} : {\n\n\t_initContainer: function () {\n\t\tthis._container = L.DomUtil.create('div', 'leaflet-vml-container');\n\t},\n\n\t_update: function () {\n\t\tif (this._map._animatingZoom) { return; }\n\t\tL.Renderer.prototype._update.call(this);\n\t},\n\n\t_initPath: function (layer) {\n\t\tvar container = layer._container = L.SVG.create('shape');\n\n\t\tL.DomUtil.addClass(container, 'leaflet-vml-shape ' + (this.options.className || ''));\n\n\t\tcontainer.coordsize = '1 1';\n\n\t\tlayer._path = L.SVG.create('path');\n\t\tcontainer.appendChild(layer._path);\n\n\t\tthis._updateStyle(layer);\n\t},\n\n\t_addPath: function (layer) {\n\t\tvar container = layer._container;\n\t\tthis._container.appendChild(container);\n\n\t\tif (layer.options.interactive) {\n\t\t\tlayer.addInteractiveTarget(container);\n\t\t}\n\t},\n\n\t_removePath: function (layer) {\n\t\tvar container = layer._container;\n\t\tL.DomUtil.remove(container);\n\t\tlayer.removeInteractiveTarget(container);\n\t},\n\n\t_updateStyle: function (layer) {\n\t\tvar stroke = layer._stroke,\n\t\t    fill = layer._fill,\n\t\t    options = layer.options,\n\t\t    container = layer._container;\n\n\t\tcontainer.stroked = !!options.stroke;\n\t\tcontainer.filled = !!options.fill;\n\n\t\tif (options.stroke) {\n\t\t\tif (!stroke) {\n\t\t\t\tstroke = layer._stroke = L.SVG.create('stroke');\n\t\t\t}\n\t\t\tcontainer.appendChild(stroke);\n\t\t\tstroke.weight = options.weight + 'px';\n\t\t\tstroke.color = options.color;\n\t\t\tstroke.opacity = options.opacity;\n\n\t\t\tif (options.dashArray) {\n\t\t\t\tstroke.dashStyle = L.Util.isArray(options.dashArray) ?\n\t\t\t\t    options.dashArray.join(' ') :\n\t\t\t\t    options.dashArray.replace(/( *, *)/g, ' ');\n\t\t\t} else {\n\t\t\t\tstroke.dashStyle = '';\n\t\t\t}\n\t\t\tstroke.endcap = options.lineCap.replace('butt', 'flat');\n\t\t\tstroke.joinstyle = options.lineJoin;\n\n\t\t} else if (stroke) {\n\t\t\tcontainer.removeChild(stroke);\n\t\t\tlayer._stroke = null;\n\t\t}\n\n\t\tif (options.fill) {\n\t\t\tif (!fill) {\n\t\t\t\tfill = layer._fill = L.SVG.create('fill');\n\t\t\t}\n\t\t\tcontainer.appendChild(fill);\n\t\t\tfill.color = options.fillColor || options.color;\n\t\t\tfill.opacity = options.fillOpacity;\n\n\t\t} else if (fill) {\n\t\t\tcontainer.removeChild(fill);\n\t\t\tlayer._fill = null;\n\t\t}\n\t},\n\n\t_updateCircle: function (layer) {\n\t\tvar p = layer._point.round(),\n\t\t    r = Math.round(layer._radius),\n\t\t    r2 = Math.round(layer._radiusY || r);\n\n\t\tthis._setPath(layer, layer._empty() ? 'M0 0' :\n\t\t\t\t'AL ' + p.x + ',' + p.y + ' ' + r + ',' + r2 + ' 0,' + (65535 * 360));\n\t},\n\n\t_setPath: function (layer, path) {\n\t\tlayer._path.v = path;\n\t},\n\n\t_bringToFront: function (layer) {\n\t\tL.DomUtil.toFront(layer._container);\n\t},\n\n\t_bringToBack: function (layer) {\n\t\tL.DomUtil.toBack(layer._container);\n\t}\n});\n\nif (L.Browser.vml) {\n\tL.SVG.create = (function () {\n\t\ttry {\n\t\t\tdocument.namespaces.add('lvml', 'urn:schemas-microsoft-com:vml');\n\t\t\treturn function (name) {\n\t\t\t\treturn document.createElement('<lvml:' + name + ' class=\"lvml\">');\n\t\t\t};\n\t\t} catch (e) {\n\t\t\treturn function (name) {\n\t\t\t\treturn document.createElement('<' + name + ' xmlns=\"urn:schemas-microsoft.com:vml\" class=\"lvml\">');\n\t\t\t};\n\t\t}\n\t})();\n}\n\n\n\n/*\n * L.Canvas handles Canvas vector layers rendering and mouse events handling. All Canvas-specific code goes here.\n */\n\nL.Canvas = L.Renderer.extend({\n\n\tonAdd: function () {\n\t\tL.Renderer.prototype.onAdd.call(this);\n\n\t\tthis._layers = this._layers || {};\n\n\t\t// Redraw vectors since canvas is cleared upon removal,\n\t\t// in case of removing the renderer itself from the map.\n\t\tthis._draw();\n\t},\n\n\t_initContainer: function () {\n\t\tvar container = this._container = document.createElement('canvas');\n\n\t\tL.DomEvent\n\t\t\t.on(container, 'mousemove', L.Util.throttle(this._onMouseMove, 32, this), this)\n\t\t\t.on(container, 'click dblclick mousedown mouseup contextmenu', this._onClick, this)\n\t\t\t.on(container, 'mouseout', this._handleMouseOut, this);\n\n\t\tthis._ctx = container.getContext('2d');\n\t},\n\n\t_update: function () {\n\t\tif (this._map._animatingZoom && this._bounds) { return; }\n\n\t\tthis._drawnLayers = {};\n\n\t\tL.Renderer.prototype._update.call(this);\n\n\t\tvar b = this._bounds,\n\t\t    container = this._container,\n\t\t    size = b.getSize(),\n\t\t    m = L.Browser.retina ? 2 : 1;\n\n\t\tL.DomUtil.setPosition(container, b.min);\n\n\t\t// set canvas size (also clearing it); use double size on retina\n\t\tcontainer.width = m * size.x;\n\t\tcontainer.height = m * size.y;\n\t\tcontainer.style.width = size.x + 'px';\n\t\tcontainer.style.height = size.y + 'px';\n\n\t\tif (L.Browser.retina) {\n\t\t\tthis._ctx.scale(2, 2);\n\t\t}\n\n\t\t// translate so we use the same path coordinates after canvas element moves\n\t\tthis._ctx.translate(-b.min.x, -b.min.y);\n\t},\n\n\t_initPath: function (layer) {\n\t\tthis._layers[L.stamp(layer)] = layer;\n\t},\n\n\t_addPath: L.Util.falseFn,\n\n\t_removePath: function (layer) {\n\t\tlayer._removed = true;\n\t\tthis._requestRedraw(layer);\n\t},\n\n\t_updatePath: function (layer) {\n\t\tthis._redrawBounds = layer._pxBounds;\n\t\tthis._draw(true);\n\t\tlayer._project();\n\t\tlayer._update();\n\t\tthis._draw();\n\t\tthis._redrawBounds = null;\n\t},\n\n\t_updateStyle: function (layer) {\n\t\tthis._requestRedraw(layer);\n\t},\n\n\t_requestRedraw: function (layer) {\n\t\tif (!this._map) { return; }\n\n\t\tvar padding = (layer.options.weight || 0) + 1;\n\t\tthis._redrawBounds = this._redrawBounds || new L.Bounds();\n\t\tthis._redrawBounds.extend(layer._pxBounds.min.subtract([padding, padding]));\n\t\tthis._redrawBounds.extend(layer._pxBounds.max.add([padding, padding]));\n\n\t\tthis._redrawRequest = this._redrawRequest || L.Util.requestAnimFrame(this._redraw, this);\n\t},\n\n\t_redraw: function () {\n\t\tthis._redrawRequest = null;\n\n\t\tthis._draw(true); // clear layers in redraw bounds\n\t\tthis._draw(); // draw layers\n\n\t\tthis._redrawBounds = null;\n\t},\n\n\t_draw: function (clear) {\n\t\tthis._clear = clear;\n\t\tvar layer, bounds = this._redrawBounds;\n\t\tthis._ctx.save();\n\t\tif (bounds) {\n\t\t\tthis._ctx.beginPath();\n\t\t\tthis._ctx.rect(bounds.min.x, bounds.min.y, bounds.max.x - bounds.min.x, bounds.max.y - bounds.min.y);\n\t\t\tthis._ctx.clip();\n\t\t}\n\n\t\tfor (var id in this._layers) {\n\t\t\tlayer = this._layers[id];\n\t\t\tif (!bounds || layer._pxBounds.intersects(bounds)) {\n\t\t\t\tlayer._updatePath();\n\t\t\t}\n\t\t\tif (clear && layer._removed) {\n\t\t\t\tdelete layer._removed;\n\t\t\t\tdelete this._layers[id];\n\t\t\t}\n\t\t}\n\t\tthis._ctx.restore();  // Restore state before clipping.\n\t},\n\n\t_updatePoly: function (layer, closed) {\n\n\t\tvar i, j, len2, p,\n\t\t    parts = layer._parts,\n\t\t    len = parts.length,\n\t\t    ctx = this._ctx;\n\n\t\tif (!len) { return; }\n\n\t\tthis._drawnLayers[layer._leaflet_id] = layer;\n\n\t\tctx.beginPath();\n\n\t\tfor (i = 0; i < len; i++) {\n\t\t\tfor (j = 0, len2 = parts[i].length; j < len2; j++) {\n\t\t\t\tp = parts[i][j];\n\t\t\t\tctx[j ? 'lineTo' : 'moveTo'](p.x, p.y);\n\t\t\t}\n\t\t\tif (closed) {\n\t\t\t\tctx.closePath();\n\t\t\t}\n\t\t}\n\n\t\tthis._fillStroke(ctx, layer);\n\n\t\t// TODO optimization: 1 fill/stroke for all features with equal style instead of 1 for each feature\n\t},\n\n\t_updateCircle: function (layer) {\n\n\t\tif (layer._empty()) { return; }\n\n\t\tvar p = layer._point,\n\t\t    ctx = this._ctx,\n\t\t    r = layer._radius,\n\t\t    s = (layer._radiusY || r) / r;\n\n\t\tif (s !== 1) {\n\t\t\tctx.save();\n\t\t\tctx.scale(1, s);\n\t\t}\n\n\t\tctx.beginPath();\n\t\tctx.arc(p.x, p.y / s, r, 0, Math.PI * 2, false);\n\n\t\tif (s !== 1) {\n\t\t\tctx.restore();\n\t\t}\n\n\t\tthis._fillStroke(ctx, layer);\n\t},\n\n\t_fillStroke: function (ctx, layer) {\n\t\tvar clear = this._clear,\n\t\t    options = layer.options;\n\n\t\tctx.globalCompositeOperation = clear ? 'destination-out' : 'source-over';\n\n\t\tif (options.fill) {\n\t\t\tctx.globalAlpha = clear ? 1 : options.fillOpacity;\n\t\t\tctx.fillStyle = options.fillColor || options.color;\n\t\t\tctx.fill(options.fillRule || 'evenodd');\n\t\t}\n\n\t\tif (options.stroke && options.weight !== 0) {\n\t\t\tctx.globalAlpha = clear ? 1 : options.opacity;\n\n\t\t\t// if clearing shape, do it with the previously drawn line width\n\t\t\tlayer._prevWeight = ctx.lineWidth = clear ? layer._prevWeight + 1 : options.weight;\n\n\t\t\tctx.strokeStyle = options.color;\n\t\t\tctx.lineCap = options.lineCap;\n\t\t\tctx.lineJoin = options.lineJoin;\n\t\t\tctx.stroke();\n\t\t}\n\t},\n\n\t// Canvas obviously doesn't have mouse events for individual drawn objects,\n\t// so we emulate that by calculating what's under the mouse on mousemove/click manually\n\n\t_onClick: function (e) {\n\t\tvar point = this._map.mouseEventToLayerPoint(e), layers = [];\n\n\t\tfor (var id in this._layers) {\n\t\t\tif (this._layers[id]._containsPoint(point)) {\n\t\t\t\tL.DomEvent._fakeStop(e);\n\t\t\t\tlayers.push(this._layers[id]);\n\t\t\t}\n\t\t}\n\t\tif (layers.length)  {\n\t\t\tthis._fireEvent(layers, e);\n\t\t}\n\t},\n\n\t_onMouseMove: function (e) {\n\t\tif (!this._map || this._map.dragging._draggable._moving || this._map._animatingZoom) { return; }\n\n\t\tvar point = this._map.mouseEventToLayerPoint(e);\n\t\tthis._handleMouseOut(e, point);\n\t\tthis._handleMouseHover(e, point);\n\t},\n\n\n\t_handleMouseOut: function (e, point) {\n\t\tvar layer = this._hoveredLayer;\n\t\tif (layer && (e.type === 'mouseout' || !layer._containsPoint(point))) {\n\t\t\t// if we're leaving the layer, fire mouseout\n\t\t\tL.DomUtil.removeClass(this._container, 'leaflet-interactive');\n\t\t\tthis._fireEvent([layer], e, 'mouseout');\n\t\t\tthis._hoveredLayer = null;\n\t\t}\n\t},\n\n\t_handleMouseHover: function (e, point) {\n\t\tvar id, layer;\n\t\tif (!this._hoveredLayer) {\n\t\t\tfor (id in this._drawnLayers) {\n\t\t\t\tlayer = this._drawnLayers[id];\n\t\t\t\tif (layer.options.interactive && layer._containsPoint(point)) {\n\t\t\t\t\tL.DomUtil.addClass(this._container, 'leaflet-interactive'); // change cursor\n\t\t\t\t\tthis._fireEvent([layer], e, 'mouseover');\n\t\t\t\t\tthis._hoveredLayer = layer;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (this._hoveredLayer) {\n\t\t\tthis._fireEvent([this._hoveredLayer], e);\n\t\t}\n\t},\n\n\t_fireEvent: function (layers, e, type) {\n\t\tthis._map._fireDOMEvent(e, type || e.type, layers);\n\t},\n\n\t// TODO _bringToFront & _bringToBack, pretty tricky\n\n\t_bringToFront: L.Util.falseFn,\n\t_bringToBack: L.Util.falseFn\n});\n\nL.Browser.canvas = (function () {\n\treturn !!document.createElement('canvas').getContext;\n}());\n\nL.canvas = function (options) {\n\treturn L.Browser.canvas ? new L.Canvas(options) : null;\n};\n\nL.Polyline.prototype._containsPoint = function (p, closed) {\n\tvar i, j, k, len, len2, part,\n\t    w = this._clickTolerance();\n\n\tif (!this._pxBounds.contains(p)) { return false; }\n\n\t// hit detection for polylines\n\tfor (i = 0, len = this._parts.length; i < len; i++) {\n\t\tpart = this._parts[i];\n\n\t\tfor (j = 0, len2 = part.length, k = len2 - 1; j < len2; k = j++) {\n\t\t\tif (!closed && (j === 0)) { continue; }\n\n\t\t\tif (L.LineUtil.pointToSegmentDistance(p, part[k], part[j]) <= w) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t}\n\treturn false;\n};\n\nL.Polygon.prototype._containsPoint = function (p) {\n\tvar inside = false,\n\t    part, p1, p2, i, j, k, len, len2;\n\n\tif (!this._pxBounds.contains(p)) { return false; }\n\n\t// ray casting algorithm for detecting if point is in polygon\n\tfor (i = 0, len = this._parts.length; i < len; i++) {\n\t\tpart = this._parts[i];\n\n\t\tfor (j = 0, len2 = part.length, k = len2 - 1; j < len2; k = j++) {\n\t\t\tp1 = part[j];\n\t\t\tp2 = part[k];\n\n\t\t\tif (((p1.y > p.y) !== (p2.y > p.y)) && (p.x < (p2.x - p1.x) * (p.y - p1.y) / (p2.y - p1.y) + p1.x)) {\n\t\t\t\tinside = !inside;\n\t\t\t}\n\t\t}\n\t}\n\n\t// also check if it's on polygon stroke\n\treturn inside || L.Polyline.prototype._containsPoint.call(this, p, true);\n};\n\nL.CircleMarker.prototype._containsPoint = function (p) {\n\treturn p.distanceTo(this._point) <= this._radius + this._clickTolerance();\n};\n\n\n\n/*\n * L.GeoJSON turns any GeoJSON data into a Leaflet layer.\n */\n\nL.GeoJSON = L.FeatureGroup.extend({\n\n\tinitialize: function (geojson, options) {\n\t\tL.setOptions(this, options);\n\n\t\tthis._layers = {};\n\n\t\tif (geojson) {\n\t\t\tthis.addData(geojson);\n\t\t}\n\t},\n\n\taddData: function (geojson) {\n\t\tvar features = L.Util.isArray(geojson) ? geojson : geojson.features,\n\t\t    i, len, feature;\n\n\t\tif (features) {\n\t\t\tfor (i = 0, len = features.length; i < len; i++) {\n\t\t\t\t// only add this if geometry or geometries are set and not null\n\t\t\t\tfeature = features[i];\n\t\t\t\tif (feature.geometries || feature.geometry || feature.features || feature.coordinates) {\n\t\t\t\t\tthis.addData(feature);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn this;\n\t\t}\n\n\t\tvar options = this.options;\n\n\t\tif (options.filter && !options.filter(geojson)) { return this; }\n\n\t\tvar layer = L.GeoJSON.geometryToLayer(geojson, options);\n\t\tif (!layer) {\n\t\t\treturn this;\n\t\t}\n\t\tlayer.feature = L.GeoJSON.asFeature(geojson);\n\n\t\tlayer.defaultOptions = layer.options;\n\t\tthis.resetStyle(layer);\n\n\t\tif (options.onEachFeature) {\n\t\t\toptions.onEachFeature(geojson, layer);\n\t\t}\n\n\t\treturn this.addLayer(layer);\n\t},\n\n\tresetStyle: function (layer) {\n\t\t// reset any custom styles\n\t\tlayer.options = layer.defaultOptions;\n\t\tthis._setLayerStyle(layer, this.options.style);\n\t\treturn this;\n\t},\n\n\tsetStyle: function (style) {\n\t\treturn this.eachLayer(function (layer) {\n\t\t\tthis._setLayerStyle(layer, style);\n\t\t}, this);\n\t},\n\n\t_setLayerStyle: function (layer, style) {\n\t\tif (typeof style === 'function') {\n\t\t\tstyle = style(layer.feature);\n\t\t}\n\t\tif (layer.setStyle) {\n\t\t\tlayer.setStyle(style);\n\t\t}\n\t}\n});\n\nL.extend(L.GeoJSON, {\n\tgeometryToLayer: function (geojson, options) {\n\n\t\tvar geometry = geojson.type === 'Feature' ? geojson.geometry : geojson,\n\t\t    coords = geometry ? geometry.coordinates : null,\n\t\t    layers = [],\n\t\t    pointToLayer = options && options.pointToLayer,\n\t\t    coordsToLatLng = options && options.coordsToLatLng || this.coordsToLatLng,\n\t\t    latlng, latlngs, i, len;\n\n\t\tif (!coords && !geometry) {\n\t\t\treturn null;\n\t\t}\n\n\t\tswitch (geometry.type) {\n\t\tcase 'Point':\n\t\t\tlatlng = coordsToLatLng(coords);\n\t\t\treturn pointToLayer ? pointToLayer(geojson, latlng) : new L.Marker(latlng);\n\n\t\tcase 'MultiPoint':\n\t\t\tfor (i = 0, len = coords.length; i < len; i++) {\n\t\t\t\tlatlng = coordsToLatLng(coords[i]);\n\t\t\t\tlayers.push(pointToLayer ? pointToLayer(geojson, latlng) : new L.Marker(latlng));\n\t\t\t}\n\t\t\treturn new L.FeatureGroup(layers);\n\n\t\tcase 'LineString':\n\t\tcase 'MultiLineString':\n\t\t\tlatlngs = this.coordsToLatLngs(coords, geometry.type === 'LineString' ? 0 : 1, coordsToLatLng);\n\t\t\treturn new L.Polyline(latlngs, options);\n\n\t\tcase 'Polygon':\n\t\tcase 'MultiPolygon':\n\t\t\tlatlngs = this.coordsToLatLngs(coords, geometry.type === 'Polygon' ? 1 : 2, coordsToLatLng);\n\t\t\treturn new L.Polygon(latlngs, options);\n\n\t\tcase 'GeometryCollection':\n\t\t\tfor (i = 0, len = geometry.geometries.length; i < len; i++) {\n\t\t\t\tvar layer = this.geometryToLayer({\n\t\t\t\t\tgeometry: geometry.geometries[i],\n\t\t\t\t\ttype: 'Feature',\n\t\t\t\t\tproperties: geojson.properties\n\t\t\t\t}, options);\n\n\t\t\t\tif (layer) {\n\t\t\t\t\tlayers.push(layer);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn new L.FeatureGroup(layers);\n\n\t\tdefault:\n\t\t\tthrow new Error('Invalid GeoJSON object.');\n\t\t}\n\t},\n\n\tcoordsToLatLng: function (coords) {\n\t\treturn new L.LatLng(coords[1], coords[0], coords[2]);\n\t},\n\n\tcoordsToLatLngs: function (coords, levelsDeep, coordsToLatLng) {\n\t\tvar latlngs = [];\n\n\t\tfor (var i = 0, len = coords.length, latlng; i < len; i++) {\n\t\t\tlatlng = levelsDeep ?\n\t\t\t        this.coordsToLatLngs(coords[i], levelsDeep - 1, coordsToLatLng) :\n\t\t\t        (coordsToLatLng || this.coordsToLatLng)(coords[i]);\n\n\t\t\tlatlngs.push(latlng);\n\t\t}\n\n\t\treturn latlngs;\n\t},\n\n\tlatLngToCoords: function (latlng) {\n\t\treturn latlng.alt !== undefined ?\n\t\t\t\t[latlng.lng, latlng.lat, latlng.alt] :\n\t\t\t\t[latlng.lng, latlng.lat];\n\t},\n\n\tlatLngsToCoords: function (latlngs, levelsDeep, closed) {\n\t\tvar coords = [];\n\n\t\tfor (var i = 0, len = latlngs.length; i < len; i++) {\n\t\t\tcoords.push(levelsDeep ?\n\t\t\t\tL.GeoJSON.latLngsToCoords(latlngs[i], levelsDeep - 1, closed) :\n\t\t\t\tL.GeoJSON.latLngToCoords(latlngs[i]));\n\t\t}\n\n\t\tif (!levelsDeep && closed) {\n\t\t\tcoords.push(coords[0]);\n\t\t}\n\n\t\treturn coords;\n\t},\n\n\tgetFeature: function (layer, newGeometry) {\n\t\treturn layer.feature ?\n\t\t\t\tL.extend({}, layer.feature, {geometry: newGeometry}) :\n\t\t\t\tL.GeoJSON.asFeature(newGeometry);\n\t},\n\n\tasFeature: function (geoJSON) {\n\t\tif (geoJSON.type === 'Feature') {\n\t\t\treturn geoJSON;\n\t\t}\n\n\t\treturn {\n\t\t\ttype: 'Feature',\n\t\t\tproperties: {},\n\t\t\tgeometry: geoJSON\n\t\t};\n\t}\n});\n\nvar PointToGeoJSON = {\n\ttoGeoJSON: function () {\n\t\treturn L.GeoJSON.getFeature(this, {\n\t\t\ttype: 'Point',\n\t\t\tcoordinates: L.GeoJSON.latLngToCoords(this.getLatLng())\n\t\t});\n\t}\n};\n\nL.Marker.include(PointToGeoJSON);\nL.Circle.include(PointToGeoJSON);\nL.CircleMarker.include(PointToGeoJSON);\n\nL.Polyline.prototype.toGeoJSON = function () {\n\tvar multi = !L.Polyline._flat(this._latlngs);\n\n\tvar coords = L.GeoJSON.latLngsToCoords(this._latlngs, multi ? 1 : 0);\n\n\treturn L.GeoJSON.getFeature(this, {\n\t\ttype: (multi ? 'Multi' : '') + 'LineString',\n\t\tcoordinates: coords\n\t});\n};\n\nL.Polygon.prototype.toGeoJSON = function () {\n\tvar holes = !L.Polyline._flat(this._latlngs),\n\t    multi = holes && !L.Polyline._flat(this._latlngs[0]);\n\n\tvar coords = L.GeoJSON.latLngsToCoords(this._latlngs, multi ? 2 : holes ? 1 : 0, true);\n\n\tif (!holes) {\n\t\tcoords = [coords];\n\t}\n\n\treturn L.GeoJSON.getFeature(this, {\n\t\ttype: (multi ? 'Multi' : '') + 'Polygon',\n\t\tcoordinates: coords\n\t});\n};\n\n\nL.LayerGroup.include({\n\ttoMultiPoint: function () {\n\t\tvar coords = [];\n\n\t\tthis.eachLayer(function (layer) {\n\t\t\tcoords.push(layer.toGeoJSON().geometry.coordinates);\n\t\t});\n\n\t\treturn L.GeoJSON.getFeature(this, {\n\t\t\ttype: 'MultiPoint',\n\t\t\tcoordinates: coords\n\t\t});\n\t},\n\n\ttoGeoJSON: function () {\n\n\t\tvar type = this.feature && this.feature.geometry && this.feature.geometry.type;\n\n\t\tif (type === 'MultiPoint') {\n\t\t\treturn this.toMultiPoint();\n\t\t}\n\n\t\tvar isGeometryCollection = type === 'GeometryCollection',\n\t\t    jsons = [];\n\n\t\tthis.eachLayer(function (layer) {\n\t\t\tif (layer.toGeoJSON) {\n\t\t\t\tvar json = layer.toGeoJSON();\n\t\t\t\tjsons.push(isGeometryCollection ? json.geometry : L.GeoJSON.asFeature(json));\n\t\t\t}\n\t\t});\n\n\t\tif (isGeometryCollection) {\n\t\t\treturn L.GeoJSON.getFeature(this, {\n\t\t\t\tgeometries: jsons,\n\t\t\t\ttype: 'GeometryCollection'\n\t\t\t});\n\t\t}\n\n\t\treturn {\n\t\t\ttype: 'FeatureCollection',\n\t\t\tfeatures: jsons\n\t\t};\n\t}\n});\n\nL.geoJson = function (geojson, options) {\n\treturn new L.GeoJSON(geojson, options);\n};\n\n\n\n/*\n * L.DomEvent contains functions for working with DOM events.\n * Inspired by John Resig, Dean Edwards and YUI addEvent implementations.\n */\n\nvar eventsKey = '_leaflet_events';\n\nL.DomEvent = {\n\n\ton: function (obj, types, fn, context) {\n\n\t\tif (typeof types === 'object') {\n\t\t\tfor (var type in types) {\n\t\t\t\tthis._on(obj, type, types[type], fn);\n\t\t\t}\n\t\t} else {\n\t\t\ttypes = L.Util.splitWords(types);\n\n\t\t\tfor (var i = 0, len = types.length; i < len; i++) {\n\t\t\t\tthis._on(obj, types[i], fn, context);\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t},\n\n\toff: function (obj, types, fn, context) {\n\n\t\tif (typeof types === 'object') {\n\t\t\tfor (var type in types) {\n\t\t\t\tthis._off(obj, type, types[type], fn);\n\t\t\t}\n\t\t} else {\n\t\t\ttypes = L.Util.splitWords(types);\n\n\t\t\tfor (var i = 0, len = types.length; i < len; i++) {\n\t\t\t\tthis._off(obj, types[i], fn, context);\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t},\n\n\t_on: function (obj, type, fn, context) {\n\t\tvar id = type + L.stamp(fn) + (context ? '_' + L.stamp(context) : '');\n\n\t\tif (obj[eventsKey] && obj[eventsKey][id]) { return this; }\n\n\t\tvar handler = function (e) {\n\t\t\treturn fn.call(context || obj, e || window.event);\n\t\t};\n\n\t\tvar originalHandler = handler;\n\n\t\tif (L.Browser.pointer && type.indexOf('touch') === 0) {\n\t\t\tthis.addPointerListener(obj, type, handler, id);\n\n\t\t} else if (L.Browser.touch && (type === 'dblclick') && this.addDoubleTapListener) {\n\t\t\tthis.addDoubleTapListener(obj, handler, id);\n\n\t\t} else if ('addEventListener' in obj) {\n\n\t\t\tif (type === 'mousewheel') {\n\t\t\t\tobj.addEventListener('DOMMouseScroll', handler, false);\n\t\t\t\tobj.addEventListener(type, handler, false);\n\n\t\t\t} else if ((type === 'mouseenter') || (type === 'mouseleave')) {\n\t\t\t\thandler = function (e) {\n\t\t\t\t\te = e || window.event;\n\t\t\t\t\tif (L.DomEvent._isExternalTarget(obj, e)) {\n\t\t\t\t\t\toriginalHandler(e);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tobj.addEventListener(type === 'mouseenter' ? 'mouseover' : 'mouseout', handler, false);\n\n\t\t\t} else {\n\t\t\t\tif (type === 'click' && L.Browser.android) {\n\t\t\t\t\thandler = function (e) {\n\t\t\t\t\t\treturn L.DomEvent._filterClick(e, originalHandler);\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tobj.addEventListener(type, handler, false);\n\t\t\t}\n\n\t\t} else if ('attachEvent' in obj) {\n\t\t\tobj.attachEvent('on' + type, handler);\n\t\t}\n\n\t\tobj[eventsKey] = obj[eventsKey] || {};\n\t\tobj[eventsKey][id] = handler;\n\n\t\treturn this;\n\t},\n\n\t_off: function (obj, type, fn, context) {\n\n\t\tvar id = type + L.stamp(fn) + (context ? '_' + L.stamp(context) : ''),\n\t\t    handler = obj[eventsKey] && obj[eventsKey][id];\n\n\t\tif (!handler) { return this; }\n\n\t\tif (L.Browser.pointer && type.indexOf('touch') === 0) {\n\t\t\tthis.removePointerListener(obj, type, id);\n\n\t\t} else if (L.Browser.touch && (type === 'dblclick') && this.removeDoubleTapListener) {\n\t\t\tthis.removeDoubleTapListener(obj, id);\n\n\t\t} else if ('removeEventListener' in obj) {\n\n\t\t\tif (type === 'mousewheel') {\n\t\t\t\tobj.removeEventListener('DOMMouseScroll', handler, false);\n\t\t\t\tobj.removeEventListener(type, handler, false);\n\n\t\t\t} else {\n\t\t\t\tobj.removeEventListener(\n\t\t\t\t\ttype === 'mouseenter' ? 'mouseover' :\n\t\t\t\t\ttype === 'mouseleave' ? 'mouseout' : type, handler, false);\n\t\t\t}\n\n\t\t} else if ('detachEvent' in obj) {\n\t\t\tobj.detachEvent('on' + type, handler);\n\t\t}\n\n\t\tobj[eventsKey][id] = null;\n\n\t\treturn this;\n\t},\n\n\tstopPropagation: function (e) {\n\n\t\tif (e.stopPropagation) {\n\t\t\te.stopPropagation();\n\t\t} else if (e.originalEvent) {  // In case of Leaflet event.\n\t\t\te.originalEvent._stopped = true;\n\t\t} else {\n\t\t\te.cancelBubble = true;\n\t\t}\n\t\tL.DomEvent._skipped(e);\n\n\t\treturn this;\n\t},\n\n\tdisableScrollPropagation: function (el) {\n\t\treturn L.DomEvent.on(el, 'mousewheel MozMousePixelScroll', L.DomEvent.stopPropagation);\n\t},\n\n\tdisableClickPropagation: function (el) {\n\t\tvar stop = L.DomEvent.stopPropagation;\n\n\t\tL.DomEvent.on(el, L.Draggable.START.join(' '), stop);\n\n\t\treturn L.DomEvent.on(el, {\n\t\t\tclick: L.DomEvent._fakeStop,\n\t\t\tdblclick: stop\n\t\t});\n\t},\n\n\tpreventDefault: function (e) {\n\n\t\tif (e.preventDefault) {\n\t\t\te.preventDefault();\n\t\t} else {\n\t\t\te.returnValue = false;\n\t\t}\n\t\treturn this;\n\t},\n\n\tstop: function (e) {\n\t\treturn L.DomEvent\n\t\t\t.preventDefault(e)\n\t\t\t.stopPropagation(e);\n\t},\n\n\tgetMousePosition: function (e, container) {\n\t\tif (!container) {\n\t\t\treturn new L.Point(e.clientX, e.clientY);\n\t\t}\n\n\t\tvar rect = container.getBoundingClientRect();\n\n\t\treturn new L.Point(\n\t\t\te.clientX - rect.left - container.clientLeft,\n\t\t\te.clientY - rect.top - container.clientTop);\n\t},\n\n\tgetWheelDelta: function (e) {\n\n\t\tvar delta = 0;\n\n\t\tif (e.wheelDelta) {\n\t\t\tdelta = e.wheelDelta / 120;\n\t\t}\n\t\tif (e.detail) {\n\t\t\tdelta = -e.detail / 3;\n\t\t}\n\t\treturn delta;\n\t},\n\n\t_skipEvents: {},\n\n\t_fakeStop: function (e) {\n\t\t// fakes stopPropagation by setting a special event flag, checked/reset with L.DomEvent._skipped(e)\n\t\tL.DomEvent._skipEvents[e.type] = true;\n\t},\n\n\t_skipped: function (e) {\n\t\tvar skipped = this._skipEvents[e.type];\n\t\t// reset when checking, as it's only used in map container and propagates outside of the map\n\t\tthis._skipEvents[e.type] = false;\n\t\treturn skipped;\n\t},\n\n\t// check if element really left/entered the event target (for mouseenter/mouseleave)\n\t_isExternalTarget: function (el, e) {\n\n\t\tvar related = e.relatedTarget;\n\n\t\tif (!related) { return true; }\n\n\t\ttry {\n\t\t\twhile (related && (related !== el)) {\n\t\t\t\trelated = related.parentNode;\n\t\t\t}\n\t\t} catch (err) {\n\t\t\treturn false;\n\t\t}\n\t\treturn (related !== el);\n\t},\n\n\t// this is a horrible workaround for a bug in Android where a single touch triggers two click events\n\t_filterClick: function (e, handler) {\n\t\tvar timeStamp = (e.timeStamp || e.originalEvent.timeStamp),\n\t\t    elapsed = L.DomEvent._lastClick && (timeStamp - L.DomEvent._lastClick);\n\n\t\t// are they closer together than 500ms yet more than 100ms?\n\t\t// Android typically triggers them ~300ms apart while multiple listeners\n\t\t// on the same event should be triggered far faster;\n\t\t// or check if click is simulated on the element, and if it is, reject any non-simulated events\n\n\t\tif ((elapsed && elapsed > 100 && elapsed < 500) || (e.target._simulatedClick && !e._simulated)) {\n\t\t\tL.DomEvent.stop(e);\n\t\t\treturn;\n\t\t}\n\t\tL.DomEvent._lastClick = timeStamp;\n\n\t\thandler(e);\n\t}\n};\n\nL.DomEvent.addListener = L.DomEvent.on;\nL.DomEvent.removeListener = L.DomEvent.off;\n\n\n\n/*\n * L.Draggable allows you to add dragging capabilities to any element. Supports mobile devices too.\n */\n\nL.Draggable = L.Evented.extend({\n\n\tstatics: {\n\t\tSTART: L.Browser.touch ? ['touchstart', 'mousedown'] : ['mousedown'],\n\t\tEND: {\n\t\t\tmousedown: 'mouseup',\n\t\t\ttouchstart: 'touchend',\n\t\t\tpointerdown: 'touchend',\n\t\t\tMSPointerDown: 'touchend'\n\t\t},\n\t\tMOVE: {\n\t\t\tmousedown: 'mousemove',\n\t\t\ttouchstart: 'touchmove',\n\t\t\tpointerdown: 'touchmove',\n\t\t\tMSPointerDown: 'touchmove'\n\t\t}\n\t},\n\n\tinitialize: function (element, dragStartTarget, preventOutline) {\n\t\tthis._element = element;\n\t\tthis._dragStartTarget = dragStartTarget || element;\n\t\tthis._preventOutline = preventOutline;\n\t},\n\n\tenable: function () {\n\t\tif (this._enabled) { return; }\n\n\t\tL.DomEvent.on(this._dragStartTarget, L.Draggable.START.join(' '), this._onDown, this);\n\n\t\tthis._enabled = true;\n\t},\n\n\tdisable: function () {\n\t\tif (!this._enabled) { return; }\n\n\t\tL.DomEvent.off(this._dragStartTarget, L.Draggable.START.join(' '), this._onDown, this);\n\n\t\tthis._enabled = false;\n\t\tthis._moved = false;\n\t},\n\n\t_onDown: function (e) {\n\t\tthis._moved = false;\n\n\t\tif (L.DomUtil.hasClass(this._element, 'leaflet-zoom-anim')) { return; }\n\n\t\tif (L.Draggable._dragging || e.shiftKey || ((e.which !== 1) && (e.button !== 1) && !e.touches) || !this._enabled) { return; }\n\t\tL.Draggable._dragging = true;  // Prevent dragging multiple objects at once.\n\n\t\tif (this._preventOutline) {\n\t\t\tL.DomUtil.preventOutline(this._element);\n\t\t}\n\n\t\tL.DomUtil.disableImageDrag();\n\t\tL.DomUtil.disableTextSelection();\n\n\t\tif (this._moving) { return; }\n\n\t\tthis.fire('down');\n\n\t\tvar first = e.touches ? e.touches[0] : e;\n\n\t\tthis._startPoint = new L.Point(first.clientX, first.clientY);\n\t\tthis._startPos = this._newPos = L.DomUtil.getPosition(this._element);\n\n\t\tL.DomEvent\n\t\t    .on(document, L.Draggable.MOVE[e.type], this._onMove, this)\n\t\t    .on(document, L.Draggable.END[e.type], this._onUp, this);\n\t},\n\n\t_onMove: function (e) {\n\t\tif (e.touches && e.touches.length > 1) {\n\t\t\tthis._moved = true;\n\t\t\treturn;\n\t\t}\n\n\t\tvar first = (e.touches && e.touches.length === 1 ? e.touches[0] : e),\n\t\t    newPoint = new L.Point(first.clientX, first.clientY),\n\t\t    offset = newPoint.subtract(this._startPoint);\n\n\t\tif (!offset.x && !offset.y) { return; }\n\t\tif (L.Browser.touch && Math.abs(offset.x) + Math.abs(offset.y) < 3) { return; }\n\n\t\tL.DomEvent.preventDefault(e);\n\n\t\tif (!this._moved) {\n\t\t\tthis.fire('dragstart');\n\n\t\t\tthis._moved = true;\n\t\t\tthis._startPos = L.DomUtil.getPosition(this._element).subtract(offset);\n\n\t\t\tL.DomUtil.addClass(document.body, 'leaflet-dragging');\n\n\t\t\tthis._lastTarget = e.target || e.srcElement;\n\t\t\tL.DomUtil.addClass(this._lastTarget, 'leaflet-drag-target');\n\t\t}\n\n\t\tthis._newPos = this._startPos.add(offset);\n\t\tthis._moving = true;\n\n\t\tL.Util.cancelAnimFrame(this._animRequest);\n\t\tthis._lastEvent = e;\n\t\tthis._animRequest = L.Util.requestAnimFrame(this._updatePosition, this, true);\n\t},\n\n\t_updatePosition: function () {\n\t\tvar e = {originalEvent: this._lastEvent};\n\t\tthis.fire('predrag', e);\n\t\tL.DomUtil.setPosition(this._element, this._newPos);\n\t\tthis.fire('drag', e);\n\t},\n\n\t_onUp: function () {\n\t\tL.DomUtil.removeClass(document.body, 'leaflet-dragging');\n\n\t\tif (this._lastTarget) {\n\t\t\tL.DomUtil.removeClass(this._lastTarget, 'leaflet-drag-target');\n\t\t\tthis._lastTarget = null;\n\t\t}\n\n\t\tfor (var i in L.Draggable.MOVE) {\n\t\t\tL.DomEvent\n\t\t\t    .off(document, L.Draggable.MOVE[i], this._onMove, this)\n\t\t\t    .off(document, L.Draggable.END[i], this._onUp, this);\n\t\t}\n\n\t\tL.DomUtil.enableImageDrag();\n\t\tL.DomUtil.enableTextSelection();\n\n\t\tif (this._moved && this._moving) {\n\t\t\t// ensure drag is not fired after dragend\n\t\t\tL.Util.cancelAnimFrame(this._animRequest);\n\n\t\t\tthis.fire('dragend', {\n\t\t\t\tdistance: this._newPos.distanceTo(this._startPos)\n\t\t\t});\n\t\t}\n\n\t\tthis._moving = false;\n\t\tL.Draggable._dragging = false;\n\t}\n});\n\n\n\n/*\n\tL.Handler is a base class for handler classes that are used internally to inject\n\tinteraction features like dragging to classes like Map and Marker.\n*/\n\nL.Handler = L.Class.extend({\n\tinitialize: function (map) {\n\t\tthis._map = map;\n\t},\n\n\tenable: function () {\n\t\tif (this._enabled) { return; }\n\n\t\tthis._enabled = true;\n\t\tthis.addHooks();\n\t},\n\n\tdisable: function () {\n\t\tif (!this._enabled) { return; }\n\n\t\tthis._enabled = false;\n\t\tthis.removeHooks();\n\t},\n\n\tenabled: function () {\n\t\treturn !!this._enabled;\n\t}\n});\n\n\n\n/*\n * L.Handler.MapDrag is used to make the map draggable (with panning inertia), enabled by default.\n */\n\nL.Map.mergeOptions({\n\tdragging: true,\n\n\tinertia: !L.Browser.android23,\n\tinertiaDeceleration: 3400, // px/s^2\n\tinertiaMaxSpeed: Infinity, // px/s\n\teaseLinearity: 0.2,\n\n\t// TODO refactor, move to CRS\n\tworldCopyJump: false\n});\n\nL.Map.Drag = L.Handler.extend({\n\taddHooks: function () {\n\t\tif (!this._draggable) {\n\t\t\tvar map = this._map;\n\n\t\t\tthis._draggable = new L.Draggable(map._mapPane, map._container);\n\n\t\t\tthis._draggable.on({\n\t\t\t\tdown: this._onDown,\n\t\t\t\tdragstart: this._onDragStart,\n\t\t\t\tdrag: this._onDrag,\n\t\t\t\tdragend: this._onDragEnd\n\t\t\t}, this);\n\n\t\t\tthis._draggable.on('predrag', this._onPreDragLimit, this);\n\t\t\tif (map.options.worldCopyJump) {\n\t\t\t\tthis._draggable.on('predrag', this._onPreDragWrap, this);\n\t\t\t\tmap.on('zoomend', this._onZoomEnd, this);\n\n\t\t\t\tmap.whenReady(this._onZoomEnd, this);\n\t\t\t}\n\t\t}\n\t\tL.DomUtil.addClass(this._map._container, 'leaflet-grab');\n\t\tthis._draggable.enable();\n\t},\n\n\tremoveHooks: function () {\n\t\tL.DomUtil.removeClass(this._map._container, 'leaflet-grab');\n\t\tthis._draggable.disable();\n\t},\n\n\tmoved: function () {\n\t\treturn this._draggable && this._draggable._moved;\n\t},\n\n\t_onDown: function () {\n\t\tthis._map.stop();\n\t},\n\n\t_onDragStart: function () {\n\t\tvar map = this._map;\n\n\t\tif (this._map.options.maxBounds && this._map.options.maxBoundsViscosity) {\n\t\t\tvar bounds = L.latLngBounds(this._map.options.maxBounds);\n\n\t\t\tthis._offsetLimit = L.bounds(\n\t\t\t\tthis._map.latLngToContainerPoint(bounds.getNorthWest()).multiplyBy(-1),\n\t\t\t\tthis._map.latLngToContainerPoint(bounds.getSouthEast()).multiplyBy(-1)\n\t\t\t\t\t.add(this._map.getSize()));\n\n\t\t\tthis._viscosity = Math.min(1.0, Math.max(0.0, this._map.options.maxBoundsViscosity));\n\t\t} else {\n\t\t\tthis._offsetLimit = null;\n\t\t}\n\n\t\tmap\n\t\t    .fire('movestart')\n\t\t    .fire('dragstart');\n\n\t\tif (map.options.inertia) {\n\t\t\tthis._positions = [];\n\t\t\tthis._times = [];\n\t\t}\n\t},\n\n\t_onDrag: function (e) {\n\t\tif (this._map.options.inertia) {\n\t\t\tvar time = this._lastTime = +new Date(),\n\t\t\t    pos = this._lastPos = this._draggable._absPos || this._draggable._newPos;\n\n\t\t\tthis._positions.push(pos);\n\t\t\tthis._times.push(time);\n\n\t\t\tif (time - this._times[0] > 50) {\n\t\t\t\tthis._positions.shift();\n\t\t\t\tthis._times.shift();\n\t\t\t}\n\t\t}\n\n\t\tthis._map\n\t\t    .fire('move', e)\n\t\t    .fire('drag', e);\n\t},\n\n\t_onZoomEnd: function () {\n\t\tvar pxCenter = this._map.getSize().divideBy(2),\n\t\t    pxWorldCenter = this._map.latLngToLayerPoint([0, 0]);\n\n\t\tthis._initialWorldOffset = pxWorldCenter.subtract(pxCenter).x;\n\t\tthis._worldWidth = this._map.getPixelWorldBounds().getSize().x;\n\t},\n\n\t_viscousLimit: function (value, threshold) {\n\t\treturn value - (value - threshold) * this._viscosity;\n\t},\n\n\t_onPreDragLimit: function () {\n\t\tif (!this._viscosity || !this._offsetLimit) { return; }\n\n\t\tvar offset = this._draggable._newPos.subtract(this._draggable._startPos);\n\n\t\tvar limit = this._offsetLimit;\n\t\tif (offset.x < limit.min.x) { offset.x = this._viscousLimit(offset.x, limit.min.x); }\n\t\tif (offset.y < limit.min.y) { offset.y = this._viscousLimit(offset.y, limit.min.y); }\n\t\tif (offset.x > limit.max.x) { offset.x = this._viscousLimit(offset.x, limit.max.x); }\n\t\tif (offset.y > limit.max.y) { offset.y = this._viscousLimit(offset.y, limit.max.y); }\n\n\t\tthis._draggable._newPos = this._draggable._startPos.add(offset);\n\t},\n\n\t_onPreDragWrap: function () {\n\t\t// TODO refactor to be able to adjust map pane position after zoom\n\t\tvar worldWidth = this._worldWidth,\n\t\t    halfWidth = Math.round(worldWidth / 2),\n\t\t    dx = this._initialWorldOffset,\n\t\t    x = this._draggable._newPos.x,\n\t\t    newX1 = (x - halfWidth + dx) % worldWidth + halfWidth - dx,\n\t\t    newX2 = (x + halfWidth + dx) % worldWidth - halfWidth - dx,\n\t\t    newX = Math.abs(newX1 + dx) < Math.abs(newX2 + dx) ? newX1 : newX2;\n\n\t\tthis._draggable._absPos = this._draggable._newPos.clone();\n\t\tthis._draggable._newPos.x = newX;\n\t},\n\n\t_onDragEnd: function (e) {\n\t\tvar map = this._map,\n\t\t    options = map.options,\n\n\t\t    noInertia = !options.inertia || this._times.length < 2;\n\n\t\tmap.fire('dragend', e);\n\n\t\tif (noInertia) {\n\t\t\tmap.fire('moveend');\n\n\t\t} else {\n\n\t\t\tvar direction = this._lastPos.subtract(this._positions[0]),\n\t\t\t    duration = (this._lastTime - this._times[0]) / 1000,\n\t\t\t    ease = options.easeLinearity,\n\n\t\t\t    speedVector = direction.multiplyBy(ease / duration),\n\t\t\t    speed = speedVector.distanceTo([0, 0]),\n\n\t\t\t    limitedSpeed = Math.min(options.inertiaMaxSpeed, speed),\n\t\t\t    limitedSpeedVector = speedVector.multiplyBy(limitedSpeed / speed),\n\n\t\t\t    decelerationDuration = limitedSpeed / (options.inertiaDeceleration * ease),\n\t\t\t    offset = limitedSpeedVector.multiplyBy(-decelerationDuration / 2).round();\n\n\t\t\tif (!offset.x && !offset.y) {\n\t\t\t\tmap.fire('moveend');\n\n\t\t\t} else {\n\t\t\t\toffset = map._limitOffset(offset, map.options.maxBounds);\n\n\t\t\t\tL.Util.requestAnimFrame(function () {\n\t\t\t\t\tmap.panBy(offset, {\n\t\t\t\t\t\tduration: decelerationDuration,\n\t\t\t\t\t\teaseLinearity: ease,\n\t\t\t\t\t\tnoMoveStart: true,\n\t\t\t\t\t\tanimate: true\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n});\n\nL.Map.addInitHook('addHandler', 'dragging', L.Map.Drag);\n\n\n\n/*\n * L.Handler.DoubleClickZoom is used to handle double-click zoom on the map, enabled by default.\n */\n\nL.Map.mergeOptions({\n\tdoubleClickZoom: true\n});\n\nL.Map.DoubleClickZoom = L.Handler.extend({\n\taddHooks: function () {\n\t\tthis._map.on('dblclick', this._onDoubleClick, this);\n\t},\n\n\tremoveHooks: function () {\n\t\tthis._map.off('dblclick', this._onDoubleClick, this);\n\t},\n\n\t_onDoubleClick: function (e) {\n\t\tvar map = this._map,\n\t\t    oldZoom = map.getZoom(),\n\t\t    zoom = e.originalEvent.shiftKey ? Math.ceil(oldZoom) - 1 : Math.floor(oldZoom) + 1;\n\n\t\tif (map.options.doubleClickZoom === 'center') {\n\t\t\tmap.setZoom(zoom);\n\t\t} else {\n\t\t\tmap.setZoomAround(e.containerPoint, zoom);\n\t\t}\n\t}\n});\n\nL.Map.addInitHook('addHandler', 'doubleClickZoom', L.Map.DoubleClickZoom);\n\n\n\n/*\n * L.Handler.ScrollWheelZoom is used by L.Map to enable mouse scroll wheel zoom on the map.\n */\n\nL.Map.mergeOptions({\n\tscrollWheelZoom: true,\n\twheelDebounceTime: 40\n});\n\nL.Map.ScrollWheelZoom = L.Handler.extend({\n\taddHooks: function () {\n\t\tL.DomEvent.on(this._map._container, {\n\t\t\tmousewheel: this._onWheelScroll,\n\t\t\tMozMousePixelScroll: L.DomEvent.preventDefault\n\t\t}, this);\n\n\t\tthis._delta = 0;\n\t},\n\n\tremoveHooks: function () {\n\t\tL.DomEvent.off(this._map._container, {\n\t\t\tmousewheel: this._onWheelScroll,\n\t\t\tMozMousePixelScroll: L.DomEvent.preventDefault\n\t\t}, this);\n\t},\n\n\t_onWheelScroll: function (e) {\n\t\tvar delta = L.DomEvent.getWheelDelta(e);\n\t\tvar debounce = this._map.options.wheelDebounceTime;\n\n\t\tthis._delta += delta;\n\t\tthis._lastMousePos = this._map.mouseEventToContainerPoint(e);\n\n\t\tif (!this._startTime) {\n\t\t\tthis._startTime = +new Date();\n\t\t}\n\n\t\tvar left = Math.max(debounce - (+new Date() - this._startTime), 0);\n\n\t\tclearTimeout(this._timer);\n\t\tthis._timer = setTimeout(L.bind(this._performZoom, this), left);\n\n\t\tL.DomEvent.stop(e);\n\t},\n\n\t_performZoom: function () {\n\t\tvar map = this._map,\n\t\t    delta = this._delta,\n\t\t    zoom = map.getZoom();\n\n\t\tmap.stop(); // stop panning and fly animations if any\n\n\t\tdelta = delta > 0 ? Math.ceil(delta) : Math.floor(delta);\n\t\tdelta = Math.max(Math.min(delta, 4), -4);\n\t\tdelta = map._limitZoom(zoom + delta) - zoom;\n\n\t\tthis._delta = 0;\n\t\tthis._startTime = null;\n\n\t\tif (!delta) { return; }\n\n\t\tif (map.options.scrollWheelZoom === 'center') {\n\t\t\tmap.setZoom(zoom + delta);\n\t\t} else {\n\t\t\tmap.setZoomAround(this._lastMousePos, zoom + delta);\n\t\t}\n\t}\n});\n\nL.Map.addInitHook('addHandler', 'scrollWheelZoom', L.Map.ScrollWheelZoom);\n\n\n\n/*\n * Extends the event handling code with double tap support for mobile browsers.\n */\n\nL.extend(L.DomEvent, {\n\n\t_touchstart: L.Browser.msPointer ? 'MSPointerDown' : L.Browser.pointer ? 'pointerdown' : 'touchstart',\n\t_touchend: L.Browser.msPointer ? 'MSPointerUp' : L.Browser.pointer ? 'pointerup' : 'touchend',\n\n\t// inspired by Zepto touch code by Thomas Fuchs\n\taddDoubleTapListener: function (obj, handler, id) {\n\t\tvar last, touch,\n\t\t    doubleTap = false,\n\t\t    delay = 250;\n\n\t\tfunction onTouchStart(e) {\n\t\t\tvar count;\n\n\t\t\tif (L.Browser.pointer) {\n\t\t\t\tcount = L.DomEvent._pointersCount;\n\t\t\t} else {\n\t\t\t\tcount = e.touches.length;\n\t\t\t}\n\n\t\t\tif (count > 1) { return; }\n\n\t\t\tvar now = Date.now(),\n\t\t\t    delta = now - (last || now);\n\n\t\t\ttouch = e.touches ? e.touches[0] : e;\n\t\t\tdoubleTap = (delta > 0 && delta <= delay);\n\t\t\tlast = now;\n\t\t}\n\n\t\tfunction onTouchEnd() {\n\t\t\tif (doubleTap && !touch.cancelBubble) {\n\t\t\t\tif (L.Browser.pointer) {\n\t\t\t\t\t// work around .type being readonly with MSPointer* events\n\t\t\t\t\tvar newTouch = {},\n\t\t\t\t\t    prop, i;\n\n\t\t\t\t\tfor (i in touch) {\n\t\t\t\t\t\tprop = touch[i];\n\t\t\t\t\t\tnewTouch[i] = prop && prop.bind ? prop.bind(touch) : prop;\n\t\t\t\t\t}\n\t\t\t\t\ttouch = newTouch;\n\t\t\t\t}\n\t\t\t\ttouch.type = 'dblclick';\n\t\t\t\thandler(touch);\n\t\t\t\tlast = null;\n\t\t\t}\n\t\t}\n\n\t\tvar pre = '_leaflet_',\n\t\t    touchstart = this._touchstart,\n\t\t    touchend = this._touchend;\n\n\t\tobj[pre + touchstart + id] = onTouchStart;\n\t\tobj[pre + touchend + id] = onTouchEnd;\n\n\t\tobj.addEventListener(touchstart, onTouchStart, false);\n\t\tobj.addEventListener(touchend, onTouchEnd, false);\n\t\treturn this;\n\t},\n\n\tremoveDoubleTapListener: function (obj, id) {\n\t\tvar pre = '_leaflet_',\n\t\t    touchend = obj[pre + this._touchend + id];\n\n\t\tobj.removeEventListener(this._touchstart, obj[pre + this._touchstart + id], false);\n\t\tobj.removeEventListener(this._touchend, touchend, false);\n\n\t\treturn this;\n\t}\n});\n\n\n\n/*\n * Extends L.DomEvent to provide touch support for Internet Explorer and Windows-based devices.\n */\n\nL.extend(L.DomEvent, {\n\n\tPOINTER_DOWN:   L.Browser.msPointer ? 'MSPointerDown'   : 'pointerdown',\n\tPOINTER_MOVE:   L.Browser.msPointer ? 'MSPointerMove'   : 'pointermove',\n\tPOINTER_UP:     L.Browser.msPointer ? 'MSPointerUp'     : 'pointerup',\n\tPOINTER_CANCEL: L.Browser.msPointer ? 'MSPointerCancel' : 'pointercancel',\n\n\t_pointers: {},\n\t_pointersCount: 0,\n\n\t// Provides a touch events wrapper for (ms)pointer events.\n\t// ref http://www.w3.org/TR/pointerevents/ https://www.w3.org/Bugs/Public/show_bug.cgi?id=22890\n\n\taddPointerListener: function (obj, type, handler, id) {\n\n\t\tif (type === 'touchstart') {\n\t\t\tthis._addPointerStart(obj, handler, id);\n\n\t\t} else if (type === 'touchmove') {\n\t\t\tthis._addPointerMove(obj, handler, id);\n\n\t\t} else if (type === 'touchend') {\n\t\t\tthis._addPointerEnd(obj, handler, id);\n\t\t}\n\n\t\treturn this;\n\t},\n\n\tremovePointerListener: function (obj, type, id) {\n\t\tvar handler = obj['_leaflet_' + type + id];\n\n\t\tif (type === 'touchstart') {\n\t\t\tobj.removeEventListener(this.POINTER_DOWN, handler, false);\n\n\t\t} else if (type === 'touchmove') {\n\t\t\tobj.removeEventListener(this.POINTER_MOVE, handler, false);\n\n\t\t} else if (type === 'touchend') {\n\t\t\tobj.removeEventListener(this.POINTER_UP, handler, false);\n\t\t\tobj.removeEventListener(this.POINTER_CANCEL, handler, false);\n\t\t}\n\n\t\treturn this;\n\t},\n\n\t_addPointerStart: function (obj, handler, id) {\n\t\tvar onDown = L.bind(function (e) {\n\t\t\tif (e.pointerType !== 'mouse' && e.pointerType !== e.MSPOINTER_TYPE_MOUSE) {\n\t\t\t\tL.DomEvent.preventDefault(e);\n\t\t\t}\n\n\t\t\tthis._handlePointer(e, handler);\n\t\t}, this);\n\n\t\tobj['_leaflet_touchstart' + id] = onDown;\n\t\tobj.addEventListener(this.POINTER_DOWN, onDown, false);\n\n\t\t// need to keep track of what pointers and how many are active to provide e.touches emulation\n\t\tif (!this._pointerDocListener) {\n\t\t\tvar pointerUp = L.bind(this._globalPointerUp, this);\n\n\t\t\t// we listen documentElement as any drags that end by moving the touch off the screen get fired there\n\t\t\tdocument.documentElement.addEventListener(this.POINTER_DOWN, L.bind(this._globalPointerDown, this), true);\n\t\t\tdocument.documentElement.addEventListener(this.POINTER_MOVE, L.bind(this._globalPointerMove, this), true);\n\t\t\tdocument.documentElement.addEventListener(this.POINTER_UP, pointerUp, true);\n\t\t\tdocument.documentElement.addEventListener(this.POINTER_CANCEL, pointerUp, true);\n\n\t\t\tthis._pointerDocListener = true;\n\t\t}\n\t},\n\n\t_globalPointerDown: function (e) {\n\t\tthis._pointers[e.pointerId] = e;\n\t\tthis._pointersCount++;\n\t},\n\n\t_globalPointerMove: function (e) {\n\t\tif (this._pointers[e.pointerId]) {\n\t\t\tthis._pointers[e.pointerId] = e;\n\t\t}\n\t},\n\n\t_globalPointerUp: function (e) {\n\t\tdelete this._pointers[e.pointerId];\n\t\tthis._pointersCount--;\n\t},\n\n\t_handlePointer: function (e, handler) {\n\t\te.touches = [];\n\t\tfor (var i in this._pointers) {\n\t\t\te.touches.push(this._pointers[i]);\n\t\t}\n\t\te.changedTouches = [e];\n\n\t\thandler(e);\n\t},\n\n\t_addPointerMove: function (obj, handler, id) {\n\t\tvar onMove = L.bind(function (e) {\n\t\t\t// don't fire touch moves when mouse isn't down\n\t\t\tif ((e.pointerType === e.MSPOINTER_TYPE_MOUSE || e.pointerType === 'mouse') && e.buttons === 0) { return; }\n\n\t\t\tthis._handlePointer(e, handler);\n\t\t}, this);\n\n\t\tobj['_leaflet_touchmove' + id] = onMove;\n\t\tobj.addEventListener(this.POINTER_MOVE, onMove, false);\n\t},\n\n\t_addPointerEnd: function (obj, handler, id) {\n\t\tvar onUp = L.bind(function (e) {\n\t\t\tthis._handlePointer(e, handler);\n\t\t}, this);\n\n\t\tobj['_leaflet_touchend' + id] = onUp;\n\t\tobj.addEventListener(this.POINTER_UP, onUp, false);\n\t\tobj.addEventListener(this.POINTER_CANCEL, onUp, false);\n\t}\n});\n\n\n\n/*\n * L.Handler.TouchZoom is used by L.Map to add pinch zoom on supported mobile browsers.\n */\n\nL.Map.mergeOptions({\n\ttouchZoom: L.Browser.touch && !L.Browser.android23,\n\tbounceAtZoomLimits: true\n});\n\nL.Map.TouchZoom = L.Handler.extend({\n\taddHooks: function () {\n\t\tL.DomEvent.on(this._map._container, 'touchstart', this._onTouchStart, this);\n\t},\n\n\tremoveHooks: function () {\n\t\tL.DomEvent.off(this._map._container, 'touchstart', this._onTouchStart, this);\n\t},\n\n\t_onTouchStart: function (e) {\n\t\tvar map = this._map;\n\n\t\tif (!e.touches || e.touches.length !== 2 || map._animatingZoom || this._zooming) { return; }\n\n\t\tvar p1 = map.mouseEventToContainerPoint(e.touches[0]),\n\t\t    p2 = map.mouseEventToContainerPoint(e.touches[1]);\n\n\t\tthis._centerPoint = map.getSize()._divideBy(2);\n\t\tthis._startLatLng = map.containerPointToLatLng(this._centerPoint);\n\t\tif (map.options.touchZoom !== 'center') {\n\t\t\tthis._pinchStartLatLng = map.containerPointToLatLng(p1.add(p2)._divideBy(2));\n\t\t}\n\n\t\tthis._startDist = p1.distanceTo(p2);\n\t\tthis._startZoom = map.getZoom();\n\n\t\tthis._moved = false;\n\t\tthis._zooming = true;\n\n\t\tmap.stop();\n\n\t\tL.DomEvent\n\t\t    .on(document, 'touchmove', this._onTouchMove, this)\n\t\t    .on(document, 'touchend', this._onTouchEnd, this);\n\n\t\tL.DomEvent.preventDefault(e);\n\t},\n\n\t_onTouchMove: function (e) {\n\t\tif (!e.touches || e.touches.length !== 2 || !this._zooming) { return; }\n\n\t\tvar map = this._map,\n\t\t    p1 = map.mouseEventToContainerPoint(e.touches[0]),\n\t\t    p2 = map.mouseEventToContainerPoint(e.touches[1]),\n\t\t    scale = p1.distanceTo(p2) / this._startDist;\n\n\n\t\tthis._zoom = map.getScaleZoom(scale, this._startZoom);\n\n\t\tif (map.options.touchZoom === 'center') {\n\t\t\tthis._center = this._startLatLng;\n\t\t\tif (scale === 1) { return; }\n\t\t} else {\n\t\t\t// Get delta from pinch to center, so centerLatLng is delta applied to initial pinchLatLng\n\t\t\tvar delta = p1._add(p2)._divideBy(2)._subtract(this._centerPoint);\n\t\t\tif (scale === 1 && delta.x === 0 && delta.y === 0) { return; }\n\t\t\tthis._center = map.unproject(map.project(this._pinchStartLatLng).subtract(delta));\n\t\t}\n\n\t\tif (!map.options.bounceAtZoomLimits) {\n\t\t\tif ((this._zoom <= map.getMinZoom() && scale < 1) ||\n\t\t        (this._zoom >= map.getMaxZoom() && scale > 1)) { return; }\n\t\t}\n\n\t\tif (!this._moved) {\n\t\t\tmap._moveStart(true);\n\t\t\tthis._moved = true;\n\t\t}\n\n\t\tL.Util.cancelAnimFrame(this._animRequest);\n\n\t\tvar moveFn = L.bind(map._move, map, this._center, this._zoom, {pinch: true, round: false});\n\t\tthis._animRequest = L.Util.requestAnimFrame(moveFn, this, true);\n\n\t\tL.DomEvent.preventDefault(e);\n\t},\n\n\t_onTouchEnd: function () {\n\t\tif (!this._moved || !this._zooming) {\n\t\t\tthis._zooming = false;\n\t\t\treturn;\n\t\t}\n\n\t\tthis._zooming = false;\n\t\tL.Util.cancelAnimFrame(this._animRequest);\n\n\t\tL.DomEvent\n\t\t    .off(document, 'touchmove', this._onTouchMove)\n\t\t    .off(document, 'touchend', this._onTouchEnd);\n\n\t\tvar zoom = this._zoom;\n\t\tzoom = this._map._limitZoom(zoom - this._startZoom > 0 ? Math.ceil(zoom) : Math.floor(zoom));\n\n\n\t\tthis._map._animateZoom(this._center, zoom, true, true);\n\t}\n});\n\nL.Map.addInitHook('addHandler', 'touchZoom', L.Map.TouchZoom);\n\n\n\n/*\n * L.Map.Tap is used to enable mobile hacks like quick taps and long hold.\n */\n\nL.Map.mergeOptions({\n\ttap: true,\n\ttapTolerance: 15\n});\n\nL.Map.Tap = L.Handler.extend({\n\taddHooks: function () {\n\t\tL.DomEvent.on(this._map._container, 'touchstart', this._onDown, this);\n\t},\n\n\tremoveHooks: function () {\n\t\tL.DomEvent.off(this._map._container, 'touchstart', this._onDown, this);\n\t},\n\n\t_onDown: function (e) {\n\t\tif (!e.touches) { return; }\n\n\t\tL.DomEvent.preventDefault(e);\n\n\t\tthis._fireClick = true;\n\n\t\t// don't simulate click or track longpress if more than 1 touch\n\t\tif (e.touches.length > 1) {\n\t\t\tthis._fireClick = false;\n\t\t\tclearTimeout(this._holdTimeout);\n\t\t\treturn;\n\t\t}\n\n\t\tvar first = e.touches[0],\n\t\t    el = first.target;\n\n\t\tthis._startPos = this._newPos = new L.Point(first.clientX, first.clientY);\n\n\t\t// if touching a link, highlight it\n\t\tif (el.tagName && el.tagName.toLowerCase() === 'a') {\n\t\t\tL.DomUtil.addClass(el, 'leaflet-active');\n\t\t}\n\n\t\t// simulate long hold but setting a timeout\n\t\tthis._holdTimeout = setTimeout(L.bind(function () {\n\t\t\tif (this._isTapValid()) {\n\t\t\t\tthis._fireClick = false;\n\t\t\t\tthis._onUp();\n\t\t\t\tthis._simulateEvent('contextmenu', first);\n\t\t\t}\n\t\t}, this), 1000);\n\n\t\tthis._simulateEvent('mousedown', first);\n\n\t\tL.DomEvent.on(document, {\n\t\t\ttouchmove: this._onMove,\n\t\t\ttouchend: this._onUp\n\t\t}, this);\n\t},\n\n\t_onUp: function (e) {\n\t\tclearTimeout(this._holdTimeout);\n\n\t\tL.DomEvent.off(document, {\n\t\t\ttouchmove: this._onMove,\n\t\t\ttouchend: this._onUp\n\t\t}, this);\n\n\t\tif (this._fireClick && e && e.changedTouches) {\n\n\t\t\tvar first = e.changedTouches[0],\n\t\t\t    el = first.target;\n\n\t\t\tif (el && el.tagName && el.tagName.toLowerCase() === 'a') {\n\t\t\t\tL.DomUtil.removeClass(el, 'leaflet-active');\n\t\t\t}\n\n\t\t\tthis._simulateEvent('mouseup', first);\n\n\t\t\t// simulate click if the touch didn't move too much\n\t\t\tif (this._isTapValid()) {\n\t\t\t\tthis._simulateEvent('click', first);\n\t\t\t}\n\t\t}\n\t},\n\n\t_isTapValid: function () {\n\t\treturn this._newPos.distanceTo(this._startPos) <= this._map.options.tapTolerance;\n\t},\n\n\t_onMove: function (e) {\n\t\tvar first = e.touches[0];\n\t\tthis._newPos = new L.Point(first.clientX, first.clientY);\n\t\tthis._simulateEvent('mousemove', first);\n\t},\n\n\t_simulateEvent: function (type, e) {\n\t\tvar simulatedEvent = document.createEvent('MouseEvents');\n\n\t\tsimulatedEvent._simulated = true;\n\t\te.target._simulatedClick = true;\n\n\t\tsimulatedEvent.initMouseEvent(\n\t\t        type, true, true, window, 1,\n\t\t        e.screenX, e.screenY,\n\t\t        e.clientX, e.clientY,\n\t\t        false, false, false, false, 0, null);\n\n\t\te.target.dispatchEvent(simulatedEvent);\n\t}\n});\n\nif (L.Browser.touch && !L.Browser.pointer) {\n\tL.Map.addInitHook('addHandler', 'tap', L.Map.Tap);\n}\n\n\n\n/*\n * L.Handler.ShiftDragZoom is used to add shift-drag zoom interaction to the map\n  * (zoom to a selected bounding box), enabled by default.\n */\n\nL.Map.mergeOptions({\n\tboxZoom: true\n});\n\nL.Map.BoxZoom = L.Handler.extend({\n\tinitialize: function (map) {\n\t\tthis._map = map;\n\t\tthis._container = map._container;\n\t\tthis._pane = map._panes.overlayPane;\n\t},\n\n\taddHooks: function () {\n\t\tL.DomEvent.on(this._container, 'mousedown', this._onMouseDown, this);\n\t},\n\n\tremoveHooks: function () {\n\t\tL.DomEvent.off(this._container, 'mousedown', this._onMouseDown, this);\n\t},\n\n\tmoved: function () {\n\t\treturn this._moved;\n\t},\n\n\t_resetState: function () {\n\t\tthis._moved = false;\n\t},\n\n\t_onMouseDown: function (e) {\n\t\tif (!e.shiftKey || ((e.which !== 1) && (e.button !== 1))) { return false; }\n\n\t\tthis._resetState();\n\n\t\tL.DomUtil.disableTextSelection();\n\t\tL.DomUtil.disableImageDrag();\n\n\t\tthis._startPoint = this._map.mouseEventToContainerPoint(e);\n\n\t\tL.DomEvent.on(document, {\n\t\t\tcontextmenu: L.DomEvent.stop,\n\t\t\tmousemove: this._onMouseMove,\n\t\t\tmouseup: this._onMouseUp,\n\t\t\tkeydown: this._onKeyDown\n\t\t}, this);\n\t},\n\n\t_onMouseMove: function (e) {\n\t\tif (!this._moved) {\n\t\t\tthis._moved = true;\n\n\t\t\tthis._box = L.DomUtil.create('div', 'leaflet-zoom-box', this._container);\n\t\t\tL.DomUtil.addClass(this._container, 'leaflet-crosshair');\n\n\t\t\tthis._map.fire('boxzoomstart');\n\t\t}\n\n\t\tthis._point = this._map.mouseEventToContainerPoint(e);\n\n\t\tvar bounds = new L.Bounds(this._point, this._startPoint),\n\t\t    size = bounds.getSize();\n\n\t\tL.DomUtil.setPosition(this._box, bounds.min);\n\n\t\tthis._box.style.width  = size.x + 'px';\n\t\tthis._box.style.height = size.y + 'px';\n\t},\n\n\t_finish: function () {\n\t\tif (this._moved) {\n\t\t\tL.DomUtil.remove(this._box);\n\t\t\tL.DomUtil.removeClass(this._container, 'leaflet-crosshair');\n\t\t}\n\n\t\tL.DomUtil.enableTextSelection();\n\t\tL.DomUtil.enableImageDrag();\n\n\t\tL.DomEvent.off(document, {\n\t\t\tcontextmenu: L.DomEvent.stop,\n\t\t\tmousemove: this._onMouseMove,\n\t\t\tmouseup: this._onMouseUp,\n\t\t\tkeydown: this._onKeyDown\n\t\t}, this);\n\t},\n\n\t_onMouseUp: function (e) {\n\t\tif ((e.which !== 1) && (e.button !== 1)) { return; }\n\n\t\tthis._finish();\n\n\t\tif (!this._moved) { return; }\n\t\t// Postpone to next JS tick so internal click event handling\n\t\t// still see it as \"moved\".\n\t\tsetTimeout(L.bind(this._resetState, this), 0);\n\n\t\tvar bounds = new L.LatLngBounds(\n\t\t        this._map.containerPointToLatLng(this._startPoint),\n\t\t        this._map.containerPointToLatLng(this._point));\n\n\t\tthis._map\n\t\t\t.fitBounds(bounds)\n\t\t\t.fire('boxzoomend', {boxZoomBounds: bounds});\n\t},\n\n\t_onKeyDown: function (e) {\n\t\tif (e.keyCode === 27) {\n\t\t\tthis._finish();\n\t\t}\n\t}\n});\n\nL.Map.addInitHook('addHandler', 'boxZoom', L.Map.BoxZoom);\n\n\n\n/*\n * L.Map.Keyboard is handling keyboard interaction with the map, enabled by default.\n */\n\nL.Map.mergeOptions({\n\tkeyboard: true,\n\tkeyboardPanOffset: 80,\n\tkeyboardZoomOffset: 1\n});\n\nL.Map.Keyboard = L.Handler.extend({\n\n\tkeyCodes: {\n\t\tleft:    [37],\n\t\tright:   [39],\n\t\tdown:    [40],\n\t\tup:      [38],\n\t\tzoomIn:  [187, 107, 61, 171],\n\t\tzoomOut: [189, 109, 54, 173]\n\t},\n\n\tinitialize: function (map) {\n\t\tthis._map = map;\n\n\t\tthis._setPanOffset(map.options.keyboardPanOffset);\n\t\tthis._setZoomOffset(map.options.keyboardZoomOffset);\n\t},\n\n\taddHooks: function () {\n\t\tvar container = this._map._container;\n\n\t\t// make the container focusable by tabbing\n\t\tif (container.tabIndex <= 0) {\n\t\t\tcontainer.tabIndex = '0';\n\t\t}\n\n\t\tL.DomEvent.on(container, {\n\t\t\tfocus: this._onFocus,\n\t\t\tblur: this._onBlur,\n\t\t\tmousedown: this._onMouseDown\n\t\t}, this);\n\n\t\tthis._map.on({\n\t\t\tfocus: this._addHooks,\n\t\t\tblur: this._removeHooks\n\t\t}, this);\n\t},\n\n\tremoveHooks: function () {\n\t\tthis._removeHooks();\n\n\t\tL.DomEvent.off(this._map._container, {\n\t\t\tfocus: this._onFocus,\n\t\t\tblur: this._onBlur,\n\t\t\tmousedown: this._onMouseDown\n\t\t}, this);\n\n\t\tthis._map.off({\n\t\t\tfocus: this._addHooks,\n\t\t\tblur: this._removeHooks\n\t\t}, this);\n\t},\n\n\t_onMouseDown: function () {\n\t\tif (this._focused) { return; }\n\n\t\tvar body = document.body,\n\t\t    docEl = document.documentElement,\n\t\t    top = body.scrollTop || docEl.scrollTop,\n\t\t    left = body.scrollLeft || docEl.scrollLeft;\n\n\t\tthis._map._container.focus();\n\n\t\twindow.scrollTo(left, top);\n\t},\n\n\t_onFocus: function () {\n\t\tthis._focused = true;\n\t\tthis._map.fire('focus');\n\t},\n\n\t_onBlur: function () {\n\t\tthis._focused = false;\n\t\tthis._map.fire('blur');\n\t},\n\n\t_setPanOffset: function (pan) {\n\t\tvar keys = this._panKeys = {},\n\t\t    codes = this.keyCodes,\n\t\t    i, len;\n\n\t\tfor (i = 0, len = codes.left.length; i < len; i++) {\n\t\t\tkeys[codes.left[i]] = [-1 * pan, 0];\n\t\t}\n\t\tfor (i = 0, len = codes.right.length; i < len; i++) {\n\t\t\tkeys[codes.right[i]] = [pan, 0];\n\t\t}\n\t\tfor (i = 0, len = codes.down.length; i < len; i++) {\n\t\t\tkeys[codes.down[i]] = [0, pan];\n\t\t}\n\t\tfor (i = 0, len = codes.up.length; i < len; i++) {\n\t\t\tkeys[codes.up[i]] = [0, -1 * pan];\n\t\t}\n\t},\n\n\t_setZoomOffset: function (zoom) {\n\t\tvar keys = this._zoomKeys = {},\n\t\t    codes = this.keyCodes,\n\t\t    i, len;\n\n\t\tfor (i = 0, len = codes.zoomIn.length; i < len; i++) {\n\t\t\tkeys[codes.zoomIn[i]] = zoom;\n\t\t}\n\t\tfor (i = 0, len = codes.zoomOut.length; i < len; i++) {\n\t\t\tkeys[codes.zoomOut[i]] = -zoom;\n\t\t}\n\t},\n\n\t_addHooks: function () {\n\t\tL.DomEvent.on(document, 'keydown', this._onKeyDown, this);\n\t},\n\n\t_removeHooks: function () {\n\t\tL.DomEvent.off(document, 'keydown', this._onKeyDown, this);\n\t},\n\n\t_onKeyDown: function (e) {\n\t\tif (e.altKey || e.ctrlKey || e.metaKey) { return; }\n\n\t\tvar key = e.keyCode,\n\t\t    map = this._map,\n\t\t    offset;\n\n\t\tif (key in this._panKeys) {\n\n\t\t\tif (map._panAnim && map._panAnim._inProgress) { return; }\n\n\t\t\toffset = this._panKeys[key];\n\t\t\tif (e.shiftKey) {\n\t\t\t\toffset = L.point(offset).multiplyBy(3);\n\t\t\t}\n\n\t\t\tmap.panBy(offset);\n\n\t\t\tif (map.options.maxBounds) {\n\t\t\t\tmap.panInsideBounds(map.options.maxBounds);\n\t\t\t}\n\n\t\t} else if (key in this._zoomKeys) {\n\t\t\tmap.setZoom(map.getZoom() + (e.shiftKey ? 3 : 1) * this._zoomKeys[key]);\n\n\t\t} else if (key === 27) {\n\t\t\tmap.closePopup();\n\n\t\t} else {\n\t\t\treturn;\n\t\t}\n\n\t\tL.DomEvent.stop(e);\n\t}\n});\n\nL.Map.addInitHook('addHandler', 'keyboard', L.Map.Keyboard);\n\n\n\n/*\n * L.Handler.MarkerDrag is used internally by L.Marker to make the markers draggable.\n */\n\nL.Handler.MarkerDrag = L.Handler.extend({\n\tinitialize: function (marker) {\n\t\tthis._marker = marker;\n\t},\n\n\taddHooks: function () {\n\t\tvar icon = this._marker._icon;\n\n\t\tif (!this._draggable) {\n\t\t\tthis._draggable = new L.Draggable(icon, icon, true);\n\t\t}\n\n\t\tthis._draggable.on({\n\t\t\tdragstart: this._onDragStart,\n\t\t\tdrag: this._onDrag,\n\t\t\tdragend: this._onDragEnd\n\t\t}, this).enable();\n\n\t\tL.DomUtil.addClass(icon, 'leaflet-marker-draggable');\n\t},\n\n\tremoveHooks: function () {\n\t\tthis._draggable.off({\n\t\t\tdragstart: this._onDragStart,\n\t\t\tdrag: this._onDrag,\n\t\t\tdragend: this._onDragEnd\n\t\t}, this).disable();\n\n\t\tif (this._marker._icon) {\n\t\t\tL.DomUtil.removeClass(this._marker._icon, 'leaflet-marker-draggable');\n\t\t}\n\t},\n\n\tmoved: function () {\n\t\treturn this._draggable && this._draggable._moved;\n\t},\n\n\t_onDragStart: function () {\n\t\tthis._marker\n\t\t    .closePopup()\n\t\t    .fire('movestart')\n\t\t    .fire('dragstart');\n\t},\n\n\t_onDrag: function (e) {\n\t\tvar marker = this._marker,\n\t\t    shadow = marker._shadow,\n\t\t    iconPos = L.DomUtil.getPosition(marker._icon),\n\t\t    latlng = marker._map.layerPointToLatLng(iconPos);\n\n\t\t// update shadow position\n\t\tif (shadow) {\n\t\t\tL.DomUtil.setPosition(shadow, iconPos);\n\t\t}\n\n\t\tmarker._latlng = latlng;\n\t\te.latlng = latlng;\n\n\t\tmarker\n\t\t    .fire('move', e)\n\t\t    .fire('drag', e);\n\t},\n\n\t_onDragEnd: function (e) {\n\t\tthis._marker\n\t\t    .fire('moveend')\n\t\t    .fire('dragend', e);\n\t}\n});\n\n\n\n/*\n * L.Control is a base class for implementing map controls. Handles positioning.\n * All other controls extend from this class.\n */\n\nL.Control = L.Class.extend({\n\toptions: {\n\t\tposition: 'topright'\n\t},\n\n\tinitialize: function (options) {\n\t\tL.setOptions(this, options);\n\t},\n\n\tgetPosition: function () {\n\t\treturn this.options.position;\n\t},\n\n\tsetPosition: function (position) {\n\t\tvar map = this._map;\n\n\t\tif (map) {\n\t\t\tmap.removeControl(this);\n\t\t}\n\n\t\tthis.options.position = position;\n\n\t\tif (map) {\n\t\t\tmap.addControl(this);\n\t\t}\n\n\t\treturn this;\n\t},\n\n\tgetContainer: function () {\n\t\treturn this._container;\n\t},\n\n\taddTo: function (map) {\n\t\tthis.remove();\n\t\tthis._map = map;\n\n\t\tvar container = this._container = this.onAdd(map),\n\t\t    pos = this.getPosition(),\n\t\t    corner = map._controlCorners[pos];\n\n\t\tL.DomUtil.addClass(container, 'leaflet-control');\n\n\t\tif (pos.indexOf('bottom') !== -1) {\n\t\t\tcorner.insertBefore(container, corner.firstChild);\n\t\t} else {\n\t\t\tcorner.appendChild(container);\n\t\t}\n\n\t\treturn this;\n\t},\n\n\tremove: function () {\n\t\tif (!this._map) {\n\t\t\treturn this;\n\t\t}\n\n\t\tL.DomUtil.remove(this._container);\n\n\t\tif (this.onRemove) {\n\t\t\tthis.onRemove(this._map);\n\t\t}\n\n\t\tthis._map = null;\n\n\t\treturn this;\n\t},\n\n\t_refocusOnMap: function (e) {\n\t\t// if map exists and event is not a keyboard event\n\t\tif (this._map && e && e.screenX > 0 && e.screenY > 0) {\n\t\t\tthis._map.getContainer().focus();\n\t\t}\n\t}\n});\n\nL.control = function (options) {\n\treturn new L.Control(options);\n};\n\n\n// adds control-related methods to L.Map\n\nL.Map.include({\n\taddControl: function (control) {\n\t\tcontrol.addTo(this);\n\t\treturn this;\n\t},\n\n\tremoveControl: function (control) {\n\t\tcontrol.remove();\n\t\treturn this;\n\t},\n\n\t_initControlPos: function () {\n\t\tvar corners = this._controlCorners = {},\n\t\t    l = 'leaflet-',\n\t\t    container = this._controlContainer =\n\t\t            L.DomUtil.create('div', l + 'control-container', this._container);\n\n\t\tfunction createCorner(vSide, hSide) {\n\t\t\tvar className = l + vSide + ' ' + l + hSide;\n\n\t\t\tcorners[vSide + hSide] = L.DomUtil.create('div', className, container);\n\t\t}\n\n\t\tcreateCorner('top', 'left');\n\t\tcreateCorner('top', 'right');\n\t\tcreateCorner('bottom', 'left');\n\t\tcreateCorner('bottom', 'right');\n\t},\n\n\t_clearControlPos: function () {\n\t\tL.DomUtil.remove(this._controlContainer);\n\t}\n});\n\n\n\n/*\n * L.Control.Zoom is used for the default zoom buttons on the map.\n */\n\nL.Control.Zoom = L.Control.extend({\n\toptions: {\n\t\tposition: 'topleft',\n\t\tzoomInText: '+',\n\t\tzoomInTitle: 'Zoom in',\n\t\tzoomOutText: '-',\n\t\tzoomOutTitle: 'Zoom out'\n\t},\n\n\tonAdd: function (map) {\n\t\tvar zoomName = 'leaflet-control-zoom',\n\t\t    container = L.DomUtil.create('div', zoomName + ' leaflet-bar'),\n\t\t    options = this.options;\n\n\t\tthis._zoomInButton  = this._createButton(options.zoomInText, options.zoomInTitle,\n\t\t        zoomName + '-in',  container, this._zoomIn);\n\t\tthis._zoomOutButton = this._createButton(options.zoomOutText, options.zoomOutTitle,\n\t\t        zoomName + '-out', container, this._zoomOut);\n\n\t\tthis._updateDisabled();\n\t\tmap.on('zoomend zoomlevelschange', this._updateDisabled, this);\n\n\t\treturn container;\n\t},\n\n\tonRemove: function (map) {\n\t\tmap.off('zoomend zoomlevelschange', this._updateDisabled, this);\n\t},\n\n\tdisable: function () {\n\t\tthis._disabled = true;\n\t\tthis._updateDisabled();\n\t\treturn this;\n\t},\n\n\tenable: function () {\n\t\tthis._disabled = false;\n\t\tthis._updateDisabled();\n\t\treturn this;\n\t},\n\n\t_zoomIn: function (e) {\n\t\tif (!this._disabled) {\n\t\t\tthis._map.zoomIn(e.shiftKey ? 3 : 1);\n\t\t}\n\t},\n\n\t_zoomOut: function (e) {\n\t\tif (!this._disabled) {\n\t\t\tthis._map.zoomOut(e.shiftKey ? 3 : 1);\n\t\t}\n\t},\n\n\t_createButton: function (html, title, className, container, fn) {\n\t\tvar link = L.DomUtil.create('a', className, container);\n\t\tlink.innerHTML = html;\n\t\tlink.href = '#';\n\t\tlink.title = title;\n\n\t\tL.DomEvent\n\t\t    .on(link, 'mousedown dblclick', L.DomEvent.stopPropagation)\n\t\t    .on(link, 'click', L.DomEvent.stop)\n\t\t    .on(link, 'click', fn, this)\n\t\t    .on(link, 'click', this._refocusOnMap, this);\n\n\t\treturn link;\n\t},\n\n\t_updateDisabled: function () {\n\t\tvar map = this._map,\n\t\t    className = 'leaflet-disabled';\n\n\t\tL.DomUtil.removeClass(this._zoomInButton, className);\n\t\tL.DomUtil.removeClass(this._zoomOutButton, className);\n\n\t\tif (this._disabled || map._zoom === map.getMinZoom()) {\n\t\t\tL.DomUtil.addClass(this._zoomOutButton, className);\n\t\t}\n\t\tif (this._disabled || map._zoom === map.getMaxZoom()) {\n\t\t\tL.DomUtil.addClass(this._zoomInButton, className);\n\t\t}\n\t}\n});\n\nL.Map.mergeOptions({\n\tzoomControl: true\n});\n\nL.Map.addInitHook(function () {\n\tif (this.options.zoomControl) {\n\t\tthis.zoomControl = new L.Control.Zoom();\n\t\tthis.addControl(this.zoomControl);\n\t}\n});\n\nL.control.zoom = function (options) {\n\treturn new L.Control.Zoom(options);\n};\n\n\n\n/*\n * L.Control.Attribution is used for displaying attribution on the map (added by default).\n */\n\nL.Control.Attribution = L.Control.extend({\n\toptions: {\n\t\tposition: 'bottomright',\n\t\tprefix: '<a href=\"http://leafletjs.com\" title=\"A JS library for interactive maps\">Leaflet</a>'\n\t},\n\n\tinitialize: function (options) {\n\t\tL.setOptions(this, options);\n\n\t\tthis._attributions = {};\n\t},\n\n\tonAdd: function (map) {\n\t\tthis._container = L.DomUtil.create('div', 'leaflet-control-attribution');\n\t\tif (L.DomEvent) {\n\t\t\tL.DomEvent.disableClickPropagation(this._container);\n\t\t}\n\n\t\t// TODO ugly, refactor\n\t\tfor (var i in map._layers) {\n\t\t\tif (map._layers[i].getAttribution) {\n\t\t\t\tthis.addAttribution(map._layers[i].getAttribution());\n\t\t\t}\n\t\t}\n\n\t\tthis._update();\n\n\t\treturn this._container;\n\t},\n\n\tsetPrefix: function (prefix) {\n\t\tthis.options.prefix = prefix;\n\t\tthis._update();\n\t\treturn this;\n\t},\n\n\taddAttribution: function (text) {\n\t\tif (!text) { return this; }\n\n\t\tif (!this._attributions[text]) {\n\t\t\tthis._attributions[text] = 0;\n\t\t}\n\t\tthis._attributions[text]++;\n\n\t\tthis._update();\n\n\t\treturn this;\n\t},\n\n\tremoveAttribution: function (text) {\n\t\tif (!text) { return this; }\n\n\t\tif (this._attributions[text]) {\n\t\t\tthis._attributions[text]--;\n\t\t\tthis._update();\n\t\t}\n\n\t\treturn this;\n\t},\n\n\t_update: function () {\n\t\tif (!this._map) { return; }\n\n\t\tvar attribs = [];\n\n\t\tfor (var i in this._attributions) {\n\t\t\tif (this._attributions[i]) {\n\t\t\t\tattribs.push(i);\n\t\t\t}\n\t\t}\n\n\t\tvar prefixAndAttribs = [];\n\n\t\tif (this.options.prefix) {\n\t\t\tprefixAndAttribs.push(this.options.prefix);\n\t\t}\n\t\tif (attribs.length) {\n\t\t\tprefixAndAttribs.push(attribs.join(', '));\n\t\t}\n\n\t\tthis._container.innerHTML = prefixAndAttribs.join(' | ');\n\t}\n});\n\nL.Map.mergeOptions({\n\tattributionControl: true\n});\n\nL.Map.addInitHook(function () {\n\tif (this.options.attributionControl) {\n\t\tthis.attributionControl = (new L.Control.Attribution()).addTo(this);\n\t}\n});\n\nL.control.attribution = function (options) {\n\treturn new L.Control.Attribution(options);\n};\n\n\n\n/*\n * L.Control.Scale is used for displaying metric/imperial scale on the map.\n */\n\nL.Control.Scale = L.Control.extend({\n\toptions: {\n\t\tposition: 'bottomleft',\n\t\tmaxWidth: 100,\n\t\tmetric: true,\n\t\timperial: true\n\t\t// updateWhenIdle: false\n\t},\n\n\tonAdd: function (map) {\n\t\tvar className = 'leaflet-control-scale',\n\t\t    container = L.DomUtil.create('div', className),\n\t\t    options = this.options;\n\n\t\tthis._addScales(options, className + '-line', container);\n\n\t\tmap.on(options.updateWhenIdle ? 'moveend' : 'move', this._update, this);\n\t\tmap.whenReady(this._update, this);\n\n\t\treturn container;\n\t},\n\n\tonRemove: function (map) {\n\t\tmap.off(this.options.updateWhenIdle ? 'moveend' : 'move', this._update, this);\n\t},\n\n\t_addScales: function (options, className, container) {\n\t\tif (options.metric) {\n\t\t\tthis._mScale = L.DomUtil.create('div', className, container);\n\t\t}\n\t\tif (options.imperial) {\n\t\t\tthis._iScale = L.DomUtil.create('div', className, container);\n\t\t}\n\t},\n\n\t_update: function () {\n\t\tvar map = this._map,\n\t\t    y = map.getSize().y / 2;\n\n\t\tvar maxMeters = map.distance(\n\t\t\t\tmap.containerPointToLatLng([0, y]),\n\t\t\t\tmap.containerPointToLatLng([this.options.maxWidth, y]));\n\n\t\tthis._updateScales(maxMeters);\n\t},\n\n\t_updateScales: function (maxMeters) {\n\t\tif (this.options.metric && maxMeters) {\n\t\t\tthis._updateMetric(maxMeters);\n\t\t}\n\t\tif (this.options.imperial && maxMeters) {\n\t\t\tthis._updateImperial(maxMeters);\n\t\t}\n\t},\n\n\t_updateMetric: function (maxMeters) {\n\t\tvar meters = this._getRoundNum(maxMeters),\n\t\t    label = meters < 1000 ? meters + ' m' : (meters / 1000) + ' km';\n\n\t\tthis._updateScale(this._mScale, label, meters / maxMeters);\n\t},\n\n\t_updateImperial: function (maxMeters) {\n\t\tvar maxFeet = maxMeters * 3.2808399,\n\t\t    maxMiles, miles, feet;\n\n\t\tif (maxFeet > 5280) {\n\t\t\tmaxMiles = maxFeet / 5280;\n\t\t\tmiles = this._getRoundNum(maxMiles);\n\t\t\tthis._updateScale(this._iScale, miles + ' mi', miles / maxMiles);\n\n\t\t} else {\n\t\t\tfeet = this._getRoundNum(maxFeet);\n\t\t\tthis._updateScale(this._iScale, feet + ' ft', feet / maxFeet);\n\t\t}\n\t},\n\n\t_updateScale: function (scale, text, ratio) {\n\t\tscale.style.width = Math.round(this.options.maxWidth * ratio) + 'px';\n\t\tscale.innerHTML = text;\n\t},\n\n\t_getRoundNum: function (num) {\n\t\tvar pow10 = Math.pow(10, (Math.floor(num) + '').length - 1),\n\t\t    d = num / pow10;\n\n\t\td = d >= 10 ? 10 :\n\t\t    d >= 5 ? 5 :\n\t\t    d >= 3 ? 3 :\n\t\t    d >= 2 ? 2 : 1;\n\n\t\treturn pow10 * d;\n\t}\n});\n\nL.control.scale = function (options) {\n\treturn new L.Control.Scale(options);\n};\n\n\n\n/*\n * L.Control.Layers is a control to allow users to switch between different layers on the map.\n */\n\nL.Control.Layers = L.Control.extend({\n\toptions: {\n\t\tcollapsed: true,\n\t\tposition: 'topright',\n\t\tautoZIndex: true,\n\t\thideSingleBase: false\n\t},\n\n\tinitialize: function (baseLayers, overlays, options) {\n\t\tL.setOptions(this, options);\n\n\t\tthis._layers = {};\n\t\tthis._lastZIndex = 0;\n\t\tthis._handlingClick = false;\n\n\t\tfor (var i in baseLayers) {\n\t\t\tthis._addLayer(baseLayers[i], i);\n\t\t}\n\n\t\tfor (i in overlays) {\n\t\t\tthis._addLayer(overlays[i], i, true);\n\t\t}\n\t},\n\n\tonAdd: function (map) {\n\t\tthis._initLayout();\n\t\tthis._update();\n\n\t\tthis._map = map;\n\t\tmap.on('zoomend', this._checkDisabledLayers, this);\n\n\t\treturn this._container;\n\t},\n\n\tonRemove: function () {\n\t\tthis._map.off('zoomend', this._checkDisabledLayers, this);\n\t},\n\n\taddBaseLayer: function (layer, name) {\n\t\tthis._addLayer(layer, name);\n\t\treturn this._update();\n\t},\n\n\taddOverlay: function (layer, name) {\n\t\tthis._addLayer(layer, name, true);\n\t\treturn this._update();\n\t},\n\n\tremoveLayer: function (layer) {\n\t\tlayer.off('add remove', this._onLayerChange, this);\n\n\t\tdelete this._layers[L.stamp(layer)];\n\t\treturn this._update();\n\t},\n\n\t_initLayout: function () {\n\t\tvar className = 'leaflet-control-layers',\n\t\t    container = this._container = L.DomUtil.create('div', className);\n\n\t\t// makes this work on IE touch devices by stopping it from firing a mouseout event when the touch is released\n\t\tcontainer.setAttribute('aria-haspopup', true);\n\n\t\tL.DomEvent.disableClickPropagation(container);\n\t\tif (!L.Browser.touch) {\n\t\t\tL.DomEvent.disableScrollPropagation(container);\n\t\t}\n\n\t\tvar form = this._form = L.DomUtil.create('form', className + '-list');\n\n\t\tif (this.options.collapsed) {\n\t\t\tif (!L.Browser.android) {\n\t\t\t\tL.DomEvent.on(container, {\n\t\t\t\t\tmouseenter: this._expand,\n\t\t\t\t\tmouseleave: this._collapse\n\t\t\t\t}, this);\n\t\t\t}\n\n\t\t\tvar link = this._layersLink = L.DomUtil.create('a', className + '-toggle', container);\n\t\t\tlink.href = '#';\n\t\t\tlink.title = 'Layers';\n\n\t\t\tif (L.Browser.touch) {\n\t\t\t\tL.DomEvent\n\t\t\t\t    .on(link, 'click', L.DomEvent.stop)\n\t\t\t\t    .on(link, 'click', this._expand, this);\n\t\t\t} else {\n\t\t\t\tL.DomEvent.on(link, 'focus', this._expand, this);\n\t\t\t}\n\n\t\t\t// work around for Firefox Android issue https://github.com/Leaflet/Leaflet/issues/2033\n\t\t\tL.DomEvent.on(form, 'click', function () {\n\t\t\t\tsetTimeout(L.bind(this._onInputClick, this), 0);\n\t\t\t}, this);\n\n\t\t\tthis._map.on('click', this._collapse, this);\n\t\t\t// TODO keyboard accessibility\n\t\t} else {\n\t\t\tthis._expand();\n\t\t}\n\n\t\tthis._baseLayersList = L.DomUtil.create('div', className + '-base', form);\n\t\tthis._separator = L.DomUtil.create('div', className + '-separator', form);\n\t\tthis._overlaysList = L.DomUtil.create('div', className + '-overlays', form);\n\n\t\tcontainer.appendChild(form);\n\t},\n\n\t_addLayer: function (layer, name, overlay) {\n\t\tlayer.on('add remove', this._onLayerChange, this);\n\n\t\tvar id = L.stamp(layer);\n\n\t\tthis._layers[id] = {\n\t\t\tlayer: layer,\n\t\t\tname: name,\n\t\t\toverlay: overlay\n\t\t};\n\n\t\tif (this.options.autoZIndex && layer.setZIndex) {\n\t\t\tthis._lastZIndex++;\n\t\t\tlayer.setZIndex(this._lastZIndex);\n\t\t}\n\t},\n\n\t_update: function () {\n\t\tif (!this._container) { return this; }\n\n\t\tL.DomUtil.empty(this._baseLayersList);\n\t\tL.DomUtil.empty(this._overlaysList);\n\n\t\tvar baseLayersPresent, overlaysPresent, i, obj, baseLayersCount = 0;\n\n\t\tfor (i in this._layers) {\n\t\t\tobj = this._layers[i];\n\t\t\tthis._addItem(obj);\n\t\t\toverlaysPresent = overlaysPresent || obj.overlay;\n\t\t\tbaseLayersPresent = baseLayersPresent || !obj.overlay;\n\t\t\tbaseLayersCount += !obj.overlay ? 1 : 0;\n\t\t}\n\n\t\t// Hide base layers section if there's only one layer.\n\t\tif (this.options.hideSingleBase) {\n\t\t\tbaseLayersPresent = baseLayersPresent && baseLayersCount > 1;\n\t\t\tthis._baseLayersList.style.display = baseLayersPresent ? '' : 'none';\n\t\t}\n\n\t\tthis._separator.style.display = overlaysPresent && baseLayersPresent ? '' : 'none';\n\n\t\treturn this;\n\t},\n\n\t_onLayerChange: function (e) {\n\t\tif (!this._handlingClick) {\n\t\t\tthis._update();\n\t\t}\n\n\t\tvar obj = this._layers[L.stamp(e.target)];\n\n\t\tvar type = obj.overlay ?\n\t\t\t(e.type === 'add' ? 'overlayadd' : 'overlayremove') :\n\t\t\t(e.type === 'add' ? 'baselayerchange' : null);\n\n\t\tif (type) {\n\t\t\tthis._map.fire(type, obj);\n\t\t}\n\t},\n\n\t// IE7 bugs out if you create a radio dynamically, so you have to do it this hacky way (see http://bit.ly/PqYLBe)\n\t_createRadioElement: function (name, checked) {\n\n\t\tvar radioHtml = '<input type=\"radio\" class=\"leaflet-control-layers-selector\" name=\"' +\n\t\t\t\tname + '\"' + (checked ? ' checked=\"checked\"' : '') + '/>';\n\n\t\tvar radioFragment = document.createElement('div');\n\t\tradioFragment.innerHTML = radioHtml;\n\n\t\treturn radioFragment.firstChild;\n\t},\n\n\t_addItem: function (obj) {\n\t\tvar label = document.createElement('label'),\n\t\t    checked = this._map.hasLayer(obj.layer),\n\t\t    input;\n\n\t\tif (obj.overlay) {\n\t\t\tinput = document.createElement('input');\n\t\t\tinput.type = 'checkbox';\n\t\t\tinput.className = 'leaflet-control-layers-selector';\n\t\t\tinput.defaultChecked = checked;\n\t\t} else {\n\t\t\tinput = this._createRadioElement('leaflet-base-layers', checked);\n\t\t}\n\n\t\tinput.layerId = L.stamp(obj.layer);\n\n\t\tL.DomEvent.on(input, 'click', this._onInputClick, this);\n\n\t\tvar name = document.createElement('span');\n\t\tname.innerHTML = ' ' + obj.name;\n\n\t\t// Helps from preventing layer control flicker when checkboxes are disabled\n\t\t// https://github.com/Leaflet/Leaflet/issues/2771\n\t\tvar holder = document.createElement('div');\n\n\t\tlabel.appendChild(holder);\n\t\tholder.appendChild(input);\n\t\tholder.appendChild(name);\n\n\t\tvar container = obj.overlay ? this._overlaysList : this._baseLayersList;\n\t\tcontainer.appendChild(label);\n\n\t\tthis._checkDisabledLayers();\n\t\treturn label;\n\t},\n\n\t_onInputClick: function () {\n\t\tvar inputs = this._form.getElementsByTagName('input'),\n\t\t    input, layer, hasLayer;\n\t\tvar addedLayers = [],\n\t\t    removedLayers = [];\n\n\t\tthis._handlingClick = true;\n\n\t\tfor (var i = inputs.length - 1; i >= 0; i--) {\n\t\t\tinput = inputs[i];\n\t\t\tlayer = this._layers[input.layerId].layer;\n\t\t\thasLayer = this._map.hasLayer(layer);\n\n\t\t\tif (input.checked && !hasLayer) {\n\t\t\t\taddedLayers.push(layer);\n\n\t\t\t} else if (!input.checked && hasLayer) {\n\t\t\t\tremovedLayers.push(layer);\n\t\t\t}\n\t\t}\n\n\t\t// Bugfix issue 2318: Should remove all old layers before readding new ones\n\t\tfor (i = 0; i < removedLayers.length; i++) {\n\t\t\tthis._map.removeLayer(removedLayers[i]);\n\t\t}\n\t\tfor (i = 0; i < addedLayers.length; i++) {\n\t\t\tthis._map.addLayer(addedLayers[i]);\n\t\t}\n\n\t\tthis._handlingClick = false;\n\n\t\tthis._refocusOnMap();\n\t},\n\n\t_expand: function () {\n\t\tL.DomUtil.addClass(this._container, 'leaflet-control-layers-expanded');\n\t\tthis._form.style.height = null;\n\t\tvar acceptableHeight = this._map._size.y - (this._container.offsetTop + 50);\n\t\tif (acceptableHeight < this._form.clientHeight) {\n\t\t\tL.DomUtil.addClass(this._form, 'leaflet-control-layers-scrollbar');\n\t\t\tthis._form.style.height = acceptableHeight + 'px';\n\t\t} else {\n\t\t\tL.DomUtil.removeClass(this._form, 'leaflet-control-layers-scrollbar');\n\t\t}\n\t\tthis._checkDisabledLayers();\n\t},\n\n\t_collapse: function () {\n\t\tL.DomUtil.removeClass(this._container, 'leaflet-control-layers-expanded');\n\t},\n\n\t_checkDisabledLayers: function () {\n\t\tvar inputs = this._form.getElementsByTagName('input'),\n\t\t    input,\n\t\t    layer,\n\t\t    zoom = this._map.getZoom();\n\n\t\tfor (var i = inputs.length - 1; i >= 0; i--) {\n\t\t\tinput = inputs[i];\n\t\t\tlayer = this._layers[input.layerId].layer;\n\t\t\tinput.disabled = (layer.options.minZoom !== undefined && zoom < layer.options.minZoom) ||\n\t\t\t                 (layer.options.maxZoom !== undefined && zoom > layer.options.maxZoom);\n\n\t\t}\n\t}\n});\n\nL.control.layers = function (baseLayers, overlays, options) {\n\treturn new L.Control.Layers(baseLayers, overlays, options);\n};\n\n\n\n/*\n * L.PosAnimation powers Leaflet pan animations internally.\n */\n\nL.PosAnimation = L.Evented.extend({\n\n\trun: function (el, newPos, duration, easeLinearity) { // (HTMLElement, Point[, Number, Number])\n\t\tthis.stop();\n\n\t\tthis._el = el;\n\t\tthis._inProgress = true;\n\t\tthis._duration = duration || 0.25;\n\t\tthis._easeOutPower = 1 / Math.max(easeLinearity || 0.5, 0.2);\n\n\t\tthis._startPos = L.DomUtil.getPosition(el);\n\t\tthis._offset = newPos.subtract(this._startPos);\n\t\tthis._startTime = +new Date();\n\n\t\tthis.fire('start');\n\n\t\tthis._animate();\n\t},\n\n\tstop: function () {\n\t\tif (!this._inProgress) { return; }\n\n\t\tthis._step(true);\n\t\tthis._complete();\n\t},\n\n\t_animate: function () {\n\t\t// animation loop\n\t\tthis._animId = L.Util.requestAnimFrame(this._animate, this);\n\t\tthis._step();\n\t},\n\n\t_step: function (round) {\n\t\tvar elapsed = (+new Date()) - this._startTime,\n\t\t    duration = this._duration * 1000;\n\n\t\tif (elapsed < duration) {\n\t\t\tthis._runFrame(this._easeOut(elapsed / duration), round);\n\t\t} else {\n\t\t\tthis._runFrame(1);\n\t\t\tthis._complete();\n\t\t}\n\t},\n\n\t_runFrame: function (progress, round) {\n\t\tvar pos = this._startPos.add(this._offset.multiplyBy(progress));\n\t\tif (round) {\n\t\t\tpos._round();\n\t\t}\n\t\tL.DomUtil.setPosition(this._el, pos);\n\n\t\tthis.fire('step');\n\t},\n\n\t_complete: function () {\n\t\tL.Util.cancelAnimFrame(this._animId);\n\n\t\tthis._inProgress = false;\n\t\tthis.fire('end');\n\t},\n\n\t_easeOut: function (t) {\n\t\treturn 1 - Math.pow(1 - t, this._easeOutPower);\n\t}\n});\n\n\n\n/*\n * Extends L.Map to handle panning animations.\n */\n\nL.Map.include({\n\n\tsetView: function (center, zoom, options) {\n\n\t\tzoom = zoom === undefined ? this._zoom : this._limitZoom(zoom);\n\t\tcenter = this._limitCenter(L.latLng(center), zoom, this.options.maxBounds);\n\t\toptions = options || {};\n\n\t\tthis.stop();\n\n\t\tif (this._loaded && !options.reset && options !== true) {\n\n\t\t\tif (options.animate !== undefined) {\n\t\t\t\toptions.zoom = L.extend({animate: options.animate}, options.zoom);\n\t\t\t\toptions.pan = L.extend({animate: options.animate, duration: options.duration}, options.pan);\n\t\t\t}\n\n\t\t\t// try animating pan or zoom\n\t\t\tvar moved = (this._zoom !== zoom) ?\n\t\t\t\tthis._tryAnimatedZoom && this._tryAnimatedZoom(center, zoom, options.zoom) :\n\t\t\t\tthis._tryAnimatedPan(center, options.pan);\n\n\t\t\tif (moved) {\n\t\t\t\t// prevent resize handler call, the view will refresh after animation anyway\n\t\t\t\tclearTimeout(this._sizeTimer);\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}\n\n\t\t// animation didn't start, just reset the map view\n\t\tthis._resetView(center, zoom);\n\n\t\treturn this;\n\t},\n\n\tpanBy: function (offset, options) {\n\t\toffset = L.point(offset).round();\n\t\toptions = options || {};\n\n\t\tif (!offset.x && !offset.y) {\n\t\t\treturn this.fire('moveend');\n\t\t}\n\t\t// If we pan too far, Chrome gets issues with tiles\n\t\t// and makes them disappear or appear in the wrong place (slightly offset) #2602\n\t\tif (options.animate !== true && !this.getSize().contains(offset)) {\n\t\t\tthis._resetView(this.unproject(this.project(this.getCenter()).add(offset)), this.getZoom());\n\t\t\treturn this;\n\t\t}\n\n\t\tif (!this._panAnim) {\n\t\t\tthis._panAnim = new L.PosAnimation();\n\n\t\t\tthis._panAnim.on({\n\t\t\t\t'step': this._onPanTransitionStep,\n\t\t\t\t'end': this._onPanTransitionEnd\n\t\t\t}, this);\n\t\t}\n\n\t\t// don't fire movestart if animating inertia\n\t\tif (!options.noMoveStart) {\n\t\t\tthis.fire('movestart');\n\t\t}\n\n\t\t// animate pan unless animate: false specified\n\t\tif (options.animate !== false) {\n\t\t\tL.DomUtil.addClass(this._mapPane, 'leaflet-pan-anim');\n\n\t\t\tvar newPos = this._getMapPanePos().subtract(offset);\n\t\t\tthis._panAnim.run(this._mapPane, newPos, options.duration || 0.25, options.easeLinearity);\n\t\t} else {\n\t\t\tthis._rawPanBy(offset);\n\t\t\tthis.fire('move').fire('moveend');\n\t\t}\n\n\t\treturn this;\n\t},\n\n\t_onPanTransitionStep: function () {\n\t\tthis.fire('move');\n\t},\n\n\t_onPanTransitionEnd: function () {\n\t\tL.DomUtil.removeClass(this._mapPane, 'leaflet-pan-anim');\n\t\tthis.fire('moveend');\n\t},\n\n\t_tryAnimatedPan: function (center, options) {\n\t\t// difference between the new and current centers in pixels\n\t\tvar offset = this._getCenterOffset(center)._floor();\n\n\t\t// don't animate too far unless animate: true specified in options\n\t\tif ((options && options.animate) !== true && !this.getSize().contains(offset)) { return false; }\n\n\t\tthis.panBy(offset, options);\n\n\t\treturn true;\n\t}\n});\n\n\n\n/*\n * Extends L.Map to handle zoom animations.\n */\n\nL.Map.mergeOptions({\n\tzoomAnimation: true,\n\tzoomAnimationThreshold: 4\n});\n\nvar zoomAnimated = L.DomUtil.TRANSITION && L.Browser.any3d && !L.Browser.mobileOpera;\n\nif (zoomAnimated) {\n\n\tL.Map.addInitHook(function () {\n\t\t// don't animate on browsers without hardware-accelerated transitions or old Android/Opera\n\t\tthis._zoomAnimated = this.options.zoomAnimation;\n\n\t\t// zoom transitions run with the same duration for all layers, so if one of transitionend events\n\t\t// happens after starting zoom animation (propagating to the map pane), we know that it ended globally\n\t\tif (this._zoomAnimated) {\n\n\t\t\tthis._createAnimProxy();\n\n\t\t\tL.DomEvent.on(this._proxy, L.DomUtil.TRANSITION_END, this._catchTransitionEnd, this);\n\t\t}\n\t});\n}\n\nL.Map.include(!zoomAnimated ? {} : {\n\n\t_createAnimProxy: function () {\n\n\t\tvar proxy = this._proxy = L.DomUtil.create('div', 'leaflet-proxy leaflet-zoom-animated');\n\t\tthis._panes.mapPane.appendChild(proxy);\n\n\t\tthis.on('zoomanim', function (e) {\n\t\t\tvar prop = L.DomUtil.TRANSFORM,\n\t\t\t    transform = proxy.style[prop];\n\n\t\t\tL.DomUtil.setTransform(proxy, this.project(e.center, e.zoom), this.getZoomScale(e.zoom, 1));\n\n\t\t\t// workaround for case when transform is the same and so transitionend event is not fired\n\t\t\tif (transform === proxy.style[prop] && this._animatingZoom) {\n\t\t\t\tthis._onZoomTransitionEnd();\n\t\t\t}\n\t\t}, this);\n\n\t\tthis.on('load moveend', function () {\n\t\t\tvar c = this.getCenter(),\n\t\t\t    z = this.getZoom();\n\t\t\tL.DomUtil.setTransform(proxy, this.project(c, z), this.getZoomScale(z, 1));\n\t\t}, this);\n\t},\n\n\t_catchTransitionEnd: function (e) {\n\t\tif (this._animatingZoom && e.propertyName.indexOf('transform') >= 0) {\n\t\t\tthis._onZoomTransitionEnd();\n\t\t}\n\t},\n\n\t_nothingToAnimate: function () {\n\t\treturn !this._container.getElementsByClassName('leaflet-zoom-animated').length;\n\t},\n\n\t_tryAnimatedZoom: function (center, zoom, options) {\n\n\t\tif (this._animatingZoom) { return true; }\n\n\t\toptions = options || {};\n\n\t\t// don't animate if disabled, not supported or zoom difference is too large\n\t\tif (!this._zoomAnimated || options.animate === false || this._nothingToAnimate() ||\n\t\t        Math.abs(zoom - this._zoom) > this.options.zoomAnimationThreshold) { return false; }\n\n\t\t// offset is the pixel coords of the zoom origin relative to the current center\n\t\tvar scale = this.getZoomScale(zoom),\n\t\t    offset = this._getCenterOffset(center)._divideBy(1 - 1 / scale);\n\n\t\t// don't animate if the zoom origin isn't within one screen from the current center, unless forced\n\t\tif (options.animate !== true && !this.getSize().contains(offset)) { return false; }\n\n\t\tL.Util.requestAnimFrame(function () {\n\t\t\tthis\n\t\t\t    ._moveStart(true)\n\t\t\t    ._animateZoom(center, zoom, true);\n\t\t}, this);\n\n\t\treturn true;\n\t},\n\n\t_animateZoom: function (center, zoom, startAnim, noUpdate) {\n\t\tif (startAnim) {\n\t\t\tthis._animatingZoom = true;\n\n\t\t\t// remember what center/zoom to set after animation\n\t\t\tthis._animateToCenter = center;\n\t\t\tthis._animateToZoom = zoom;\n\n\t\t\tL.DomUtil.addClass(this._mapPane, 'leaflet-zoom-anim');\n\t\t}\n\n\t\tthis.fire('zoomanim', {\n\t\t\tcenter: center,\n\t\t\tzoom: zoom,\n\t\t\tnoUpdate: noUpdate\n\t\t});\n\n\t\t// Work around webkit not firing 'transitionend', see https://github.com/Leaflet/Leaflet/issues/3689, 2693\n\t\tsetTimeout(L.bind(this._onZoomTransitionEnd, this), 250);\n\t},\n\n\t_onZoomTransitionEnd: function () {\n\t\tif (!this._animatingZoom) { return; }\n\n\t\tL.DomUtil.removeClass(this._mapPane, 'leaflet-zoom-anim');\n\n\t\t// This anim frame should prevent an obscure iOS webkit tile loading race condition.\n\t\tL.Util.requestAnimFrame(function () {\n\t\t\tthis._animatingZoom = false;\n\n\t\t\tthis\n\t\t\t\t._move(this._animateToCenter, this._animateToZoom)\n\t\t\t\t._moveEnd(true);\n\t\t}, this);\n\t}\n});\n\n\n\n\nL.Map.include({\n\tflyTo: function (targetCenter, targetZoom, options) {\n\n\t\toptions = options || {};\n\t\tif (options.animate === false || !L.Browser.any3d) {\n\t\t\treturn this.setView(targetCenter, targetZoom, options);\n\t\t}\n\n\t\tthis.stop();\n\n\t\tvar from = this.project(this.getCenter()),\n\t\t    to = this.project(targetCenter),\n\t\t    size = this.getSize(),\n\t\t    startZoom = this._zoom;\n\n\t\ttargetCenter = L.latLng(targetCenter);\n\t\ttargetZoom = targetZoom === undefined ? startZoom : targetZoom;\n\n\t\tvar w0 = Math.max(size.x, size.y),\n\t\t    w1 = w0 * this.getZoomScale(startZoom, targetZoom),\n\t\t    u1 = (to.distanceTo(from)) || 1,\n\t\t    rho = 1.42,\n\t\t    rho2 = rho * rho;\n\n\t\tfunction r(i) {\n\t\t\tvar b = (w1 * w1 - w0 * w0 + (i ? -1 : 1) * rho2 * rho2 * u1 * u1) / (2 * (i ? w1 : w0) * rho2 * u1);\n\t\t\treturn Math.log(Math.sqrt(b * b + 1) - b);\n\t\t}\n\n\t\tfunction sinh(n) { return (Math.exp(n) - Math.exp(-n)) / 2; }\n\t\tfunction cosh(n) { return (Math.exp(n) + Math.exp(-n)) / 2; }\n\t\tfunction tanh(n) { return sinh(n) / cosh(n); }\n\n\t\tvar r0 = r(0);\n\n\t\tfunction w(s) { return w0 * (cosh(r0) / cosh(r0 + rho * s)); }\n\t\tfunction u(s) { return w0 * (cosh(r0) * tanh(r0 + rho * s) - sinh(r0)) / rho2; }\n\n\t\tfunction easeOut(t) { return 1 - Math.pow(1 - t, 1.5); }\n\n\t\tvar start = Date.now(),\n\t\t    S = (r(1) - r0) / rho,\n\t\t    duration = options.duration ? 1000 * options.duration : 1000 * S * 0.8;\n\n\t\tfunction frame() {\n\t\t\tvar t = (Date.now() - start) / duration,\n\t\t\t    s = easeOut(t) * S;\n\n\t\t\tif (t <= 1) {\n\t\t\t\tthis._flyToFrame = L.Util.requestAnimFrame(frame, this);\n\n\t\t\t\tthis._move(\n\t\t\t\t\tthis.unproject(from.add(to.subtract(from).multiplyBy(u(s) / u1)), startZoom),\n\t\t\t\t\tthis.getScaleZoom(w0 / w(s), startZoom),\n\t\t\t\t\t{flyTo: true});\n\n\t\t\t} else {\n\t\t\t\tthis\n\t\t\t\t\t._move(targetCenter, targetZoom)\n\t\t\t\t\t._moveEnd(true);\n\t\t\t}\n\t\t}\n\n\t\tthis._moveStart(true);\n\n\t\tframe.call(this);\n\t\treturn this;\n\t},\n\n\tflyToBounds: function (bounds, options) {\n\t\tvar target = this._getBoundsCenterZoom(bounds, options);\n\t\treturn this.flyTo(target.center, target.zoom, options);\n\t}\n});\n\n\n\n/*\n * Provides L.Map with convenient shortcuts for using browser geolocation features.\n */\n\nL.Map.include({\n\t_defaultLocateOptions: {\n\t\ttimeout: 10000,\n\t\twatch: false\n\t\t// setView: false\n\t\t// maxZoom: <Number>\n\t\t// maximumAge: 0\n\t\t// enableHighAccuracy: false\n\t},\n\n\tlocate: function (options) {\n\n\t\toptions = this._locateOptions = L.extend({}, this._defaultLocateOptions, options);\n\n\t\tif (!('geolocation' in navigator)) {\n\t\t\tthis._handleGeolocationError({\n\t\t\t\tcode: 0,\n\t\t\t\tmessage: 'Geolocation not supported.'\n\t\t\t});\n\t\t\treturn this;\n\t\t}\n\n\t\tvar onResponse = L.bind(this._handleGeolocationResponse, this),\n\t\t    onError = L.bind(this._handleGeolocationError, this);\n\n\t\tif (options.watch) {\n\t\t\tthis._locationWatchId =\n\t\t\t        navigator.geolocation.watchPosition(onResponse, onError, options);\n\t\t} else {\n\t\t\tnavigator.geolocation.getCurrentPosition(onResponse, onError, options);\n\t\t}\n\t\treturn this;\n\t},\n\n\tstopLocate: function () {\n\t\tif (navigator.geolocation && navigator.geolocation.clearWatch) {\n\t\t\tnavigator.geolocation.clearWatch(this._locationWatchId);\n\t\t}\n\t\tif (this._locateOptions) {\n\t\t\tthis._locateOptions.setView = false;\n\t\t}\n\t\treturn this;\n\t},\n\n\t_handleGeolocationError: function (error) {\n\t\tvar c = error.code,\n\t\t    message = error.message ||\n\t\t            (c === 1 ? 'permission denied' :\n\t\t            (c === 2 ? 'position unavailable' : 'timeout'));\n\n\t\tif (this._locateOptions.setView && !this._loaded) {\n\t\t\tthis.fitWorld();\n\t\t}\n\n\t\tthis.fire('locationerror', {\n\t\t\tcode: c,\n\t\t\tmessage: 'Geolocation error: ' + message + '.'\n\t\t});\n\t},\n\n\t_handleGeolocationResponse: function (pos) {\n\t\tvar lat = pos.coords.latitude,\n\t\t    lng = pos.coords.longitude,\n\t\t    latlng = new L.LatLng(lat, lng),\n\t\t    bounds = latlng.toBounds(pos.coords.accuracy),\n\t\t    options = this._locateOptions;\n\n\t\tif (options.setView) {\n\t\t\tvar zoom = this.getBoundsZoom(bounds);\n\t\t\tthis.setView(latlng, options.maxZoom ? Math.min(zoom, options.maxZoom) : zoom);\n\t\t}\n\n\t\tvar data = {\n\t\t\tlatlng: latlng,\n\t\t\tbounds: bounds,\n\t\t\ttimestamp: pos.timestamp\n\t\t};\n\n\t\tfor (var i in pos.coords) {\n\t\t\tif (typeof pos.coords[i] === 'number') {\n\t\t\t\tdata[i] = pos.coords[i];\n\t\t\t}\n\t\t}\n\n\t\tthis.fire('locationfound', data);\n\t}\n});\n\n\n}(window, document));\n//# sourceMappingURL=leaflet-src.map","(function(window, document, undefined) {\n\n\"use strict\";\n\nL.Toolbar = (L.Layer || L.Class).extend({\n\tstatics: {\n\t\tbaseClass: 'leaflet-toolbar'\n\t},\n\n\tincludes: L.Mixin.Events,\n\n\toptions: {\n\t\tclassName: '',\n\t\tfilter: function() { return true; },\n\t\tactions: []\n\t},\n\n\tinitialize: function(options) {\n\t\tL.setOptions(this, options);\n\t\tthis._toolbar_type = this.constructor._toolbar_class_id;\n\t},\n\n\taddTo: function(map) {\n\t\tthis._arguments = [].slice.call(arguments);\n\n\t\tmap.addLayer(this);\n\n\t\treturn this;\n\t},\n\n\tonAdd: function(map) {\n\t\tvar currentToolbar = map._toolbars[this._toolbar_type];\n\n\t\tif (this._calculateDepth() === 0) {\n\t\t\tif (currentToolbar) { map.removeLayer(currentToolbar); }\n\t\t\tmap._toolbars[this._toolbar_type] = this;\n\t\t}\n\t},\n\n\tonRemove: function(map) {\n\t\t/* \n\t\t * TODO: Cleanup event listeners. \n\t\t * For some reason, this throws:\n\t\t * \"Uncaught TypeError: Cannot read property 'dragging' of null\"\n\t\t * on this._marker when a toolbar icon is clicked.\n\t\t */\n\t\t// for (var i = 0, l = this._disabledEvents.length; i < l; i++) {\n\t\t// \tL.DomEvent.off(this._ul, this._disabledEvents[i], L.DomEvent.stopPropagation);\n\t\t// }\n\n\t\tif (this._calculateDepth() === 0) {\n\t\t\tdelete map._toolbars[this._toolbar_type];\n\t\t}\n\t},\n\n\tappendToContainer: function(container) {\n\t\tvar baseClass = this.constructor.baseClass + '-' + this._calculateDepth(),\n\t\t\tclassName = baseClass + ' ' + this.options.className,\n\t\t\tAction, action,\n\t\t\ti, l;\n\n\t\tthis._container = container;\n\t\tthis._ul = L.DomUtil.create('ul', className, container);\n\n\t\t/* Ensure that clicks, drags, etc. don't bubble up to the map. */\n\t\tL.DomEvent.disableScrollPropagation(this._ul);\n\t\tL.DomEvent.disableClickPropagation(this._ul);\n\n\t\t/* Instantiate each toolbar action and add its corresponding toolbar icon. */\n\t\tfor (i = 0, l = this.options.actions.length; i < l; i++) {\n\t\t\tAction = this._getActionConstructor(this.options.actions[i]);\n\n\t\t\taction = new Action();\n\t\t\taction._createIcon(this, this._ul, this._arguments);\n\t\t}\n\t},\n\n\t_getActionConstructor: function(Action) {\n\t\tvar args = this._arguments,\n\t\t\ttoolbar = this;\n\n\t\treturn Action.extend({\n\t\t\tinitialize: function() {\n\t\t\t\tAction.prototype.initialize.apply(this, args);\n\t\t\t},\n\t\t\tenable: function(e) {\n\t\t\t\t/* Ensure that only one action in a toolbar will be active at a time. */\n\t\t\t\tif (toolbar._active) { toolbar._active.disable(); }\n\t\t\t\ttoolbar._active = this;\n\n\t\t\t\tAction.prototype.enable.call(this, e);\n\t\t\t}\n\t\t});\n\t},\n\n\t/* Used to hide subToolbars without removing them from the map. */\n\t_hide: function() {\n\t\tthis._ul.style.display = 'none';\n\t},\n\n\t/* Used to show subToolbars without removing them from the map. */\n\t_show: function() {\n\t\tthis._ul.style.display = 'block';\n\t},\n\n\t_calculateDepth: function() {\n\t\tvar depth = 0,\n\t\t\ttoolbar = this.parentToolbar;\n\n\t\twhile (toolbar) {\n\t\t\tdepth += 1;\n\t\t\ttoolbar = toolbar.parentToolbar;\n\t\t}\n\n\t\treturn depth;\n\t}\n});\n\nL.toolbar = {};\n\nvar toolbar_class_id = 0;\n\nL.Toolbar.extend = function extend(props) {\n\tvar statics = L.extend({}, props.statics, {\n\t\t\"_toolbar_class_id\": toolbar_class_id\n\t});\n\n\ttoolbar_class_id += 1;\n\tL.extend(props, { statics: statics });\n\n\treturn L.Class.extend.call(this, props);\n};\n\nL.Map.addInitHook(function() {\n\tthis._toolbars = {};\n});\n\nL.ToolbarAction = L.Handler.extend({\n\tstatics: {\n\t\tbaseClass: 'leaflet-toolbar-icon'\n\t},\n\n\toptions: {\n\t\ttoolbarIcon: {\n\t\t\thtml: '',\n\t\t\tclassName: '',\n\t\t\ttooltip: ''\n\t\t},\n\t\tsubToolbar: new L.Toolbar()\n\t},\n\n\tinitialize: function(options) {\n\t\tvar defaultIconOptions = L.ToolbarAction.prototype.options.toolbarIcon;\n\n\t\tL.setOptions(this, options);\n\t\tthis.options.toolbarIcon = L.extend({}, defaultIconOptions, this.options.toolbarIcon);\n\t},\n\n\tenable: function(e) {\n\t\tif (e) { L.DomEvent.preventDefault(e); }\n\t\tif (this._enabled) { return; }\n\t\tthis._enabled = true;\n\n\t\tif (this.addHooks) { this.addHooks(); }\n\t},\n\n\tdisable: function() {\n\t\tif (!this._enabled) { return; }\n\t\tthis._enabled = false;\n\n\t\tif (this.removeHooks) { this.removeHooks(); }\n\t},\n\n\t_createIcon: function(toolbar, container, args) {\n\t\tvar iconOptions = this.options.toolbarIcon;\n\n\t\tthis.toolbar = toolbar;\n\t\tthis._icon = L.DomUtil.create('li', '', container);\n\t\tthis._link = L.DomUtil.create('a', '', this._icon);\n\n\t\tthis._link.innerHTML = iconOptions.html;\n\t\tthis._link.setAttribute('href', '#');\n\t\tthis._link.setAttribute('title', iconOptions.tooltip);\n\n\t\tL.DomUtil.addClass(this._link, this.constructor.baseClass);\n\t\tif (iconOptions.className) {\n\t\t\tL.DomUtil.addClass(this._link, iconOptions.className);\n\t\t}\n\n\t\tL.DomEvent.on(this._link, 'click', this.enable, this);\n\n\t\t/* Add secondary toolbar */\n\t\tthis._addSubToolbar(toolbar, this._icon, args);\n\t},\n\n\t_addSubToolbar: function(toolbar, container, args) {\n\t\tvar subToolbar = this.options.subToolbar,\n\t\t\taddHooks = this.addHooks,\n\t\t\tremoveHooks = this.removeHooks;\n\n\t\t/* For calculating the nesting depth. */\n\t\tsubToolbar.parentToolbar = toolbar;\n\n\t\tif (subToolbar.options.actions.length > 0) {\n\t\t\t/* Make a copy of args so as not to pollute the args array used by other actions. */\n\t\t\targs = [].slice.call(args);\n\t\t\targs.push(this);\n\n\t\t\tsubToolbar.addTo.apply(subToolbar, args);\n\t\t\tsubToolbar.appendToContainer(container);\n\n\t\t\tthis.addHooks = function(map) {\n\t\t\t\tif (typeof addHooks === 'function') { addHooks.call(this, map); }\n\t\t\t\tsubToolbar._show();\n\t\t\t};\n\n\t\t\tthis.removeHooks = function(map) {\n\t\t\t\tif (typeof removeHooks === 'function') { removeHooks.call(this, map); }\n\t\t\t\tsubToolbar._hide();\n\t\t\t};\n\t\t}\n\t}\n});\n\nL.toolbarAction = function toolbarAction(options) {\n\treturn new L.ToolbarAction(options);\n};\n\nL.ToolbarAction.extendOptions = function(options) {\n\treturn this.extend({ options: options });\n};\n\nL.Toolbar.Control = L.Toolbar.extend({\n\tstatics: {\n\t\tbaseClass: 'leaflet-control-toolbar ' + L.Toolbar.baseClass\n\t},\n\n\tinitialize: function(options) {\n\t\tL.Toolbar.prototype.initialize.call(this, options);\n\n\t\tthis._control = new L.Control.Toolbar(this.options);\n\t},\n\n\tonAdd: function(map) {\n\t\tthis._control.addTo(map);\n\n\t\tL.Toolbar.prototype.onAdd.call(this, map);\n\n\t\tthis.appendToContainer(this._control.getContainer());\n\t},\n\n\tonRemove: function(map) {\n\t\tL.Toolbar.prototype.onRemove.call(this, map);\n\t\tif (this._control.remove) {this._control.remove();}  // Leaflet 1.0\n\t\telse {this._control.removeFrom(map);}\n\t}\n});\n\nL.Control.Toolbar = L.Control.extend({\n\tonAdd: function() {\n\t\treturn L.DomUtil.create('div', '');\n\t}\n});\n\nL.toolbar.control = function(options) {\n    return new L.Toolbar.Control(options);\n};\n\n// A convenience class for built-in popup toolbars.\n\nL.Toolbar.Popup = L.Toolbar.extend({\n\tstatics: {\n\t\tbaseClass: 'leaflet-popup-toolbar ' + L.Toolbar.baseClass\n\t},\n\n\toptions: {\n\t\tanchor: [0, 0]\n\t},\n\n\tinitialize: function(latlng, options) {\n\t\tL.Toolbar.prototype.initialize.call(this, options);\n\n\t\t/* \n\t\t * Developers can't pass a DivIcon in the options for L.Toolbar.Popup\n\t\t * (the use of DivIcons is an implementation detail which may change).\n\t\t */\n\t\tthis._marker = new L.Marker(latlng, {\n\t\t\ticon : new L.DivIcon({\n\t\t\t\tclassName: this.options.className,\n\t\t\t\ticonAnchor: [0, 0]\n\t\t\t})\n\t\t});\n\t},\n\n\tonAdd: function(map) {\n\t\tthis._map = map;\n\t\tthis._marker.addTo(map);\n\n\t\tL.Toolbar.prototype.onAdd.call(this, map);\n\n\t\tthis.appendToContainer(this._marker._icon);\n\n\t\tthis._setStyles();\n\t},\n\n\tonRemove: function(map) {\n\t\tmap.removeLayer(this._marker);\n\n\t\tL.Toolbar.prototype.onRemove.call(this, map);\n\n\t\tdelete this._map;\n\t},\n\n\tsetLatLng: function(latlng) {\n\t\tthis._marker.setLatLng(latlng);\n\n\t\treturn this;\n\t},\n\n\t_setStyles: function() {\n\t\tvar container = this._container,\n\t\t\ttoolbar = this._ul,\n\t\t\tanchor = L.point(this.options.anchor),\n\t\t\ticons = toolbar.querySelectorAll('.leaflet-toolbar-icon'),\n\t\t\tbuttonHeights = [],\n\t\t\ttoolbarWidth = 0,\n\t\t\ttoolbarHeight,\n\t\t\ttipSize,\n\t\t\ttipAnchor;\n\n\t\t/* Calculate the dimensions of the toolbar. */\n\t\tfor (var i = 0, l = icons.length; i < l; i++) {\n\t\t\tif (icons[i].parentNode.parentNode === toolbar) {\n\t\t\t\tbuttonHeights.push(parseInt(L.DomUtil.getStyle(icons[i], 'height'), 10));\n\t\t\t\ttoolbarWidth += Math.ceil(parseFloat(L.DomUtil.getStyle(icons[i], 'width')));\n\t\t\t}\n\t\t}\n\t\ttoolbar.style.width = toolbarWidth + 'px';\n\n\t\t/* Create and place the toolbar tip. */\n\t\tthis._tipContainer = L.DomUtil.create('div', 'leaflet-toolbar-tip-container', container);\n\t\tthis._tipContainer.style.width = toolbarWidth + 'px';\n\n\t\tthis._tip = L.DomUtil.create('div', 'leaflet-toolbar-tip', this._tipContainer);\n\n\t\t/* Set the tipAnchor point. */\n\t\ttoolbarHeight = Math.max.apply(undefined, buttonHeights);\n\t\ttipSize = parseInt(L.DomUtil.getStyle(this._tip, 'width'), 10);\n\t\ttipAnchor = new L.Point(toolbarWidth/2, toolbarHeight + 0.7071*tipSize);\n\n\t\t/* The anchor option allows app developers to adjust the toolbar's position. */\n\t\tcontainer.style.marginLeft = (anchor.x - tipAnchor.x) + 'px';\n\t\tcontainer.style.marginTop = (anchor.y - tipAnchor.y) + 'px';\n\t}\n});\n\nL.toolbar.popup = function(options) {\n    return new L.Toolbar.Popup(options);\n};\n\n\n})(window, document);","/*\r\n * L.TileLayer.Zoomify display Zoomify tiles with Leaflet\r\n *\r\n * Based on the Leaflet.Zoomify (https://github.com/turban/Leaflet.Zoomify)\r\n * from turban (https://github.com/turban)\r\n *\r\n */\r\n\r\nL.TileLayer.Zoomify = L.TileLayer.extend({\r\n\toptions: {\r\n\t\twidth: -1, // Must be set by user, max zoom image width\r\n\t\theight: -1, // Must be set by user, max zoom image height\r\n\t\ttileGroupPrefix: 'TileGroup',\r\n\t\ttilesPerTileGroup: 256\r\n\t},\r\n\r\n\tinitialize: function (url, options) {\r\n\t\tL.TileLayer.prototype.initialize.call(this, url, options);\r\n\r\n\t\t// Replace with automatic loading from ImageProperties.xml\r\n\t\tif (this.options.width < 0 || this.options.height < 0) {\r\n\t\t\tthrow new Error('The user must set the Width and Height of the Zoomify image');\r\n\t\t}\r\n\t},\r\n\r\n\tbeforeAdd: function (map) {\r\n\t\tvar imageSize = L.point(this.options.width, this.options.height);\r\n\r\n\t\t// Build the zoom sizes of the pyramid and cache them in an array\r\n\t\tthis._imageSize = [imageSize];\r\n\t\tthis._gridSize = [this._getGridSize(imageSize)];\r\n\r\n\t\t// Register the image size in pixels and the grid size in # of tiles for each zoom level\r\n\t\twhile (imageSize.x > this.options.tileSize || imageSize.y > this.options.tileSize) {\r\n\t\t\timageSize = imageSize.divideBy(2).ceil();\r\n\t\t\tthis._imageSize.push(imageSize);\r\n\t\t\tthis._gridSize.push(this._getGridSize(imageSize));\r\n\t\t}\r\n\r\n\t\t// We built the cache from bottom to top, but leaflet uses a top to bottom index for the zoomlevel,\r\n\t\t// so reverse it for easy indexing by current zoomlevel\r\n\t\tthis._imageSize.reverse();\r\n\t\tthis._gridSize.reverse();\r\n\r\n\t\t// Register our max supported zoom level\r\n\t\tvar maxNativeZoom = this._gridSize.length - 1;\r\n\t\tthis.options.maxNativeZoom = maxNativeZoom;\r\n\r\n\t\t// Register our bounds for this zoomify layer based on the maximum zoom\r\n\t\tvar maxZoomGrid = this._gridSize[maxNativeZoom],\r\n\t\tmaxX = maxZoomGrid.x * this.options.tileSize,\r\n\t\tmaxY = maxZoomGrid.y * this.options.tileSize,\r\n\t\tsouthEast = map.unproject([maxX, maxY], maxNativeZoom);\r\n\t\tthis.options.bounds = new L.LatLngBounds([[0, 0], southEast]);\r\n\r\n\t\tL.TileLayer.prototype.beforeAdd.call(this, map);\r\n\t},\r\n\r\n\t// Calculate the grid size for a given image size (based on tile size)\r\n\t_getGridSize: function (imageSize) {\r\n\t\tvar tileSize = this.options.tileSize;\r\n\t\treturn L.point(Math.ceil(imageSize.x / tileSize), Math.ceil(imageSize.y / tileSize));\r\n\t},\r\n\r\n\t// Extend the add tile function to update our arbitrary sized border tiles\r\n\t_addTile: function (coords, container) {\r\n\t\t// Load the tile via the original leaflet code\r\n\t\tL.TileLayer.prototype._addTile.call(this, coords, container);\r\n\r\n\t\t// Get out imagesize in pixels for this zoom level and our grid size\r\n\t\tvar imageSize = this._imageSize[this._getZoomForUrl()],\r\n\t\t    gridSize = this._gridSize[this._getZoomForUrl()];\r\n\r\n\t\t// The real tile size (default:256) and the display tile size (if zoom > maxNativeZoom)\r\n\t\tvar realTileSize = L.GridLayer.prototype.getTileSize.call(this),\r\n\t\t    displayTileSize = L.TileLayer.prototype.getTileSize.call(this);\r\n\r\n\t\t// Get the current tile to adjust\r\n\t\tvar key = this._tileCoordsToKey(coords),\r\n\t\t    tile = this._tiles[key].el;\r\n\r\n\t\t// Calculate the required size of the border tiles\r\n\t\tvar scaleFactor = L.point(\t(imageSize.x % realTileSize.x),\r\n\t\t\t\t\t\t\t\t\t(imageSize.y % realTileSize.y)).unscaleBy(realTileSize);\r\n\r\n\t\t// Update tile dimensions if we are on a border\r\n\t\tif ((imageSize.x % realTileSize.x) > 0 && coords.x === gridSize.x - 1) {\r\n\t\t\ttile.style.width = displayTileSize.scaleBy(scaleFactor).x + 'px';\r\n\t\t}\r\n\r\n\t\tif ((imageSize.y % realTileSize.y) > 0 && coords.y === gridSize.y - 1) {\r\n\t\t\ttile.style.height = displayTileSize.scaleBy(scaleFactor).y + 'px';\r\n\t\t}\r\n\t},\r\n\r\n\t// Construct the tile url, by inserting our tilegroup before we template the url\r\n\tgetTileUrl: function (coords) {\r\n\t\t// Set our TileGroup variable, and then let the original tile templater do the work\r\n\t\tthis.options.g = this.options.tileGroupPrefix + this._getTileGroup(coords);\r\n\r\n\t\t// Call the original templater\r\n\t\treturn L.TileLayer.prototype.getTileUrl.call(this, coords);\r\n\t},\r\n\r\n\t// Calculates the TileGroup number, each group contains 256 tiles. The tiles are stored from topleft to bottomright\r\n\t_getTileGroup: function (coords) {\r\n\t\tvar zoom = this._getZoomForUrl(),\r\n\t\t    num = 0,\r\n\t\t    gridSize;\r\n\r\n\t\t// Get the total number of tiles from the lowest zoom level to our zoomlevel\r\n\t\tfor (var z = 0; z < zoom; z++) {\r\n\t\t\tgridSize = this._gridSize[z];\r\n\t\t\tnum += gridSize.x * gridSize.y;\r\n\t\t}\r\n\r\n\t\t// Add the remaining tiles from this zoom layer to the running total of tiles\r\n\t\tnum += coords.y * this._gridSize[zoom].x + coords.x;\r\n\t\treturn Math.floor(num / this.options.tilesPerTileGroup);\r\n\t},\r\n\r\n\tgetBounds: function () {\r\n\t\treturn this.options.bounds;\r\n\t}\r\n\r\n});\r\n\r\nL.tileLayer.zoomify = function (url, options) {\r\n\treturn new L.TileLayer.Zoomify(url, options);\r\n};\r\n","/*\n* L.Handler.UrlView is used by L.Map to update the current position in the url as parameters\n*/\n\nL.Util.parseParamString = function (searchUrl) {\n\tif (searchUrl[0] !== '?') {\n\t\treturn {};\n\t}\n\n\tvar parsedParams = {};\n\n\tsearchUrl.substring(1).split('&').forEach(function (paramPair) {\n\t\tvar splitPair = paramPair.split('='),\n\t\tkey = decodeURIComponent(splitPair[0]),\n\t\tvalue = splitPair.length === 2 ? decodeURIComponent(splitPair[1]) : true;\n\n\t\tparsedParams[key] = value;\n\t});\n\n\treturn parsedParams;\n};\n\nL.Map.UrlView = L.Handler.extend({\n\taddHooks: function () {\n\t\t// Only set a view if it has not been set yet\n\t\tif (!this.viewLoaded()) {\n\t\t\tthis._trySetView();\n\t\t}\n\t\tthis._map.on('moveend', this._onMapMoved, this);\n\t},\n\n\tremoveHooks: function () {\n\t\tthis._map.off('moveend', this._onMapMoved, this);\n\t},\n\n\t_trySetView: function () {\n\t\tvar urlViewParams = L.Util.parseParamString(window.location.search);\n\n\t\ttry {\n\t\t\tvar center = new L.LatLng(urlViewParams.lat, urlViewParams.lng),\n\t\t\tzoom = urlViewParams.zoom;\n\t\t} catch (e) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (center && zoom >= 0)  {\n\t\t\tthis._map.setView(center, zoom, {reset: true});\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t},\n\n\tviewLoaded: function () {\n\t\ttry {\n\t\t\tthis._map.getCenter();\n\t\t\treturn true;\n\t\t} catch (e) {\n\t\t\treturn false;\n\t\t}\n\t},\n\n\t_onMapMoved: function () {\n\t\tvar urlParams = L.Util.parseParamString(window.location.search),\n\t\tmapView = this._getMapView();\n\n\t\tthis._updateSearchLocation(L.Util.getParamString(L.extend(urlParams, mapView)));\n\t},\n\n\t_updateSearchLocation: function (searchLocation) {\n\t\twindow.history.replaceState(null, null, searchLocation);\n\t},\n\n\t_getMapView: function () {\n\t\tvar mapCenter = this._map.getCenter(),\n\t\tmapZoom = this._map.getZoom(),\n\t\tprecision = this.getLatLngPrecision();\n\n\t\treturn {\n\t\t\tzoom: mapZoom,\n\t\t\tlat: mapCenter.lat.toFixed(precision.lat),\n\t\t\tlng: mapCenter.lng.toFixed(precision.lng)\n\t\t};\n\t},\n\n\t// Calculate the precision required to set our view accurately again\n\tgetLatLngPrecision: function () {\n\t\t// Get distance of a single pixel in the current view in LatLng coordinates\n\t\tvar latLng1 = this._map.getCenter(),\n\t\tlatLng2 = this._map.unproject(this._map.project(latLng1).add(L.point(1, 1))),\n\t\tpixelLatLng = L.point([\n\t\t\tMath.abs(latLng1.lng - latLng2.lng),\n\t\t\tMath.abs(latLng1.lat - latLng2.lat)\n\t\t]);\n\n\t\t// Calculate number of decimals of this difference\n\t\tvar latPrecision = Math.floor(Math.log(pixelLatLng.x) / Math.log(10)),\n\t\tlngPrecision = Math.floor(Math.log(pixelLatLng.y) / Math.log(10));\n\n\t\tlatPrecision = Math.max(1, -latPrecision);\n\t\tlngPrecision = Math.max(1, -lngPrecision);\n\n\t\treturn {\n\t\t\tlat: latPrecision,\n\t\t\tlng: lngPrecision\n\t\t};\n\t}\n});\n\nL.Map.mergeOptions({\n\turlView: false\n});\n\nif (window.history && window.history.replaceState && L.Util.parseParamString) {\n\tL.Map.addInitHook('addHandler', 'urlView', L.Map.UrlView);\n}\n","'use strict';\n(function (factory, window) {\n    /*globals define, module, require*/\n\n    // define an AMD module that relies on 'leaflet'\n    if (typeof define === 'function' && define.amd) {\n        define(['leaflet'], factory);\n\n\n    // define a Common JS module that relies on 'leaflet'\n    } else if (typeof exports === 'object') {\n        module.exports = factory(require('leaflet'));\n    }\n\n    // attach your plugin to the global 'L' variable\n    if(typeof window !== 'undefined' && window.L){\n        factory(window.L);\n    }\n\n}(function (L) {\n    L.Editable = L.Evented.extend({\n\n        statics: {\n            FORWARD: 1,\n            BACKWARD: -1\n        },\n\n        options: {\n            zIndex: 1000,\n            polygonClass: L.Polygon,\n            polylineClass: L.Polyline,\n            markerClass: L.Marker,\n            drawingCSSClass: 'leaflet-editable-drawing',\n            drawingCursor: 'crosshair'\n        },\n\n        initialize: function (map, options) {\n            L.setOptions(this, options);\n            this._lastZIndex = this.options.zIndex;\n            this.map = map;\n            this.editLayer = this.createEditLayer();\n            this.featuresLayer = this.createFeaturesLayer();\n            this.forwardLineGuide = this.createLineGuide();\n            this.backwardLineGuide = this.createLineGuide();\n        },\n\n        fireAndForward: function (type, e) {\n            e = e || {};\n            e.editTools = this;\n            this.fire(type, e);\n            this.map.fire(type, e);\n        },\n\n        createLineGuide: function () {\n            var options = L.extend({dashArray: '5,10', weight: 1}, this.options.lineGuideOptions);\n            return L.polyline([], options);\n        },\n\n        createVertexIcon: function (options) {\n            return L.Browser.touch ? new L.Editable.TouchVertexIcon(options) : new L.Editable.VertexIcon(options);\n        },\n\n        createEditLayer: function () {\n            return this.options.editLayer || new L.LayerGroup().addTo(this.map);\n        },\n\n        createFeaturesLayer: function () {\n            return this.options.featuresLayer || new L.LayerGroup().addTo(this.map);\n        },\n\n        moveForwardLineGuide: function (latlng) {\n            if (this.forwardLineGuide._latlngs.length) {\n                this.forwardLineGuide._latlngs[1] = latlng;\n                this.forwardLineGuide._bounds.extend(latlng);\n                this.forwardLineGuide.redraw();\n            }\n        },\n\n        moveBackwardLineGuide: function (latlng) {\n            if (this.backwardLineGuide._latlngs.length) {\n                this.backwardLineGuide._latlngs[1] = latlng;\n                this.backwardLineGuide._bounds.extend(latlng);\n                this.backwardLineGuide.redraw();\n            }\n        },\n\n        anchorForwardLineGuide: function (latlng) {\n            this.forwardLineGuide._latlngs[0] = latlng;\n            this.forwardLineGuide._bounds.extend(latlng);\n            this.forwardLineGuide.redraw();\n        },\n\n        anchorBackwardLineGuide: function (latlng) {\n            this.backwardLineGuide._latlngs[0] = latlng;\n            this.backwardLineGuide._bounds.extend(latlng);\n            this.backwardLineGuide.redraw();\n        },\n\n        attachForwardLineGuide: function () {\n            this.editLayer.addLayer(this.forwardLineGuide);\n        },\n\n        attachBackwardLineGuide: function () {\n            this.editLayer.addLayer(this.backwardLineGuide);\n        },\n\n        detachForwardLineGuide: function () {\n            this.forwardLineGuide._latlngs = [];\n            this.editLayer.removeLayer(this.forwardLineGuide);\n        },\n\n        detachBackwardLineGuide: function () {\n            this.backwardLineGuide._latlngs = [];\n            this.editLayer.removeLayer(this.backwardLineGuide);\n        },\n\n        registerForDrawing: function (editor) {\n            this.map.on('mousemove touchmove', editor.onMouseMove, editor);\n            if (this._drawingEditor) this.unregisterForDrawing(this._drawingEditor);\n            this._drawingEditor = editor;\n            this.map.on('mousedown', this.onMousedown, this);\n            this.map.on('mouseup', this.onMouseup, this);\n            L.DomUtil.addClass(this.map._container, this.options.drawingCSSClass);\n            this.defaultMapCursor = this.map._container.style.cursor;\n            this.map._container.style.cursor = this.options.drawingCursor;\n        },\n\n        unregisterForDrawing: function (editor) {\n            L.DomUtil.removeClass(this.map._container, this.options.drawingCSSClass);\n            this.map._container.style.cursor = this.defaultMapCursor;\n            editor = editor || this._drawingEditor;\n            if (!editor) return;\n            this.map.off('mousemove touchmove', editor.onMouseMove, editor);\n            this.map.off('mousedown', this.onMousedown, this);\n            this.map.off('mouseup', this.onMouseup, this);\n            if (editor !== this._drawingEditor) return;\n            delete this._drawingEditor;\n            if (editor._drawing) editor.cancelDrawing();\n        },\n\n        onMousedown: function (e) {\n            this._mouseDown = e;\n        },\n\n        onMouseup: function (e) {\n            if (this._mouseDown) {\n                var origin = L.point(this._mouseDown.originalEvent.clientX, this._mouseDown.originalEvent.clientY);\n                var distance = L.point(e.originalEvent.clientX, e.originalEvent.clientY)\n                    .distanceTo(origin);\n                if (Math.abs(distance) < 9 * (window.devicePixelRatio || 1)) {\n                    this._drawingEditor.onDrawingClick(e);\n                }\n            }\n            this._mouseDown = null;\n        },\n\n        drawing: function () {\n            return this._drawingEditor && this._drawingEditor.drawing();\n        },\n\n        stopDrawing: function () {\n            this.unregisterForDrawing();\n        },\n\n        commitDrawing: function (e) {\n            if (!this._drawingEditor) return;\n            this._drawingEditor.commitDrawing(e);\n        },\n\n        connectCreatedToMap: function (layer) {\n            return this.featuresLayer.addLayer(layer);\n        },\n\n        startPolyline: function (latlng, options) {\n            var line = this.createPolyline([], options);\n            this.connectCreatedToMap(line);\n            line.enableEdit().newShape(latlng);\n            return line;\n        },\n\n        startPolygon: function (latlng, options) {\n            var polygon = this.createPolygon([], options);\n            this.connectCreatedToMap(polygon);\n            polygon.enableEdit().newShape(latlng);\n            return polygon;\n        },\n\n        startMarker: function (latlng, options) {\n            latlng = latlng || this.map.getCenter();\n            var marker = this.createMarker(latlng, options);\n            this.connectCreatedToMap(marker);\n            var editor = marker.enableEdit();\n            editor.startDrawing();\n            return marker;\n        },\n\n        startHole: function (editor, latlng) {\n            editor.newHole(latlng);\n        },\n\n        createPolyline: function (latlngs, options) {\n            options = L.Util.extend({editOptions: {editTools: this}}, options);\n            var line = new this.options.polylineClass(latlngs, options);\n            this.fireAndForward('editable:created', {layer: line});\n            return line;\n        },\n\n        createPolygon: function (latlngs, options) {\n            options = L.Util.extend({editOptions: {editTools: this}}, options);\n            var polygon = new this.options.polygonClass(latlngs, options);\n            this.fireAndForward('editable:created', {layer: polygon});\n            return polygon;\n        },\n\n        createMarker: function (latlng, options) {\n            options = L.Util.extend({editOptions: {editTools: this}}, options);\n            var marker = new this.options.markerClass(latlng, options);\n            this.fireAndForward('editable:created', {layer: marker});\n            return marker;\n        }\n\n    });\n\n    L.extend(L.Editable, {\n\n        makeCancellable: function (e) {\n            e.cancel = function () {\n                e._cancelled = true;\n            };\n        }\n\n    });\n\n    L.Map.mergeOptions({\n        editToolsClass: L.Editable\n    });\n\n    L.Map.addInitHook(function () {\n\n        this.whenReady(function () {\n            if (this.options.editable) {\n                this.editTools = new this.options.editToolsClass(this, this.options.editOptions);\n            }\n        });\n\n    });\n\n    L.Editable.VertexIcon = L.DivIcon.extend({\n\n        options: {\n            iconSize: new L.Point(8, 8)\n        }\n\n    });\n\n    L.Editable.TouchVertexIcon = L.Editable.VertexIcon.extend({\n\n        options: {\n            iconSize: new L.Point(20, 20)\n        }\n\n    });\n\n\n    L.Editable.VertexMarker = L.Marker.extend({\n\n        options: {\n            draggable: true,\n            className: 'leaflet-div-icon leaflet-vertex-icon'\n        },\n\n        initialize: function (latlng, latlngs, editor, options) {\n            this.latlng = latlng;\n            this.latlngs = latlngs;\n            this.editor = editor;\n            L.Marker.prototype.initialize.call(this, latlng, options);\n            this.options.icon = this.editor.tools.createVertexIcon({className: this.options.className});\n            this.latlng.__vertex = this;\n            this.editor.editLayer.addLayer(this);\n            this.setZIndexOffset(editor.tools._lastZIndex + 1);\n        },\n\n        onAdd: function (map) {\n            L.Marker.prototype.onAdd.call(this, map);\n            this.on('drag', this.onDrag);\n            this.on('dragstart', this.onDragStart);\n            this.on('dragend', this.onDragEnd);\n            this.on('mouseup', this.onMouseup);\n            this.on('click', this.onClick);\n            this.on('contextmenu', this.onContextMenu);\n            this.on('mousedown touchstart', this.onMouseDown);\n            this.addMiddleMarkers();\n        },\n\n        onRemove: function (map) {\n            if (this.middleMarker) this.middleMarker.delete();\n            delete this.latlng.__vertex;\n            this.off('drag', this.onDrag);\n            this.off('dragstart', this.onDragStart);\n            this.off('dragend', this.onDragEnd);\n            this.off('mouseup', this.onMouseup);\n            this.off('click', this.onClick);\n            this.off('contextmenu', this.onContextMenu);\n            this.off('mousedown touchstart', this.onMouseDown);\n            L.Marker.prototype.onRemove.call(this, map);\n        },\n\n        onDrag: function (e) {\n            e.vertex = this;\n            this.editor.onVertexMarkerDrag(e);\n            var iconPos = L.DomUtil.getPosition(this._icon),\n                latlng = this._map.layerPointToLatLng(iconPos);\n            this.latlng.lat = latlng.lat;\n            this.latlng.lng = latlng.lng;\n            this.editor.refresh();\n            if (this.middleMarker) {\n                this.middleMarker.updateLatLng();\n            }\n            var next = this.getNext();\n            if (next && next.middleMarker) {\n                next.middleMarker.updateLatLng();\n            }\n        },\n\n        onDragStart: function (e) {\n            e.vertex = this;\n            this.editor.onVertexMarkerDragStart(e);\n        },\n\n        onDragEnd: function (e) {\n            e.vertex = this;\n            this.editor.onVertexMarkerDragEnd(e);\n        },\n\n        onClick: function (e) {\n            e.vertex = this;\n            this.editor.onVertexMarkerClick(e);\n        },\n\n        onMouseup: function (e) {\n            L.DomEvent.stop(e);\n            e.vertex = this;\n            this.editor.map.fire('mouseup', e);\n        },\n\n        onContextMenu: function (e) {\n            e.vertex = this;\n            this.editor.onVertexMarkerContextMenu(e);\n        },\n\n        onMouseDown: function (e) {\n            e.vertex = this;\n            this.editor.onVertexMarkerMouseDown(e);\n        },\n\n        delete: function () {\n            var next = this.getNext();  // Compute before changing latlng\n            this.latlngs.splice(this.latlngs.indexOf(this.latlng), 1);\n            this.editor.editLayer.removeLayer(this);\n            this.editor.onVertexDeleted({latlng: this.latlng, vertex: this});\n            if (!this.latlngs.length) this.editor.deleteShape(this.latlngs);\n            if (next) next.resetMiddleMarker();\n            this.editor.refresh();\n        },\n\n        getIndex: function () {\n            return this.latlngs.indexOf(this.latlng);\n        },\n\n        getLastIndex: function () {\n            return this.latlngs.length - 1;\n        },\n\n        getPrevious: function () {\n            if (this.latlngs.length < 2) return;\n            var index = this.getIndex(),\n                previousIndex = index - 1;\n            if (index === 0 && this.editor.CLOSED) previousIndex = this.getLastIndex();\n            var previous = this.latlngs[previousIndex];\n            if (previous) return previous.__vertex;\n        },\n\n        getNext: function () {\n            if (this.latlngs.length < 2) return;\n            var index = this.getIndex(),\n                nextIndex = index + 1;\n            if (index === this.getLastIndex() && this.editor.CLOSED) nextIndex = 0;\n            var next = this.latlngs[nextIndex];\n            if (next) return next.__vertex;\n        },\n\n        addMiddleMarker: function (previous) {\n            if (this.editor.tools.options.skipMiddleMarkers) return;\n            previous = previous || this.getPrevious();\n            if (previous && !this.middleMarker) this.middleMarker = this.editor.addMiddleMarker(previous, this, this.latlngs, this.editor);\n        },\n\n        addMiddleMarkers: function () {\n            if (this.editor.tools.options.skipMiddleMarkers) return;\n            var previous = this.getPrevious();\n            if (previous) {\n                this.addMiddleMarker(previous);\n            }\n            var next = this.getNext();\n            if (next) {\n                next.resetMiddleMarker();\n            }\n        },\n\n        resetMiddleMarker: function () {\n            if (this.middleMarker) this.middleMarker.delete();\n            this.addMiddleMarker();\n        },\n\n        split: function () {\n            if (!this.editor.splitShape) return;  // Only for PolylineEditor\n            this.editor.splitShape(this.latlngs, this.getIndex());\n        },\n\n        continue: function () {\n            if (!this.editor.continueBackward) return;  // Only for PolylineEditor\n            var index = this.getIndex();\n            if (index === 0) this.editor.continueBackward(this.latlngs);\n            else if (index === this.getLastIndex()) this.editor.continueForward(this.latlngs);\n        }\n\n    });\n\n    L.Editable.mergeOptions({\n        vertexMarkerClass: L.Editable.VertexMarker\n    });\n\n    L.Editable.MiddleMarker = L.Marker.extend({\n\n        options: {\n            opacity: 0.5,\n            className: 'leaflet-div-icon leaflet-middle-icon',\n            draggable: true\n        },\n\n        initialize: function (left, right, latlngs, editor, options) {\n            this.left = left;\n            this.right = right;\n            this.editor = editor;\n            this.latlngs = latlngs;\n            L.Marker.prototype.initialize.call(this, this.computeLatLng(), options);\n            this._opacity = this.options.opacity;\n            this.options.icon = this.editor.tools.createVertexIcon({className: this.options.className});\n            this.editor.editLayer.addLayer(this);\n            this.setVisibility();\n        },\n\n        setVisibility: function () {\n            var leftPoint = this._map.latLngToContainerPoint(this.left.latlng),\n                rightPoint = this._map.latLngToContainerPoint(this.right.latlng),\n                size = L.point(this.options.icon.options.iconSize);\n            if (leftPoint.distanceTo(rightPoint) < size.x * 3) {\n                this.hide();\n            } else {\n                this.show();\n            }\n        },\n\n        show: function () {\n            this.setOpacity(this._opacity);\n        },\n\n        hide: function () {\n            this.setOpacity(0);\n        },\n\n        updateLatLng: function () {\n            this.setLatLng(this.computeLatLng());\n            this.setVisibility();\n        },\n\n        computeLatLng: function () {\n            var leftPoint = this.editor.map.latLngToContainerPoint(this.left.latlng),\n                rightPoint = this.editor.map.latLngToContainerPoint(this.right.latlng),\n                y = (leftPoint.y + rightPoint.y) / 2,\n                x = (leftPoint.x + rightPoint.x) / 2;\n            return this.editor.map.containerPointToLatLng([x, y]);\n        },\n\n        onAdd: function (map) {\n            L.Marker.prototype.onAdd.call(this, map);\n            L.DomEvent.on(this._icon, 'mousedown touchstart', this.onMouseDown, this);\n            map.on('zoomend', this.setVisibility, this);\n        },\n\n        onRemove: function (map) {\n            delete this.right.middleMarker;\n            L.DomEvent.off(this._icon, 'mousedown touchstart', this.onMouseDown, this);\n            map.off('zoomend', this.setVisibility, this);\n            L.Marker.prototype.onRemove.call(this, map);\n        },\n\n        onMouseDown: function (e) {\n            var iconPos = L.DomUtil.getPosition(this._icon),\n                latlng = this.editor.map.layerPointToLatLng(iconPos);\n            e = {\n                originalEvent: e,\n                latlng: latlng\n            };\n            if (this.options.opacity === 0) return;\n            L.Editable.makeCancellable(e);\n            this.editor.onMiddleMarkerMouseDown(e);\n            if (e._cancelled) return;\n            this.latlngs.splice(this.index(), 0, e.latlng);\n            this.editor.refresh();\n            var icon = this._icon;\n            var marker = this.editor.addVertexMarker(e.latlng, this.latlngs);\n            /* Hack to workaround browser not firing touchend when element is no more on DOM */\n            var parent = marker._icon.parentNode;\n            parent.removeChild(marker._icon);\n            marker._icon = icon;\n            parent.appendChild(marker._icon);\n            marker._initIcon();\n            marker._initInteraction();\n            marker.setOpacity(1);\n            /* End hack */\n            // Transfer ongoing dragging to real marker\n            L.Draggable._dragging = false;\n            marker.dragging._draggable._onDown(e.originalEvent);\n            this.delete();\n        },\n\n        delete: function () {\n            this.editor.editLayer.removeLayer(this);\n        },\n\n        index: function () {\n            return this.latlngs.indexOf(this.right.latlng);\n        }\n\n    });\n\n    L.Editable.mergeOptions({\n        middleMarkerClass: L.Editable.MiddleMarker\n    });\n\n    L.Editable.BaseEditor = L.Class.extend({\n\n        initialize: function (map, feature, options) {\n            L.setOptions(this, options);\n            this.map = map;\n            this.feature = feature;\n            this.feature.editor = this;\n            this.editLayer = new L.LayerGroup();\n            this.tools = this.options.editTools || map.editTools;\n        },\n\n        enable: function () {\n            if (this._enabled) return this;\n            this.tools.editLayer.addLayer(this.editLayer);\n            this.onEnable();\n            this._enabled = true;\n            this.feature.on('remove', this.disable, this);\n            return this;\n        },\n\n        disable: function () {\n            this.feature.off('remove', this.disable, this);\n            this.editLayer.clearLayers();\n            this.tools.editLayer.removeLayer(this.editLayer);\n            this.onDisable();\n            delete this._enabled;\n            if (this._drawing) this.cancelDrawing();\n            return this;\n        },\n\n        drawing: function () {\n            return !!this._drawing;\n        },\n\n        fireAndForward: function (type, e) {\n            e = e || {};\n            e.layer = this.feature;\n            this.feature.fire(type, e);\n            this.tools.fireAndForward(type, e);\n        },\n\n        onEnable: function () {\n            this.fireAndForward('editable:enable');\n        },\n\n        onDisable: function () {\n            this.fireAndForward('editable:disable');\n        },\n\n        onEditing: function () {\n            this.fireAndForward('editable:editing');\n        },\n\n        onStartDrawing: function () {\n            this.fireAndForward('editable:drawing:start');\n        },\n\n        onEndDrawing: function () {\n            this.fireAndForward('editable:drawing:end');\n        },\n\n        onCancelDrawing: function () {\n            this.fireAndForward('editable:drawing:cancel');\n        },\n\n        onCommitDrawing: function (e) {\n            this.fireAndForward('editable:drawing:commit', e);\n        },\n\n        startDrawing: function () {\n            if (!this._drawing) this._drawing = L.Editable.FORWARD;\n            this.tools.registerForDrawing(this);\n            this.onStartDrawing();\n        },\n\n        commitDrawing: function (e) {\n            this.onCommitDrawing(e);\n            this.endDrawing();\n        },\n\n        cancelDrawing: function () {\n            this.onCancelDrawing();\n            this.endDrawing();\n        },\n\n        endDrawing: function () {\n            this._drawing = false;\n            this.tools.unregisterForDrawing(this);\n            this.onEndDrawing();\n        },\n\n        onDrawingClick: function (e) {\n            if (!this.drawing) return;\n            L.Editable.makeCancellable(e);\n            this.fireAndForward('editable:drawing:click', e);\n            if (e._cancelled) return;\n            this.processDrawingClick(e);\n        },\n\n        onMove: function (e) {\n            this.fireAndForward('editable:drawing:move', e);\n        },\n\n        onMouseMove: function (e) {\n            this.onMove(e);\n        }\n\n    });\n\n    L.Editable.MarkerEditor = L.Editable.BaseEditor.extend({\n\n        enable: function () {\n            if (this._enabled) return this;\n            L.Editable.BaseEditor.prototype.enable.call(this);\n            this.feature.dragging.enable();\n            this.feature.on('dragstart', this.onEditing, this);\n            this.feature.on('drag', this.onMove, this);\n            return this;\n        },\n\n        disable: function () {\n            L.Editable.BaseEditor.prototype.disable.call(this);\n            this.feature.dragging.disable();\n            this.feature.off('dragstart', this.onEditing, this);\n            this.feature.off('drag', this.onMove, this);\n            return this;\n        },\n\n        onMouseMove: function (e) {\n            L.Editable.BaseEditor.prototype.onMouseMove.call(this, e);\n            if (this._drawing) {\n                this.feature.setLatLng(e.latlng);\n            }\n        },\n\n        processDrawingClick: function (e) {\n            this.fireAndForward('editable:drawing:clicked', e);\n            this.commitDrawing(e);\n        }\n\n    });\n\n    L.Editable.PathEditor = L.Editable.BaseEditor.extend({\n\n        CLOSED: false,\n        MIN_VERTEX: 2,\n\n        enable: function () {\n            if (this._enabled) return this;\n            L.Editable.BaseEditor.prototype.enable.call(this);\n            if (this.feature) {\n                this.initVertexMarkers();\n            }\n            return this;\n        },\n\n        disable: function () {\n            return L.Editable.BaseEditor.prototype.disable.call(this);\n        },\n\n        initVertexMarkers: function (latlngs) {\n            latlngs = latlngs || this.getLatLngs();\n            if (L.Polyline._flat(latlngs)) {\n                this.addVertexMarkers(latlngs);\n            } else {\n                for (var i = 0; i < latlngs.length; i++) {\n                    this.initVertexMarkers(latlngs[i]);\n                }\n            }\n        },\n\n        getLatLngs: function () {\n            return this.feature.getLatLngs();\n        },\n\n        reset: function () {\n            this.editLayer.clearLayers();\n            this.initVertexMarkers();\n        },\n\n        addVertexMarker: function (latlng, latlngs) {\n            return new this.tools.options.vertexMarkerClass(latlng, latlngs, this);\n        },\n\n        addVertexMarkers: function (latlngs) {\n            for (var i = 0; i < latlngs.length; i++) {\n                this.addVertexMarker(latlngs[i], latlngs);\n            }\n        },\n\n        addMiddleMarker: function (left, right, latlngs) {\n            return new this.tools.options.middleMarkerClass(left, right, latlngs, this);\n        },\n\n        onVertexMarkerClick: function (e) {\n            L.Editable.makeCancellable(e);\n            this.fireAndForward('editable:vertex:click', e);\n            if (e._cancelled) return;\n            if (this.tools.drawing() && this.tools._drawingEditor !== this) return;\n            var index = e.vertex.getIndex(), commit;\n            if (e.originalEvent.ctrlKey) {\n                this.onVertexMarkerCtrlClick(e);\n            } else if (e.originalEvent.altKey) {\n                this.onVertexMarkerAltClick(e);\n            } else if (e.originalEvent.shiftKey) {\n                this.onVertexMarkerShiftClick(e);\n            } else if (e.originalEvent.metaKey) {\n                this.onVertexMarkerMetaKeyClick(e);\n            } else if (index === e.vertex.getLastIndex() && this._drawing === L.Editable.FORWARD) {\n                if (index >= this.MIN_VERTEX - 1) commit = true;\n            } else if (index === 0 && this._drawing === L.Editable.BACKWARD && this._drawnLatLngs.length >= this.MIN_VERTEX) {\n                commit = true;\n            } else if (index === 0 && this._drawing === L.Editable.FORWARD && this._drawnLatLngs.length >= this.MIN_VERTEX && this.CLOSED) {\n                commit = true;  // Allow to close on first point also for polygons\n            } else {\n                this.onVertexRawMarkerClick(e);\n            }\n            this.fireAndForward('editable:vertex:clicked', e);\n            if (commit) this.commitDrawing(e);\n        },\n\n        onVertexRawMarkerClick: function (e) {\n            this.fireAndForward('editable:vertex:rawclick', e);\n            if (e._cancelled) return;\n            if (!this.vertexCanBeDeleted(e.vertex)) return;\n            e.vertex.delete();\n        },\n\n        vertexCanBeDeleted: function (vertex) {\n            return vertex.latlngs.length > this.MIN_VERTEX;\n        },\n\n        onVertexDeleted: function (e) {\n            this.fireAndForward('editable:vertex:deleted', e);\n        },\n\n        onVertexMarkerCtrlClick: function (e) {\n            this.fireAndForward('editable:vertex:ctrlclick', e);\n        },\n\n        onVertexMarkerShiftClick: function (e) {\n            this.fireAndForward('editable:vertex:shiftclick', e);\n        },\n\n        onVertexMarkerMetaKeyClick: function (e) {\n            this.fireAndForward('editable:vertex:metakeyclick', e);\n        },\n\n        onVertexMarkerAltClick: function (e) {\n            this.fireAndForward('editable:vertex:altclick', e);\n        },\n\n        onVertexMarkerContextMenu: function (e) {\n            this.fireAndForward('editable:vertex:contextmenu', e);\n        },\n\n        onVertexMarkerMouseDown: function (e) {\n            this.fireAndForward('editable:vertex:mousedown', e);\n        },\n\n        onMiddleMarkerMouseDown: function (e) {\n            this.fireAndForward('editable:middlemarker:mousedown', e);\n        },\n\n        onVertexMarkerDrag: function (e) {\n            this.onMove(e);\n            this.feature._bounds.extend(e.vertex._latlng);\n            this.fireAndForward('editable:vertex:drag', e);\n        },\n\n        onVertexMarkerDragStart: function (e) {\n            this.fireAndForward('editable:vertex:dragstart', e);\n        },\n\n        onVertexMarkerDragEnd: function (e) {\n            this.fireAndForward('editable:vertex:dragend', e);\n        },\n\n        setDrawnLatLngs: function (latlngs) {\n            this._drawnLatLngs = latlngs || this.getDefaultLatLngs();\n        },\n\n        startDrawing: function () {\n            if (!this._drawnLatLngs) this.setDrawnLatLngs();\n            L.Editable.BaseEditor.prototype.startDrawing.call(this);\n        },\n\n        startDrawingForward: function () {\n            this.startDrawing();\n            this.tools.attachForwardLineGuide();\n        },\n\n        endDrawing: function () {\n            this.tools.detachForwardLineGuide();\n            this.tools.detachBackwardLineGuide();\n            if (this._drawnLatLngs && this._drawnLatLngs.length < this.MIN_VERTEX) this.deleteShape(this._drawnLatLngs);\n            L.Editable.BaseEditor.prototype.endDrawing.call(this);\n            delete this._drawnLatLngs;\n        },\n\n        addLatLng: function (latlng) {\n            if (this._drawing === L.Editable.FORWARD) this._drawnLatLngs.push(latlng);\n            else this._drawnLatLngs.unshift(latlng);\n            this.feature._bounds.extend(latlng);\n            this.addVertexMarker(latlng, this._drawnLatLngs);\n            this.refresh();\n        },\n\n        newPointForward: function (latlng) {\n            this.addLatLng(latlng);\n            this.tools.anchorForwardLineGuide(latlng);\n            if (!this.tools.backwardLineGuide._latlngs[0]) {\n                this.tools.anchorBackwardLineGuide(latlng);\n            }\n        },\n\n        newPointBackward: function (latlng) {\n            this.addLatLng(latlng);\n            this.tools.anchorBackwardLineGuide(latlng);\n        },\n\n        push: function (latlng) {\n            if (!latlng) return console.error('L.Editable.PathEditor.push expect a vaild latlng as parameter');\n            if (this._drawing === L.Editable.FORWARD) this.newPointForward(latlng);\n            else this.newPointBackward(latlng);\n        },\n\n        removeLatLng: function (latlng) {\n            latlng.__vertex.delete();\n            this.refresh();\n        },\n\n        pop: function () {\n            if (this._drawnLatLngs.length <= 1) return;\n            var latlng;\n            if (this._drawing === L.Editable.FORWARD) latlng = this._drawnLatLngs[this._drawnLatLngs.length - 1];\n            else latlng = this._drawnLatLngs[0];\n            this.removeLatLng(latlng);\n            if (this._drawing === L.Editable.FORWARD) this.tools.anchorForwardLineGuide(this._drawnLatLngs[this._drawnLatLngs.length - 1]);\n            else this.tools.anchorForwardLineGuide(this._drawnLatLngs[0]);\n            return latlng;\n        },\n\n        processDrawingClick: function (e) {\n            if (e.vertex && e.vertex.editor === this) return;\n            if (this._drawing === L.Editable.FORWARD) this.newPointForward(e.latlng);\n            else this.newPointBackward(e.latlng);\n            this.fireAndForward('editable:drawing:clicked', e);\n        },\n\n        onMouseMove: function (e) {\n            L.Editable.BaseEditor.prototype.onMouseMove.call(this, e);\n            if (this._drawing) {\n                this.tools.moveForwardLineGuide(e.latlng);\n                this.tools.moveBackwardLineGuide(e.latlng);\n            }\n        },\n\n        refresh: function () {\n            this.feature.redraw();\n            this.onEditing();\n        },\n\n        newShape: function (latlng) {\n            var shape = this.addNewEmptyShape();\n            if (!shape) return;\n            this.setDrawnLatLngs(shape[0] || shape);  // Polygon or polyline\n            this.startDrawingForward();\n            this.fireAndForward('editable:shape:new', {shape: shape});\n            if (latlng) this.newPointForward(latlng);\n        },\n\n        deleteShape: function (shape, latlngs) {\n            latlngs = latlngs || this.getLatLngs();\n            if (!latlngs.length) return;\n            var e, self = this,\n                inplaceDelete = function (latlngs, shape) {\n                    // Called when deleting a flat latlngs\n                    shape = latlngs.splice(0, Number.MAX_VALUE);\n                    return shape;\n                },\n                spliceDelete = function (latlngs, shape) {\n                    // Called when removing a latlngs inside an array\n                    latlngs.splice(latlngs.indexOf(shape), 1);\n                    return shape;\n                },\n                doDelete = function (callback, shape) {\n                    e = {shape: shape};\n                    L.Editable.makeCancellable(e);\n                    self.fireAndForward('editable:shape:delete', e);\n                    if (e._cancelled) return;\n                    shape = callback(latlngs, shape);\n                    if (self.ensureNotFlat) self.ensureNotFlat();  // Polygon\n                    self.refresh();\n                    self.reset();\n                    self.fireAndForward('editable:shape:deleted', {shape: shape});\n                    return shape;\n                };\n            if (latlngs === shape) return doDelete(inplaceDelete, shape);\n            for (var i = 0; i < latlngs.length; i++) {\n                if (latlngs[i] === shape) return doDelete(spliceDelete, shape);\n                else if (L.Util.indexOf(latlngs[i], shape) !== -1) return doDelete(spliceDelete, latlngs[i]);\n            }\n        },\n\n        deleteShapeAt: function (latlng) {\n            var shape = this.feature.shapeAt(latlng);\n            if (shape) return this.deleteShape(shape);\n        },\n\n        appendShape: function (shape) {\n            this.insertShape(shape);\n        },\n\n        prependShape: function (shape) {\n            this.insertShape(shape, 0);\n        },\n\n        insertShape: function (shape, index) {\n            this.ensureMulti();\n            shape = this.formatShape(shape);\n            if (typeof index === 'undefined') index = this.feature._latlngs.length;\n            this.feature._latlngs.splice(index, 0, shape);\n            this.feature.redraw();\n            if (this._enabled) this.reset();\n        }\n\n    });\n\n    L.Editable.PolylineEditor = L.Editable.PathEditor.extend({\n\n        startDrawingBackward: function (latlngs) {\n            this._drawing = L.Editable.BACKWARD;\n            this.startDrawing(latlngs);\n            this.tools.attachBackwardLineGuide();\n        },\n\n        continueBackward: function (latlngs) {\n            latlngs = latlngs || this.getDefaultLatLngs();\n            this.setDrawnLatLngs(latlngs);\n            this.tools.anchorBackwardLineGuide(latlngs[0]);\n            this.startDrawingBackward();\n        },\n\n        continueForward: function (latlngs) {\n            latlngs = latlngs || this.getDefaultLatLngs();\n            this.setDrawnLatLngs(latlngs);\n            this.tools.anchorForwardLineGuide(latlngs[latlngs.length - 1]);\n            this.startDrawingForward();\n        },\n\n        getDefaultLatLngs: function (latlngs) {\n            latlngs = latlngs || this.feature._latlngs;\n            if (!latlngs.length || latlngs[0] instanceof L.LatLng) return latlngs;\n            else return this.getDefaultLatLngs(latlngs[0]);\n        },\n\n        ensureMulti: function () {\n            if (this.feature._latlngs.length && L.Polyline._flat(this.feature._latlngs)) {\n                this.feature._latlngs = [this.feature._latlngs];\n            }\n        },\n\n        addNewEmptyShape: function () {\n            if (this.feature._latlngs.length) {\n                var shape = [];\n                this.appendShape(shape);\n                return shape;\n            } else {\n                return this.feature._latlngs;\n            }\n        },\n\n        formatShape: function (shape) {\n            if (L.Polyline._flat(shape)) return shape;\n            else if (shape[0]) return this.formatShape(shape[0]);\n        },\n\n        splitShape: function (shape, index) {\n            if (!index || index >= shape.length - 1) return;\n            this.ensureMulti();\n            var shapeIndex = this.feature._latlngs.indexOf(shape);\n            if (shapeIndex === -1) return;\n            var first = shape.slice(0, index + 1),\n                second = shape.slice(index);\n            // We deal with reference, we don't want twice the same latlng around.\n            second[0] = L.latLng(second[0].lat, second[0].lng, second[0].alt);\n            this.feature._latlngs.splice(shapeIndex, 1, first, second);\n            this.refresh();\n            this.reset();\n        }\n\n    });\n\n    L.Editable.PolygonEditor = L.Editable.PathEditor.extend({\n\n        CLOSED: true,\n        MIN_VERTEX: 3,\n\n        startDrawingForward: function () {\n            L.Editable.PathEditor.prototype.startDrawingForward.call(this);\n            this.tools.attachBackwardLineGuide();\n        },\n\n        addNewEmptyHole: function (latlng) {\n            this.ensureNotFlat();\n            var latlngs = this.feature.shapeAt(latlng);\n            if (!latlngs) return;\n            var holes = [];\n            latlngs.push(holes);\n            return holes;\n        },\n\n        newHole: function (latlng) {\n            var holes = this.addNewEmptyHole(latlng);\n            if (!holes) return;\n            this.setDrawnLatLngs(holes);\n            this.startDrawingForward();\n            if (latlng) this.newPointForward(latlng);\n        },\n\n        addNewEmptyShape: function () {\n            if (this.feature._latlngs.length && this.feature._latlngs[0].length) {\n                var shape = [];\n                this.appendShape(shape);\n                return shape;\n            } else {\n                return this.feature._latlngs;\n            }\n        },\n\n        ensureMulti: function () {\n            if (this.feature._latlngs.length && L.Polyline._flat(this.feature._latlngs[0])) {\n                this.feature._latlngs = [this.feature._latlngs];\n            }\n        },\n\n        ensureNotFlat: function () {\n            if (!this.feature._latlngs.length || L.Polyline._flat(this.feature._latlngs)) this.feature._latlngs = [this.feature._latlngs];\n        },\n\n        vertexCanBeDeleted: function (vertex) {\n            if (vertex.latlngs === this.getLatLngs()) return L.Editable.PathEditor.prototype.vertexCanBeDeleted.call(this, vertex);\n            else return true;  // Holes can be totally deleted without removing the layer itself\n        },\n\n        getDefaultLatLngs: function () {\n            if (!this.feature._latlngs.length) this.feature._latlngs.push([]);\n            return this.feature._latlngs[0];\n        },\n\n        formatShape: function (shape) {\n            // [[1, 2], [3, 4]] => must be nested\n            // [] => must be nested\n            // [[]] => is already nested\n            if (L.Polyline._flat(shape) && (!shape[0] || shape[0].length !== 0)) return [shape];\n            else return shape;\n        }\n\n    });\n\n\n    var EditableMixin = {\n\n        createEditor: function (map) {\n            map = map || this._map;\n            var Klass = this.options.editorClass || this.getEditorClass(map);\n            return new Klass(map, this, this.options.editOptions);\n        },\n\n        enableEdit: function () {\n            if (!this.editor) this.createEditor();\n            return this.editor.enable();\n        },\n\n        editEnabled: function () {\n            return this.editor && this.editor._enabled;\n        },\n\n        disableEdit: function () {\n            if (this.editor) {\n                this.editor.disable();\n                delete this.editor;\n            }\n        },\n\n        toggleEdit: function () {\n            if (this.editEnabled()) {\n                this.disableEdit();\n            } else {\n                this.enableEdit();\n            }\n        }\n\n    };\n\n    L.Polyline.include(EditableMixin);\n    L.Polygon.include(EditableMixin);\n    L.Marker.include(EditableMixin);\n\n    L.Polyline.include({\n\n        getEditorClass: function (map) {\n            return (map && map.options.polylineEditorClass) ? map.options.polylineEditorClass : L.Editable.PolylineEditor;\n        },\n\n        shapeAt: function (latlng, latlngs) {\n            // We can have those cases:\n            // - latlngs are just a flat array of latlngs, use this\n            // - latlngs is an array of arrays of latlngs, loop over\n            var shape = null;\n            latlngs = latlngs || this._latlngs;\n            if (!latlngs.length) return shape;\n            else if (L.Polyline._flat(latlngs) && this.isInLatLngs(latlng, latlngs)) shape = latlngs;\n            else for (var i = 0; i < latlngs.length; i++) if (this.isInLatLngs(latlng, latlngs[i])) return latlngs[i];\n            return shape;\n        },\n\n        isInLatLngs: function (l, latlngs) {\n            if (!latlngs) return false;\n            var i, k, len, part = [], p,\n                w = this._clickTolerance();\n            this._projectLatlngs(latlngs, part);\n            part = part[0];\n            p = this._map.latLngToLayerPoint(l);\n\n            if (!this._pxBounds.contains(p)) { return false; }\n            for (i = 1, len = part.length, k = 0; i < len; k = i++) {\n\n                if (L.LineUtil.pointToSegmentDistance(p, part[k], part[i]) <= w) {\n                    return true;\n                }\n            }\n            return false;\n        }\n\n    });\n\n    L.Polygon.include({\n\n        getEditorClass: function (map) {\n            return (map && map.options.polygonEditorClass) ? map.options.polygonEditorClass : L.Editable.PolygonEditor;\n        },\n\n        shapeAt: function (latlng, latlngs) {\n            // We can have those cases:\n            // - latlngs are just a flat array of latlngs, use this\n            // - latlngs is an array of arrays of latlngs, this is a simple polygon (maybe with holes), use the first\n            // - latlngs is an array of arrays of arrays, this is a multi, loop over\n            var shape = null;\n            latlngs = latlngs || this._latlngs;\n            if (!latlngs.length) return shape;\n            else if (L.Polyline._flat(latlngs) && this.isInLatLngs(latlng, latlngs)) shape = latlngs;\n            else if (L.Polyline._flat(latlngs[0]) && this.isInLatLngs(latlng, latlngs[0])) shape = latlngs;\n            else for (var i = 0; i < latlngs.length; i++) if (this.isInLatLngs(latlng, latlngs[i][0])) return latlngs[i];\n            return shape;\n        },\n\n        isInLatLngs: function (l, latlngs) {\n            var inside = false, l1, l2, j, k, len2;\n\n            for (j = 0, len2 = latlngs.length, k = len2 - 1; j < len2; k = j++) {\n                l1 = latlngs[j];\n                l2 = latlngs[k];\n\n                if (((l1.lat > l.lat) !== (l2.lat > l.lat)) &&\n                        (l.lng < (l2.lng - l1.lng) * (l.lat - l1.lat) / (l2.lat - l1.lat) + l1.lng)) {\n                    inside = !inside;\n                }\n            }\n\n            return inside;\n        }\n\n    });\n\n    L.Marker.include({\n\n        getEditorClass: function (map) {\n            return (map && map.options.markerEditorClass) ? map.options.markerEditorClass : L.Editable.MarkerEditor;\n        }\n\n    });\n\n}, window));\n","L.Control.ThumbnailMap = L.Control.extend({\n\toptions: {\n\t\tcontainerClass: 'leaflet-control-thumbnailmap',\n\t\tbuttonClass: '',\n\t\taimingRectOptions: {color: '#29ffde', weight: 2, interactive: false},\n\n\t\tposition: 'bottomright',\n\t\ttoggleDisplay: false,\n\t\tautoToggleDisplay: false,\n\t\twidth: 150,\n\t\theight: 150,\n\t\t// thumbnailBounds: L.latLngBounds\n\n\t\thideText: 'Hide Map',\n\t\tshowText: 'Show Map'\n\t},\n\n\t// layer is the map layer to be shown in the minimap\n\tinitialize: function (layer, options) {\n\t\t// First merge our aimingRectOptions, making sure interactive is false\n\t\toptions = options || {};\n\t\toptions.aimingRectOptions = L.extend(this.options.aimingRectOptions, options.aimingRectOptions || {}, {interactive: false});\n\n\t\tif (!(layer instanceof L.Layer)) {\n\t\t\tthrow Error('A layer must be set');\n\t\t}\n\t\tthis._layer = layer;\n\n\t\tL.Control.prototype.initialize.call(this, options);\n\t},\n\n\tonAdd: function (map) {\n\t\tthis._mainMap = map;\n\n\t\t// Creating the container and stopping events from spilling through to the main map.\n\t\tthis._container = L.DomUtil.create('div', this.options.containerClass + ' leaflet-bar');\n\t\tthis._container.style.width = this.options.width + 'px';\n\t\tthis._container.style.height = this.options.height + 'px';\n\n\t\t// Create our static map\n\t\tthis._miniMap = new L.Map(this._container, {\n\t\t\ttrackResize: false,\n\t\t\tattributionControl: false,\n\t\t\tzoomControl: false,\n\t\t\ttouchZoom: false,\n\t\t\tscrollWheelZoom: false,\n\t\t\tdoubleClickZoom: false,\n\t\t\tboxZoom: false,\n\t\t\tdragging: false,\n\t\t\tcrs: this._mainMap.options.crs\n\t\t});\n\n\t\tthis._miniMap.addLayer(this._layer);\n\n\t\t// Keep a record of this to prevent auto toggling when the user explicitly doesn't want it.\n\t\tthis._userToggledDisplay = false;\n\t\tthis._minimized = false;\n\n\t\tif (this.options.toggleDisplay) {\n\t\t\tthis._addToggleButton();\n\t\t}\n\n\n\t\tthis._aimingRect = L.rectangle(this._mainMap.getBounds(), this.options.aimingRectOptions).addTo(this._miniMap);\n\n\t\t// Update rectangle\n\t\tthis._mainMap.on('move', this._onMainMapMoving, this);\n\t\tthis._mainMap.on('moveend resize', this._onMainMapMoved, this);\n\n\t\tthis._miniMap.on('click', this._onMiniMapClicked, this);\n\n\t\treturn this._container;\n\t},\n\n\taddTo: function (map) {\n\t\tL.Control.prototype.addTo.call(this, map);\n\n\t\tL.DomEvent.disableScrollPropagation(this._container);\n\t\tL.DomEvent.disableClickPropagation(this._container);\n\n\t\t// Initiate our view, try to use the users bounds or the layer.bounds\n\t\tif (this.options.thumbnailBounds instanceof L.LatLngBounds && this.options.thumbnailBounds.isValid()) {\n\t\t\tthis._miniMap.fitBounds(this.options.thumbnailBounds);\n\t\t} else if (this._layer.options.bounds) {\n\t\t\tthis._miniMap.fitBounds(this._layer.options.bounds);\n\t\t} else {\n\t\t\tthis._miniMap.fitWorld();\n\t\t}\n\n\t\t// Update our dimensions and view now we're added to the DOM\n\t\tthis._miniMap.invalidateSize();\n\n\t\tthis._setDisplay(this._decideMinimized());\n\t\treturn this;\n\t},\n\n\tonRemove: function () {\n\t\tthis._mainMap.off('move', this._onMainMapMoving, this);\n\t\tthis._mainMap.off('moveend resize', this._onMainMapMoved, this);\n\n\t\tthis._miniMap.off('click', this._onMiniMapClick, this);\n\t\tthis._miniMap.remove();\n\t},\n\n\tgetThumbnailMap: function () {\n\t\treturn this._miniMap;\n\t},\n\n\tisMinimized: function () {\n\t\treturn this._minimized;\n\t},\n\n\t_addToggleButton: function () {\n\t\tvar buttonClasses =  [\n\t\t\tthis.options.containerClass + '-toggle',\n\t\t\tthis.options.buttonClass || ''\n\t\t].join(' ');\n\t\tthis._toggleDisplayButton = this._createButton('', this.options.hideText, buttonClasses, this._container, this._toggleDisplayButtonClicked, this);\n\t},\n\n\t_createButton: function (html, title, className, container, fn, context) {\n\t\tvar link = L.DomUtil.create('a', className, container);\n\t\tlink.innerHTML = html;\n\t\tlink.href = '#';\n\t\tlink.title = title;\n\n\t\tL.DomEvent.disableClickPropagation(link);\n\t\tL.DomEvent.on(link, 'click', fn, context);\n\n\t\treturn link;\n\t},\n\n\t_toggleDisplayButtonClicked: function () {\n\t\tthis._userToggledDisplay = true;\n\t\tthis.toggleMap();\n\t},\n\n\t_setDisplay: function (minimize) {\n\t\tif (minimize !== this._minimized) {\n\t\t\tif (!this._minimized) {\n\t\t\t\tthis.minimize();\n\t\t\t} else {\n\t\t\t\tthis.restore();\n\t\t\t}\n\t\t}\n\t},\n\n\ttoggleMap: function () {\n\t\tif (!this._minimized) {\n\t\t\tthis.minimize();\n\t\t} else {\n\t\t\tthis.restore();\n\t\t}\n\t\treturn this;\n\t},\n\n\tminimize: function () {\n\t\tif (this.options.toggleDisplay) {\n\t\t\tthis._container.style.width = this._toggleDisplayButton.offsetWidth + 'px';\n\t\t\tthis._container.style.height = this._toggleDisplayButton.offsetHeight + 'px';\n\n\t\t\tL.DomUtil.addClass(this._toggleDisplayButton, 'minimized');\n\t\t\tthis._toggleDisplayButton.title = this.options.showText;\n\t\t} else {\n\t\t\tthis._container.style.display = 'none';\n\t\t}\n\n\t\tthis._minimized = true;\n\t},\n\n\trestore: function () {\n\t\tif (this.options.toggleDisplay) {\n\t\t\tthis._container.style.width = this.options.width + 'px';\n\t\t\tthis._container.style.height = this.options.height + 'px';\n\n\t\t\tL.DomUtil.removeClass(this._toggleDisplayButton, 'minimized');\n\t\t\tthis._toggleDisplayButton.title = this.options.hideText;\n\t\t} else {\n\t\t\tthis._container.style.display = 'block';\n\t\t}\n\n\t\tthis._minimized = false;\n\t},\n\n\t_decideMinimized: function () {\n\t\tif (this._userToggledDisplay) {\n\t\t\treturn this._minimized;\n\t\t}\n\n\t\tif (this.options.autoToggleDisplay) {\n\t\t\tvar containsAll = this._mainMap.getBounds().contains(this._miniMap.getBounds());\n\t\t\tvar containsNone = !this._mainMap.getBounds().intersects(this._miniMap.getBounds());\n\t\t\treturn containsAll || containsNone;\n\t\t}\n\n\t\treturn this._minimized;\n\t},\n\n\t_onMainMapMoving: function (e) {\n\t\tthis._updateRectangle(e);\n\t},\n\n\t_onMainMapMoved: function (e) {\n\t\tthis._setDisplay(this._decideMinimized());\n\t\tif (!this._minimized) {\n\t\t\tthis._updateRectangle(e);\n\t\t}\n\t},\n\n\t_updateRectangle: function () {\n\t\tthis._aimingRect.setBounds(this._mainMap.getBounds());\n\t},\n\n\t_onMiniMapClicked: function (e) {\n\t\tthis._mainMap.panTo(e.latlng);\n\t}\n});\n\nL.control.thumbnailmap = function (layer, options) {\n\treturn new L.Control.ThumbnailMap(layer, options);\n};\n","L.FeatureStorage = L.FS = L.FeatureStorage || {};\nL.FeatureStorage.JSON = L.Class.extend({\n\toptions: {\n\t\texportUrl: undefined,\n\t\timportUrl: undefined\n\t},\n\n\tinitialize: function (options) {\n\t\tL.setOptions(this, options);\n\n\t\tif (!this.options.exportUrl || !this.options.importUrl) {\n\t\t\tthrow new Error('No url set to acces JSON storage');\n\t\t}\n\t},\n\n\tload: function (jsonid, onSucces, onError) {\n\t\tif (jsonid === '' || jsonid === true || jsonid === false) {\n\t\t\treturn false;\n\t\t}\n\n\t\tvar xmlhttp = new XMLHttpRequest(),\n\t\timportUrl = L.Util.template(this.options.importUrl, {id: jsonid});\n\n\t\txmlhttp.open('GET', importUrl, true);\n\n\t\t// status 200, parse geoJson\n\t\tL.DomEvent.on(xmlhttp, 'readystatechange', function () {\n\t\t\tif (xmlhttp.readyState === 4 && xmlhttp.status === 200) {\n\t\t\t\tonSucces(JSON.parse(xmlhttp.responseText));\n\t\t\t} else if (xmlhttp.readyState === 4) {\n\t\t\t\tonError(xmlhttp);\n\t\t\t}\n\t\t}, this);\n\n\t\txmlhttp.send();\n\t},\n\n\tsave: function (layer, onSucces, onError) {\n\t\tif (!layer || !layer.toGeoJSON) {\n\t\t\tonSucces(false);\n\t\t\treturn;\n\t\t}\n\t\tvar geojson = layer.toGeoJSON();\n\t\tif (geojson.features.length === 0) {\n\t\t\tonSucces(false);\n\t\t\treturn;\n\t\t}\n\n\t\tvar xmlhttp = new XMLHttpRequest();\n\t\txmlhttp.open('POST', this.options.exportUrl, true);\n\t\txmlhttp.setRequestHeader('Content-type', 'application/json; charset=utf-8');\n\n\t\t// status 201, parse .uri\n\t\tL.DomEvent.on(xmlhttp, 'readystatechange', function () {\n\t\t\tif (xmlhttp.readyState === 4  && xmlhttp.status === 201) {\n\t\t\t\tvar url = JSON.parse(xmlhttp.responseText).uri;\n\t\t\t\tvar storageID = url.split('/').slice(-1)[0];\n\t\t\t\tonSucces(storageID);\n\t\t\t} else if (xmlhttp.readyState === 4) {\n\t\t\t\tonError(xmlhttp);\n\t\t\t}\n\t\t}, this);\n\n\t\txmlhttp.send(JSON.stringify(geojson));\n\t}\n});\n\nL.featurestorage = L.fs = L.featurestorage || {};\nL.fs.json = function (options) {\n\treturn new L.FS.JSON(options);\n};\n\nL.FS.Myjson = L.FS.JSON.extend({\n\toptions: {\n\t\texportUrl: 'https://api.myjson.com/bins',\n\t\timportUrl: 'https://api.myjson.com/bins/{id}'\n\t}\n});\n\nL.fs.myjson = function (options) {\n\treturn new L.FS.Myjson(options);\n};\n","L.Control.Fullscreen = L.Control.extend({\n    options: {\n        position: 'topleft',\n        title: {\n            'false': 'View Fullscreen',\n            'true': 'Exit Fullscreen'\n        }\n    },\n\n    onAdd: function (map) {\n        var container = L.DomUtil.create('div', 'leaflet-control-fullscreen leaflet-bar leaflet-control');\n\n        this.link = L.DomUtil.create('a', 'leaflet-control-fullscreen-button leaflet-bar-part', container);\n        this.link.href = '#';\n\n        this._map = map;\n        this._map.on('fullscreenchange', this._toggleTitle, this);\n        this._toggleTitle();\n\n        L.DomEvent.on(this.link, 'click', this._click, this);\n\n        return container;\n    },\n\n    _click: function (e) {\n        L.DomEvent.stopPropagation(e);\n        L.DomEvent.preventDefault(e);\n        this._map.toggleFullscreen();\n    },\n\n    _toggleTitle: function() {\n        this.link.title = this.options.title[this._map.isFullscreen()];\n    }\n});\n\nL.Map.include({\n    isFullscreen: function () {\n        return this._isFullscreen || false;\n    },\n\n    toggleFullscreen: function () {\n        var container = this.getContainer();\n        if (this.isFullscreen()) {\n            if (document.exitFullscreen) {\n                document.exitFullscreen();\n            } else if (document.mozCancelFullScreen) {\n                document.mozCancelFullScreen();\n            } else if (document.webkitCancelFullScreen) {\n                document.webkitCancelFullScreen();\n            } else if (document.msExitFullscreen) {\n                document.msExitFullscreen();\n            } else {\n                L.DomUtil.removeClass(container, 'leaflet-pseudo-fullscreen');\n                this._setFullscreen(false);\n                this.invalidateSize();\n                this.fire('fullscreenchange');\n            }\n        } else {\n            if (container.requestFullscreen) {\n                container.requestFullscreen();\n            } else if (container.mozRequestFullScreen) {\n                container.mozRequestFullScreen();\n            } else if (container.webkitRequestFullscreen) {\n                container.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);\n            } else if (container.msRequestFullscreen) {\n                container.msRequestFullscreen();\n            } else {\n                L.DomUtil.addClass(container, 'leaflet-pseudo-fullscreen');\n                this._setFullscreen(true);\n                this.invalidateSize();\n                this.fire('fullscreenchange');\n            }\n        }\n    },\n\n    _setFullscreen: function(fullscreen) {\n        this._isFullscreen = fullscreen;\n        var container = this.getContainer();\n        if (fullscreen) {\n            L.DomUtil.addClass(container, 'leaflet-fullscreen-on');\n        } else {\n            L.DomUtil.removeClass(container, 'leaflet-fullscreen-on');\n        }\n    },\n\n    _onFullscreenChange: function (e) {\n        var fullscreenElement =\n            document.fullscreenElement ||\n            document.mozFullScreenElement ||\n            document.webkitFullscreenElement ||\n            document.msFullscreenElement;\n\n        if (fullscreenElement === this.getContainer() && !this._isFullscreen) {\n            this._setFullscreen(true);\n            this.fire('fullscreenchange');\n        } else if (fullscreenElement !== this.getContainer() && this._isFullscreen) {\n            this._setFullscreen(false);\n            this.fire('fullscreenchange');\n        }\n    }\n});\n\nL.Map.mergeOptions({\n    fullscreenControl: false\n});\n\nL.Map.addInitHook(function () {\n    if (this.options.fullscreenControl) {\n        this.fullscreenControl = new L.Control.Fullscreen();\n        this.addControl(this.fullscreenControl);\n    }\n\n    var fullscreenchange;\n\n    if ('onfullscreenchange' in document) {\n        fullscreenchange = 'fullscreenchange';\n    } else if ('onmozfullscreenchange' in document) {\n        fullscreenchange = 'mozfullscreenchange';\n    } else if ('onwebkitfullscreenchange' in document) {\n        fullscreenchange = 'webkitfullscreenchange';\n    } else if ('onmsfullscreenchange' in document) {\n        fullscreenchange = 'MSFullscreenChange';\n    }\n\n    if (fullscreenchange) {\n        var onFullscreenChange = L.bind(this._onFullscreenChange, this);\n\n        this.whenReady(function () {\n            L.DomEvent.on(document, fullscreenchange, onFullscreenChange);\n        });\n\n        this.on('unload', function () {\n            L.DomEvent.off(document, fullscreenchange, onFullscreenChange);\n        });\n    }\n});\n\nL.control.fullscreen = function (options) {\n    return new L.Control.Fullscreen(options);\n};\n","/*\n * L.Util extra's for custom use\n */\n\nL.Util.humanReadable = function(meters) {\n    var exp = Math.floor(Math.log(meters) / Math.LN10),\n        resunits = '', scaleExp = 0\n\n    if(exp < -6) {\n        resunits = \"nm\"\n        scaleExp = -9\n    }else if(exp < -3) {\n        resunits = \"&micro;m\"\n        scaleExp = -6\n    }else if (exp < 0) {\n        resunits = \"mm\"\n        scaleExp = -3\n    }else if(exp < 3) {\n        resunits = \"m\"\n    }else { //if(exp < 6) {\n        resunits = \"km\"\n        scaleExp = 3\n    }\n    \n    return {magnitude:meters/Math.pow(10,scaleExp), unit:resunits}\n}\n\nif(!L.Util.parseParamString) {\n      // Parses ?key=value&key=value\n    L.Util.parseParamString = function (searchUrl) {\n        if(searchUrl[0] != \"?\") return {};\n\n        var parsedParams = {};\n    \n        searchUrl.substring(1).split('&').forEach(function(paramPair) {\n            var splitPair = decodeURIComponent(paramPair).split(\"=\");\n            parsedParams[splitPair[0].trim()] = splitPair[1] ? splitPair[1].trim() : true;\n        })\n        return parsedParams;\n    }\n}","L.FeatureProperties = L.Class.extend({\n    getProperties: function() {\n        return (this.feature && this.feature.properties) || {}\n    },\n    \n    setProperties: function(properties) {\n        if(!this._isFeature()) { \n            this._initFeature()\n        }\n        \n        L.extend(this.feature.properties, properties)\n    },\n    \n    _isFeature: function() {\n        return false\n    },\n    \n    _initFeature: function() {\n        if(!this.feature) {\n            L.extend(this, {feature: {} })\n        }\n        \n        if(!this.feature.type || this.feature.type !== 'Feature') {\n            L.extend(this.feature, {type: 'Feature' })\n        }\n\n        if(!this.feature.properties) {\n            L.extend(this.feature, {properties: {} })\n        }\n    }\n});\n\nL.extend(L.Mixin, {FeatureProperties: L.FeatureProperties.prototype})\n\nL.Path.include(L.Mixin.FeatureProperties);","L.Marker.Label = L.Marker.extend({\n    \n    options: {\n        icon: new L.DivIcon({\n            className: 'leaflet-div-label',\n            iconAnchor: [0,0],\n            iconSize: [0,0],\n        }),\n        keyboard: false,\n        interactive: true,\n        draggable: false,   \n    },\n\n    onAdd: function (map) {\n      this.on('move contentupdate drag', this.onEdit, this);\n      L.Marker.prototype.onAdd.call(this, map);\n    },\n\n    onRemove: function () {\n      this.off('move contentupdate drag', this.onEdit, this);\n      L.Marker.prototype.onRemove.call(this);\n    },\n    \n    onEdit: function(e) {\n      //Propagate to event parents\n      this.fire('marker:label:edited', {originalEvent: e}, true);\n    },\n    \n    setContent: function(content) {\n        this._content = content;\n        \n        if(this._map)\n    \t\tthis.update();\n\t\t\n\t\t  return this;\n    },\n    \n    update: function(e) {\n        this._updateContent();\n        this._updateSize();\n        \n        L.Marker.prototype.update.call(this);\n        \n        return this;\n    },\n    \n    _updateContent: function() {\n      if (!this.getElement()) { return; }\n\n      var node = this.getElement();\n      var content = this._content || 'Placeholder';\n        \n          //If we have feature property editing\n          if(this.setProperties) {\n              this.setProperties({content: content})\n          }\n        \n      if (typeof content === 'string') {\n        node.innerHTML = content;\n      } else {\n        while (node.hasChildNodes()) {\n          node.removeChild(node.firstChild);\n        }\n        node.appendChild(content);\n      }\n      this.fire('contentupdate', {layer: this});      \n    },\n    \n    _updateSize: function() {\n        var icon = this.getElement(),\n            sizeFactor = 1/this._map.getZoomScale(4),\n            sizeFactorLimited = Math.min(Math.max(sizeFactor, 0.5), 1);\n\n        icon.style.fontSize = sizeFactorLimited * 32 + \"px\"\n        \n        var newSize = L.point(icon.scrollWidth, icon.scrollHeight),\n            halfSize = newSize.divideBy(2)\n\n        \n        icon.style.marginLeft = (-halfSize.x) + \"px\"\n        icon.style.marginTop  = (-halfSize.y) + \"px\"\n        \n        this.offsetAnchor = L.point(0, -halfSize.y);\n    },\n    \n    _getPopupAnchor: function() {\n      return this.offsetAnchor || L.point(0,0);\n    },\n    \n    showLabelEditor: function(autoOpen) {\n        var popupOptions = {\n          closeOnClick: !L.Browser.touch //Touch interface friendly\n        };\n        \n        this.bindPopup(L.Util.bind(this._popupContent,this), popupOptions)\n        if(autoOpen) {\n            this.openPopup()\n        }\n        this.once('popupclose', this.unbindPopup)\n    },\n    \n    _popupContent: function() {\n        var currentLabel = this.getElement().innerHTML.replace(/<br\\s?\\/?>/g,\"\\n\");\n        \n        var input = L.DomUtil.create('textarea', 'leaflet-label-input', false)\n\n        input.value = currentLabel;\n\n        L.DomEvent.on(input, 'keyup', L.bind(function(e) { \n            this.setContent(e.target.value.replace(/\\r\\n|\\r|\\n/g,\"<br />\"))\n        }, this));\n        \n        return input;\n    }\n})\n\nL.Marker.Label.include(L.Mixin.FeatureProperties);\n\nL.marker.label = function(latlng, options) {\n    return new L.Marker.Label(latlng, options)\n}","var DoneAction = L.ToolbarAction.extend({\n    options: {\n        toolbarIcon: {\n            tooltip: 'Done',\n            className: 'svg-icon done white'\n        },\n    },\n    \n    addHooks: function () {\n        if(!this.toolbar.parentToolbar || !this.toolbar.parentToolbar._active){ return; }\n        \n        if(this.toolbar.parentToolbar._active.doneAction) {\n            this.toolbar.parentToolbar._active.doneAction()\n        }\n    }\n});\n\nvar CancelAction = L.ToolbarAction.extend({\n    options: {\n        toolbarIcon: {\n            tooltip: 'Cancel',\n            className: 'svg-icon cancel white'\n        },\n    },\n    \n    addHooks: function () {\n        if(!this.toolbar.parentToolbar || !this.toolbar.parentToolbar._active){ return; }\n        \n        if(this.toolbar.parentToolbar._active.cancelAction) {\n            this.toolbar.parentToolbar._active.cancelAction()\n        }\n    }\n});","L.Control.Scale.include({\r\n    _updateMetric: function (maxMeters) {\r\n        var meters = this._getRoundNum(maxMeters),\r\n            defaultUnit = {magnitude: meters > 1000 ? meters/1000 : meters, unit: meters > 1000 ? 'km' : 'm'}\r\n            humanReadable = L.Util.humanReadable ? L.Util.humanReadable(meters) : defaultUnit;\r\n            humanString = Math.round(humanReadable.magnitude)+\" \"+humanReadable.unit;\r\n\r\n        this._updateScale(this._mScale, humanString, meters / maxMeters );\r\n    },\r\n\r\n    _getRoundNum: function (num) {\r\n        var pow10 = Math.pow(10, Math.floor(Math.log(num) / Math.LN10)),\r\n            d = num / pow10;\r\n\r\n        d = d >= 10 ? 10 :\r\n            d >= 5 ? 5 :\r\n            d >= 3 ? 3 :\r\n            d >= 2 ? 2 : 1;\r\n\r\n        return pow10 * d;\r\n    }\r\n})","L.Handler.Ruler = L.Handler.extend({\r\n    includes: L.Mixin.Events,\r\n    \r\n    options: {\r\n        \r\n        rulerStyle: {dashArray: '5,10'}, //For L.PolyLine styles\r\n\t\t\r\n\t\tpopupOptions: {\r\n\t\t    closeOnClick: false, \r\n\t\t    autoClose: false,\r\n\t\t    autoPan: false, \r\n\t\t    className: 'leaflet-popup leaflet-control-ruler-popup',\r\n\t\t    overlapsClass: 'leaflet-control-ruler-overlaps',\r\n\t\t    decimals: 2\r\n\t\t},\r\n\t\t\r\n\t\teditOptions: {drawingCSSClass: 'leaflet-control-ruler'}\r\n\t\t\r\n\t},\r\n\t\r\n\tinitialize: function(map, options) {\r\n\t    L.setOptions(this, L.Util.create(options));\r\n\t    \r\n\t    L.Handler.prototype.initialize.call(this, map)\r\n\t    \r\n        //Force disable skipMiddleMarkers\r\n        var editOptions = L.Util.extend({}, this.options.editOptions, {skipMiddleMarkers: true})\r\n\t    this._editTools = new L.Editable(this._map, editOptions)\r\n\t    \r\n\t    this._createPopup(this.options.popupOptions)\r\n\t},\r\n\t\r\n\t_createPopup: function(options) {\r\n\t    this._distancePopup = L.popup(options)\r\n\t    \r\n\t    //Content is a function for updating\r\n\t    this._distancePopup.setContent(function(layer) {\r\n\t        var latlngs = layer.getLatLngs(),\r\n\t            distance = this._map.distance(latlngs[0],latlngs[1]),\r\n        \t    distanceObj = {magnitude:distance, unit:'m'}\r\n\r\n            if(typeof L.Util.humanReadable === 'function') {\r\n                distanceObj = L.Util.humanReadable(distance)\r\n            } else {\r\n                console.warn('L.Util.humanReadable(meters) must be present. Function returns object {magnitude:\"scaledDistance\", unit:\"unit\"}')\r\n            }\r\n            return L.Util.formatNum(distanceObj.magnitude, this.options.decimals || 2) + \" \" + distanceObj.unit\r\n        })\r\n\t},\r\n\t\r\n    addHooks: function() {\r\n        \r\n        //Initiate ruler layer and edit controls\r\n        this._rulerLine = this._editTools.startPolyline();\r\n        \r\n        this.fire('ruler:created');\r\n        \r\n        //Set the line style\r\n        this._rulerLine.setStyle(L.Util.extend({dashArray: '5,10', weight: 3}, this.options.rulerStyle))\r\n        \r\n        //Events for adding points, dragging the vertex \r\n        // and when the popup with the distance is closed\r\n        this._rulerLine.on('editable:drawing:clicked', this._onMarkerAdded, this)\r\n        this._rulerLine.on('editable:vertex:drag', this._onDrawingMove, this)\r\n        this._rulerLine.on('popupclose', this._onPopupClosed, this)\r\n        this._map.on('moveend', this._updatePopupTransparancy, this)\r\n    },\r\n\r\n    removeHooks: function() {   \r\n        if(this._rulerLine) {\r\n            //Remove events\r\n            this._rulerLine.off('editable:drawing:clicked', this._onMarkerAdded, this)\r\n            this._rulerLine.off('editable:vertex:drag', this._onDrawingMove, this)    \r\n            this._rulerLine.off('popupclose', this._onPopupClosed, this)\r\n            this._map.off('moveend', this._updatePopupTransparancy, this)            \r\n            \r\n            if(this._rulerLine.getPopup && this._rulerLine.getPopup())\r\n            {\r\n                this._rulerLine.closePopup().unbindPopup()\r\n            }\r\n            this._rulerLine.remove()   \r\n            delete this._rulerLine\r\n            \r\n            this.fire('ruler:deleted');\r\n        }\r\n    },\r\n    \r\n    _onMarkerAdded: function(e) {\r\n        //When we have two points (= one vertex) stop drawing and show distance\r\n        if(e.layer.getLatLngs().length == 2)\r\n        {\r\n            //Stop our drawing\r\n            e.editTools.commitDrawing()\r\n            \r\n            //var popupDistance = this._readableDistance(e.layer.getLatLngs())\r\n            e.layer.bindPopup(this._distancePopup).openPopup()\r\n            \r\n            this._updatePopupTransparancy()\r\n        }\r\n    },\r\n    \r\n    _onDrawingMove: function(e) {\r\n        if(this._popupAnimId) {\r\n            L.Util.cancelAnimFrame(this._popupAnimId)\r\n        }\r\n        this._animId = L.Util.requestAnimFrame(function() {\r\n             this._distancePopup.setLatLng(this._rulerLine.getCenter()).update()\r\n            this._updatePopupTransparancy()\r\n        }, this);\r\n        \r\n        this.fire('ruler:moved');\r\n    },\r\n    \r\n    _updatePopupTransparancy: function () {\r\n        if(!this._rulerLine || !this._rulerLine.getPopup || !this._rulerLine.getPopup()) { return; }\r\n        \r\n        //Calculate popup size for hitbox with any vertices\r\n        var popupElement = this._rulerLine.getPopup().getElement(),\r\n            bounds = this._getPopupBounds(popupElement)\r\n        \r\n        //Check every marker of our ruler\r\n        var noOverlap = this._rulerLine.getLatLngs().every(function(marker) {\r\n            return !bounds.contains(marker) \r\n        })\r\n        \r\n        if(noOverlap) {\r\n            L.DomUtil.removeClass(popupElement, this.options.popupOptions.overlapsClass)\r\n            L.DomUtil.setOpacity(popupElement, 1);\r\n        } else {\r\n            L.DomUtil.addClass(popupElement, this.options.popupOptions.overlapsClass)\r\n            L.DomUtil.setOpacity(popupElement, 0.6); \r\n        }\r\n        \r\n    },\r\n    \r\n    _onPopupClosed: function (e) {\r\n        //Remove/destroy ourselves\r\n        this.disable()\r\n    },\r\n    \r\n    _getPopupBounds: function (popupElement)\r\n    {\r\n        var popupContent = popupElement.getElementsByClassName('leaflet-popup-content-wrapper')[0],\r\n            popupContentSize = L.point(popupContent.offsetWidth,popupContent.offsetHeight)\r\n        \r\n        var popupOffset = L.point(parseInt(popupElement.style.left), -parseInt(popupElement.style.bottom)-popupElement.offsetHeight),\r\n            leftTop = L.DomUtil.getPosition(popupElement).add(popupOffset),\r\n            rightBottom = leftTop.add(popupContentSize)\r\n\r\n        return L.latLngBounds(this._map.layerPointToLatLng(leftTop),this._map.layerPointToLatLng(rightBottom)) \r\n    }\r\n});\r\n\r\n\r\nL.Control.Ruler = L.Control.extend({\r\n    options: {\r\n\t\tposition: 'topleft',\r\n\r\n\t},\r\n    \r\n    onAdd: function (map) {\r\n        var container = L.DomUtil.create('div', 'leaflet-control-ruler leaflet-control leaflet-bar'),\r\n            link = L.DomUtil.create('a', 'leaflet-control-ruler-measure', container);\r\n\r\n        link.href = '#';\r\n        link.title = 'Measure';\r\n        L.DomEvent.on(link, 'click', L.DomEvent.stop)\r\n                  .on(link, 'click', this._initRuler, this);\r\n        \r\n        this._rulerHandler = new L.Handler.Ruler(map, this.options)\r\n        \r\n        return container;\r\n    },\r\n    \r\n    onRemove: function(map)\r\n    {\r\n        this._rulerHandler.disable()\r\n        delete this._rulerHandler;\r\n    },\r\n    \r\n    _initRuler: function() {\r\n        if(this._rulerHandler.enabled())\r\n        {\r\n            this._rulerHandler.disable();\r\n        }\r\n        \r\n        this._rulerHandler.enable();\r\n    }\r\n});\r\n\r\n\r\nL.control.ruler = function (options) {\r\n\treturn new L.Control.Ruler(options);\r\n};","var RulerAction = L.ToolbarAction.extend({\r\n    options: {\r\n        toolbarIcon: {\r\n            tooltip: 'Measure',\r\n            className: 'svg-icon leaflet-control-ruler-measure'\r\n        },\r\n        \r\n        subToolbar: new (L.Toolbar.extend({}))({\r\n            actions: [CancelAction]\r\n        })\r\n    },\r\n    \r\n    initialize: function(map, options) {\r\n        L.ToolbarAction.prototype.initialize.call(this, options);\r\n        \r\n        this._map = map;\r\n        \r\n        this._rulerHandler = new L.Handler.Ruler(map, this.options)\r\n        \r\n        this._rulerHandler.on('ruler:deleted', this.disable, this)\r\n    },\r\n    \r\n    addHooks: function () {\r\n        if(this._rulerHandler.enabled())\r\n        {\r\n            this._rulerHandler.disable();\r\n        }\r\n        this._rulerHandler.enable();\r\n    },\r\n    \r\n    removeHooks: function() {\r\n        this._rulerHandler.disable();\r\n    },\r\n    \r\n    cancelAction: function() {\r\n        this.disable()\r\n    }\r\n    \r\n});","var newFeature = L.ToolbarAction.extend({\n    options: {\n        editTools: L.Editable,\n    },\n    \n    initialize: function(map, options) {\n        L.ToolbarAction.prototype.initialize.call(this, options);\n\n        this._map = map;\n        this._editTools = this.options.editTools\n        \n    },\n        \n    removeHooks: function() {\n        this._editTools.stopDrawing()\n        \n        if(this._currentFeature) {\n            this._currentFeature.editor.disable();\n        }\n    },\n    \n    doneAction: function() {\n        this._editTools.commitDrawing();\n        this.disable()\n    },\n    \n    cancelAction: function() {\n        this.disable();\n    },\n\n    _onDrawingStart: function(e) {\n        this._currentFeature = e.layer\n\n        this._currentFeature.once('editable:drawing:cancel', this._onDrawingCancel, this)\n        this._currentFeature.once('editable:drawing:end', this._onDrawingEnd, this)\n    },\n    \n    _onDrawingCancel: function(e) {\n        this._currentFeature.off('editable:drawing:end', this._onDrawingEnd, this)\n        e.layer.remove()\n    },\n    \n    _onDrawingEnd: function(e) {\n        this._currentFeature.off('editable:drawing:cancel', this._onDrawingCancel, this)\n        this.disable()\n    }    \n});\n\nvar newPolygon = newFeature.extend({\n    options: {\n        toolbarIcon: {\n            tooltip: 'Annotate a structure',\n            className: 'svg-icon mode-edit'\n        },\n    \n        subToolbar: new (L.Toolbar.extend({}))({\n            actions: [DoneAction, CancelAction]\n        })\n    },\n\n    addHooks: function () {\n        this._editTools.once('editable:drawing:start', this._onDrawingStart, this)\n        this._editTools.once('editable:drawing:clicked', this._onDrawingFirstClicked, this)\n        this._editTools.startPolygon()\n    },\n    \n    removeHooks: function() {\n      newFeature.prototype.removeHooks.call(this);\n      this._editTools.off('editable:drawing:clicked', this._onDrawingFirstClicked, this)            \n    },\n    \n    _onDrawingFirstClicked: function(e) {\n      L.DomUtil.addClass(e.latlng.__vertex.getElement(), 'closing-vertex');\n    }\n});\n\nvar newLabel = newFeature.extend({\n    options: {\n        toolbarIcon: {\n            tooltip: 'Label a structure',\n            className: 'svg-icon text-field'\n        },\n    \n        subToolbar: new (L.Toolbar.extend({}))({\n            actions: [CancelAction]\n        })\n    },\n        \n    addHooks: function () {\n        this._editTools.once('editable:drawing:start', this._onDrawingStart, this)\n        this._editTools.once('editable:drawing:click', this._onDrawingClick, this)\n        this._editTools.startMarker()\n    },\n\n    removeHooks: function() {\n      newFeature.prototype.removeHooks.call(this);\n      this._editTools.off('editable:drawing:click', this._onDrawingClick, this)\n      this._currentFeature.showLabelEditor( L.Browser.touch );\n    },\n\n    _onDrawingClick: function(e) {\n      e.layer.setLatLng(e.latlng);\n    }\n});\n\nvar SimpleFeatureAction = L.ToolbarAction.extend({\n    initialize: function(map, options) {\n        L.ToolbarAction.prototype.initialize.call(this, options);\n        this._map = map;\n        this._feature = this.options.feature\n    },\n    \n    removeHooks: function() {\n        this.toolbar.remove()\n    }\n})\n\nvar DoneEdit = SimpleFeatureAction.extend({\n    options: {\n        toolbarIcon: {\n            tooltip: 'Done editing',\n            className: 'svg-icon done'\n        },\n    },\n    \n    addHooks: function () {\n        this._feature.disableEdit()\n        this.disable()\n    },\n});\n\nvar EditFeature = SimpleFeatureAction.extend({\n    options: {\n        toolbarIcon: {\n            tooltip: 'Edit annotation',\n            className: 'svg-icon mode-edit'\n        },\n    \n    },\n    \n    addHooks: function () {\n        this._feature.enableEdit()\n        this.disable()\n    },\n});\n\nvar DeleteFeature = SimpleFeatureAction.extend({\n    options: {\n        toolbarIcon: {\n            tooltip: 'Delete annotation',\n            className: 'svg-icon delete'\n        },\n    \n    },\n    \n    addHooks: function () {\n        this._feature.remove()\n        this.disable()\n    },\n});\n\nvar FeatureToFront = SimpleFeatureAction.extend({\n    options: {\n        toolbarIcon: {\n            tooltip: 'To front',\n            className: 'svg-icon flip-to-front'\n        },\n    \n    },\n    \n    addHooks: function () {\n        this._feature.bringToFront()\n        this.disable()\n    },\n});\n\nvar FeatureToBack = SimpleFeatureAction.extend({\n    options: {\n        toolbarIcon: {\n            tooltip: 'To back',\n            className: 'svg-icon flip-to-back'\n        },\n    \n    },\n      \n    addHooks: function () {\n        this._feature.bringToBack()\n        this.disable()\n    },\n});\n\nvar MoveLabel = SimpleFeatureAction.extend({\n    options: {\n        toolbarIcon: {\n            tooltip: 'Move label',\n            className: 'svg-icon open-with'\n        },\n    \n    },\n    \n    addHooks: function () {\n        this._feature.enableEdit()\n        this.disable()\n    },\n});\n\nvar EditLabel = SimpleFeatureAction.extend({\n    options: {\n        toolbarIcon: {\n            tooltip: 'Edit text',\n            className: 'svg-icon text-format'\n        },\n    \n    },\n    \n    addHooks: function () {\n        this._feature.showLabelEditor(true);\n        this.disable()\n    }\n});","var ShowLink = L.ToolbarAction.extend({\n    options: {\n        toolbarIcon: {\n            html: '<textarea rows=\"5\" cols=\"30\" readonly=\"readonly\">',\n            className: 'leaflet-toolbar-export-link action-text-field'\n        },\n    },\n    \n    initialize: function(map, options, parentAction) {\n     //   console.log(map, options)\n        L.ToolbarAction.prototype.initialize.call(this, options);\n        this._map = map;\n        this._featureLayer = this.options.layer\n        this._storageController = this.options.storage\n        \n        parentAction.registerShowHook(L.bind(this.onShow, this))\n    },\n    \n    _getInput: function() {\n        if(!this._inputField){\n            this._inputField = this._icon.getElementsByTagName('textarea')[0]\n        }\n        return this._inputField;\n    },\n    \n    onShow: function(caller) {\n      \n        var inputEle = this._getInput();\n        \n        inputEle.value = \"Loading..\"\n        inputEle.disabled = true;\n        \n        var succesCallback = L.bind(this.onLink,this);\n        var that = this;\n        this._storageController.save(this._featureLayer, succesCallback, function() {\n          //Failed to save, probably connection error, try once more\n          inputEle.value = \"Loading... Failed (1/3), trying again\"\n          \n          setTimeout(function() { that._storageController.save(that._featureLayer, succesCallback, function() {\n            //Failed second time\n            inputEle.value = \"Loading... Failed again (2/3), trying again\";\n            \n            setTimeout(function() { that._storageController.save(that._featureLayer, succesCallback, function() {\n              //Failed third time\n              inputEle.value = \"Failed again (3/3), Connection error, try again later\";\n            })}, 1000);\n          })}, 1000);      \n        });\n    },\n    \n    onLink: function(storageID) {\n        var inputEle = this._getInput()\n        \n        inputEle.value = !!storageID ? this._getLink(storageID) : \"No features added yet!\";\n        inputEle.disabled = storageID === false ? true : false;\n        inputEle.focus();\n        inputEle.setSelectionRange(0, inputEle.value.length);\n    },\n    \n    _getLink: function (dataValue) {\n        var url = window.location || document.location;\n        var searchParams = L.Util.parseParamString(url.search)\n        var newSearch = L.Util.getParamString(L.extend(searchParams, {data: dataValue} ))\n        \n        return url.origin + url.pathname + newSearch + url.hash;\n    },\n    \n    addHooks: function () {\n       this.disable()\n    },\n    \n    removeHooks: function() {\n        this.toolbar.remove()\n    }\n});\n\nvar ExportShapes = L.ToolbarAction.extend({\n    options: {\n        toolbarIcon: {\n            tooltip: 'Export shapes',\n            className: 'svg-icon link'\n        },\n        \n        subToolbar: new (L.Toolbar.extend({}))({\n            actions: [DoneAction, ShowLink]\n        }),\n    },\n    \n    initialize: function(map, options) {\n        L.ToolbarAction.prototype.initialize.call(this, options);\n        this._map = map;\n        this._showHooks = []\n    },\n\n    registerShowHook: function(fn) {\n        this._showHooks.push(fn);\n    },\n\n    addHooks: function () {\n        for(hook in this._showHooks) {\n            this._showHooks[hook](this)\n        }      \n    },\n    \n    doneAction: function() {\n        this.disable()\n    },\n})\n\nvar ImportShapes = L.ToolbarAction.extend({\n    options: {\n        toolbarIcon: {\n            html: '<i class=\"material-icons\">done</i>',\n            tooltip: 'Done editing',\n        },\n    },\n    \n    initialize: function(map, options) {\n        L.ToolbarAction.prototype.initialize.call(this, options);\n        this._map = map;\n        this._featureLayer = this.options.feature\n        this._storageController = this.options.storage\n    },\n\n    addHooks: function () {\n        this._storageController.load(storageID, L.bind(function(storageID) {\n            console.log(geoJSON)\n            this.disable()\n        }, this));\n        \n    },\n    \n    removeHooks: function() {\n        this.toolbar.remove()\n    }\n})","L.Control.Legend = L.Control.extend({  \n    options: {\n        position: 'bottomright',\n        containerClass: 'leaflet-control-legend'\n    },\n\n    initialize: function(content, options) {\n        if(content) {\n            this.setContent(content);\n        }\n        \n        L.Util.setOptions(this, options);\n    },\n\n    onAdd: function (map) {\n        this._container = L.DomUtil.create('div', this.options.containerClass);\n        L.DomEvent.disableClickPropagation(this._container);\n        L.DomEvent.disableScrollPropagation(this._container);\n        \n       map.whenReady(this.update, this);\n        \n        return this._container;\n    },\n    \n    onRemove: function() {\n    \n    },\n    \n    setContent: function(content) {\n        this._content = content;\n        this.update();\n        return this;\n    },\n    \n    update: function() {\n        this._updateContent();\n    },\n    \n    _updateContent: function() {\n        if(!this._map || !this._container) { \n            return this; \n        }\n        \n        //Empty legend\n        while (this._container.lastChild) {\n            this._container.removeChild(this._container.lastChild);\n        }\n        \n\t\tvar content = (typeof this._content === 'function') ? this._content(this) : this._content;\n\n        if(content === false) {\n            this.hideLegend();\n            return;\n        } else {\n            this.showLegend();\n        }\n        \n        if (typeof content === 'string') {\n\t\t\tthis._container.innerHTML = content;\n\t\t} else {\n\t\t\tthis._container.appendChild(content);\n\t\t}\n\t},\n\t\n\thideLegend: function() {\n\t    this._container.style.display = 'none';\n\t},\n\t\n\tshowLegend: function() {\n\t    this._container.style.display = 'block';\t\n\t}\n});\n\nL.control.legend = function (content, options) {\n    return new L.Control.Legend(content, options);\n};\n\n\nL.Control.OverlayLegend = L.Control.Legend.extend({\n\n    initialize: function(overlay, options) {\n        this._overlay = overlay;\n        \n        this._overlayItems = [];\n        \n        L.Util.setOptions(this, options);\n        \n        this.setContent(this._contentUpdate);\n    },\n    \n    _contentUpdate: function() {\n        var overlays = [], overlayItems = [];\n        \n        if(this._overlay instanceof L.LayerGroup) {\n            overlays = this._overlay.getLayers();\n        } else if(this._overlay instanceof L.Path){\n            overlays.push(this._overlay)\n        } else {\n            return false;\n        }\n        var overlayList = L.DomUtil.create('ul', 'leaflet-legend-overlays', this._container);\n        overlays.forEach(function(overlay) {\n            if(!(overlay instanceof L.Path)) { return; }\n            var overlayItem = L.DomUtil.create('li', 'leaflet-legend-overlay', overlayList);\n\n            var overlayName = overlay.feature && overlay.feature.properties && overlay.feature.properties.name || \"Overlay\"\n\n            var colorBox = L.DomUtil.create('i', '', overlayItem);\n            colorBox.style.background = overlay.options.color;\n            \n            overlayItem.appendChild(document.createTextNode(overlayName));\n            \n            overlayItems[L.stamp(overlay)] = overlayItem;\n        });\n        \n        this._overlayItems = overlayItems;\n        return overlayList;\n    },\n\n    getOverlayItems: function() {\n        return this._overlayItems;\n    },\n    \n    getOverlayItem: function(overlay) {\n        return this._overlayItems && this._overlayItems[L.stamp(overlay)] || false;\n    }\n});\n\nL.control.overlaylegend = function (layer, options) {\n    return new L.Control.OverlayLegend(layer, options);\n};"]}